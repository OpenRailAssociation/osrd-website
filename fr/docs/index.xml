<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>OSRD – Documentation</title><link>https://osrd.fr/fr/docs/</link><description>Recent content in Documentation on OSRD</description><generator>Hugo -- gohugo.io</generator><language>fr</language><atom:link href="https://osrd.fr/fr/docs/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Avant toutes choses</title><link>https://osrd.fr/fr/docs/guides/contribute/preamble/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/preamble/</guid><description>
&lt;p>Déjà, merci de prendre le temps de contribuer !&lt;/p>
&lt;p>Si les sections suivantes forment un guide du contributeur, ce n&amp;rsquo;est pas pour autant un ensemble de règles strictes. En fait, si vous avez déjà contribué à des gros projets open-source, la suite ne sera pas surprenante. Dans le cas contraire, elle vous sera probablement très utile !&lt;/p>
&lt;h3 id="communiquer">Communiquer&lt;/h3>
&lt;p>Vous pouvez gagner du temps en discutant de votre projet de contribution avec les autres contributeurs :&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/OpenRailAssociation/osrd/issues/new/choose">&lt;strong>Créez une issue&lt;/strong>&lt;/a> pour avoir un endroit pour discuter de votre contribution.&lt;/li>
&lt;/ul>
&lt;h3 id="se-renseigner">Se renseigner&lt;/h3>
&lt;p>Comme dans tout projet, chaque changement repose sur ce qui a été fait par le passé.
Avant d&amp;rsquo;apporter un changement, renseignez-vous sur l&amp;rsquo;existant :&lt;/p>
&lt;ul>
&lt;li>Vous pouvez &lt;a href="https://osrd.fr/fr/docs/">lire la documentation technique&lt;/a>&lt;/li>
&lt;li>Il est préférable de lire le code source de l&amp;rsquo;application en rapport avec votre projet&lt;/li>
&lt;li>Vous pouvez contacter les derniers développeurs à avoir travaillé sur les zones du code en rapport avec votre projet&lt;/li>
&lt;/ul>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/license-and-set-up/">Continuer vers la mise en place ‣&lt;/a>&lt;/em>&lt;/p></description></item><item><title>Docs: Principes généraux</title><link>https://osrd.fr/fr/docs/guides/contribute/contribute-code/general-principles/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/contribute-code/general-principles/</guid><description>
&lt;ul>
&lt;li>Expliquez ce que vous faites et pourquoi.&lt;/li>
&lt;li>Documentez le nouveau code.&lt;/li>
&lt;li>Ajoutez des tests clairs et simples.&lt;/li>
&lt;li>Décomposez le travail en morceaux intelligibles.&lt;/li>
&lt;li>Prenez le temps de choisir de bons noms.&lt;/li>
&lt;li>Évitez les abréviations peu connues.&lt;/li>
&lt;li>&lt;strong>Contrôle et cohérence de la réutilisation du code de tiers&lt;/strong> : une dépendance est ajoutée seulement si elle est absolument nécessaire.&lt;/li>
&lt;li>Chaque dépendance ajoutée diminue notre autonomie et notre cohérence.&lt;/li>
&lt;li>Nous essayons de limiter à un petit nombre les PRs de mise à jour des dépendances chaque semaine
dans chaque composant, donc regrouper les montées de version dans une même PR est une bonne option
(reportez-vous au &lt;code>README.md&lt;/code> de chaque composant).&lt;/li>
&lt;li>&lt;strong>Ne pas réinventer la roue&lt;/strong> : en opposition au point précédent, ne réinventez pas tout à tout prix.&lt;/li>
&lt;li>S&amp;rsquo;il existe une dépendance dans l&amp;rsquo;écosystème qui est le standard « de facto », nous devrions fortement envisager de l&amp;rsquo;utiliser.&lt;/li>
&lt;li>Plus de code et de recommandations générales dans le dépôt principal &lt;a href="https://github.com/OpenRailAssociation/osrd/blob/dev/CONTRIBUTING.md">CONTRIBUTING.md&lt;/a>.&lt;/li>
&lt;li>Demandez toute l&amp;rsquo;aide dont vous avez besoin !&lt;/li>
&lt;/ul>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/contribute-code/backend-conventions/">Consulter les conventions pour le back-end ‣&lt;/a>&lt;/em>&lt;/p>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/contribute-code/frontend-conventions/">Consulter les conventions pour le front-end ‣&lt;/a>&lt;/em>&lt;/p>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/contribute-code/write-code/">Continuer vers l&amp;rsquo;écriture de code ‣&lt;/a>&lt;/em>&lt;/p>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/contribute-code/tests/">Continuer vers l&amp;rsquo;écriture de tests ‣&lt;/a>&lt;/em>&lt;/p></description></item><item><title>Docs: Processus de publication</title><link>https://osrd.fr/fr/docs/guides/release/process/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/release/process/</guid><description>
&lt;p>OSRD possède trois versions : développement (dev), staging et publication.&lt;/p>
&lt;p>La version de développement est la version la plus récente et la plus instable de l&amp;rsquo;application, contenant les dernières fonctionnalités et corrections de bugs en cours de développement.&lt;/p>
&lt;p>Les versions staging sont créées tous les jeudis à 12h en taguant l&amp;rsquo;état actuel du développement.&lt;/p>
&lt;p>Si une version staging passe les tests de validation, elle est promue pour devenir la dernière version publication. Cela garantit que seul du code stable et testé est intégré dans les versions de production.&lt;/p>
&lt;p>Le processus de publication suit ce workflow :&lt;/p>
&lt;ol>
&lt;li>Développement continu dans la branche dev&lt;/li>
&lt;li>Tags de staging hebdomadaires les jeudis à 12h&lt;/li>
&lt;li>Tests de validation de la version staging&lt;/li>
&lt;li>Promotion des builds staging validés au statut de publication&lt;/li>
&lt;/ol>
&lt;pre tabindex="0">&lt;code class="language-ascii" data-lang="ascii"> Développement Staging publication
(instable) (test) (stable)
[Branche Dev] |
| |
|---&amp;gt; Jeudi 12h |
| [Tag Staging] |
| | |
| Validation |
| Tests |
| | |
| o---&amp;gt; Si Passage --&amp;gt; Nouvelle
| Tests publication
[Suite Dev] |
| |
V V
&lt;/code>&lt;/pre></description></item><item><title>Docs: Conventions back-end</title><link>https://osrd.fr/fr/docs/guides/contribute/contribute-code/backend-conventions/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/contribute-code/backend-conventions/</guid><description>
&lt;h1 id="python">Python&lt;/h1>
&lt;p>Le code Python est utilisé pour certains paquets et pour les tests d&amp;rsquo;intégration.&lt;/p>
&lt;ul>
&lt;li>Suivez le &lt;a href="https://www.python.org/dev/peps/pep-0020/">Zen of Python&lt;/a>.&lt;/li>
&lt;li>Le code est linté avec &lt;a href="https://github.com/csachs/pyproject-flake8">flake8&lt;/a>.&lt;/li>
&lt;li>Le code est formaté avec &lt;a href="https://github.com/psf/black">Black&lt;/a>.&lt;/li>
&lt;li>Les imports sont triées avec &lt;a href="https://github.com/PyCQA/isort">Isort&lt;/a>.&lt;/li>
&lt;li>Les tests sont écrits avec &lt;a href="https://docs.pytest.org/">pytest&lt;/a>.&lt;/li>
&lt;li>Les types sont vérifiés avec &lt;a href="https://google.github.io/pytype/">pytype&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h1 id="rust">Rust&lt;/h1>
&lt;ul>
&lt;li>Comme référence pour le développement de notre API, nous utilisons les &lt;a href="https://rust-lang.github.io/api-guidelines/about.html">Rust API guidelines&lt;/a>.
D&amp;rsquo;une manière générale, il convient de les respecter.&lt;/li>
&lt;li>Préférer les importations granulaires aux importations globales comme &lt;code>diesel::*&lt;/code>.&lt;/li>
&lt;li>Les tests sont écrits avec le &lt;a href="https://doc.rust-lang.org/book/ch11-01-writing-tests.html">framework de base&lt;/a>.&lt;/li>
&lt;li>Utilisez l&amp;rsquo;&lt;a href="https://doc.rust-lang.org/rust-by-example/meta/doc.html">exemple de documentation&lt;/a> pour savoir comment formuler et formater votre documentation.&lt;/li>
&lt;li>Utilisez un style de commentaire cohérent :
&lt;ul>
&lt;li>&lt;code>///&lt;/code> les commentaires de la documentation sont au-dessus des invocations &lt;code>#[derive(Trait)]&lt;/code>.&lt;/li>
&lt;li>Les commentaires &lt;code>//&lt;/code> doivent généralement être placés au-dessus de la ligne en question, plutôt qu&amp;rsquo;en ligne.&lt;/li>
&lt;li>Les commentaires commencent par des lettres majuscules.
Terminez-les par un point s&amp;rsquo;ils ressemblent à une phrase.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Utilisez les commentaires pour organiser des portions de code longues et complexes qui ne peuvent être raisonnablement remaniées en fonctions distinctes.&lt;/li>
&lt;li>Le code est linté avec &lt;a href="https://github.com/rust-lang/rust-clippy">clippy&lt;/a>.&lt;/li>
&lt;li>Le code est formaté avec &lt;a href="https://github.com/rust-lang/rustfmt">fmt&lt;/a>.&lt;/li>
&lt;/ul>
&lt;h1 id="java">Java&lt;/h1>
&lt;ul>
&lt;li>Le code est formaté avec &lt;a href="https://checkstyle.sourceforge.io/">checkstyle&lt;/a>.&lt;/li>
&lt;/ul></description></item><item><title>Docs: Conventions front-end</title><link>https://osrd.fr/fr/docs/guides/contribute/contribute-code/frontend-conventions/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/contribute-code/frontend-conventions/</guid><description>
&lt;p>Nous utilisons &lt;strong>ReactJS&lt;/strong> et tous les fichiers doivent être écrits en &lt;strong>Typescript&lt;/strong>.&lt;/p>
&lt;p>Le code est &lt;em>linté&lt;/em> avec &lt;a href="https://eslint.org/">eslint&lt;/a>, et &lt;strong>formaté&lt;/strong> avec &lt;a href="https://prettier.io/">prettier&lt;/a>.&lt;/p>
&lt;h2 id="nomenclature">Nomenclature&lt;/h2>
&lt;p>&lt;img src="https://osrd.fr/images/docs/contribute/nomenclature-front-end.svg" alt="Diagramme de l&amp;rsquo;Infrastructure">&lt;/p>
&lt;p>Les &lt;strong>applications&lt;/strong> (osrd eex, osrd stdcm, éditeur infra, éditeur matériel) proposent des &lt;strong>vues&lt;/strong> (gestion des projets, gestions des études, etc.) liées à des &lt;strong>modules&lt;/strong> (projet, étude, etc.) qui contiennent les composants.&lt;/p>
&lt;p>Ces &lt;strong>vues&lt;/strong> sont constituées de &lt;strong>composants&lt;/strong> et sous-composants &lt;u>tous issus des modules&lt;/u>.
En plus de contenir les fichiers de &lt;strong>vues&lt;/strong> des applications, elles peuvent contenir un répertoire &lt;strong>scripts&lt;/strong> qui propose des scripts liés à ces vues. Les &lt;strong>vues&lt;/strong> déterminent la logique et l&amp;rsquo;&lt;u>accès au store&lt;/u>.&lt;/p>
&lt;p>Les &lt;strong>modules&lt;/strong> sont des collections de &lt;strong>composants&lt;/strong> rattachés à un &lt;strong>objet&lt;/strong> (un scénario, un matériel roulant, un TrainSchedule). Ils contiennent :&lt;/p>
&lt;ul>
&lt;li>un répertoire &lt;em>components&lt;/em> qui héberge &lt;u>tous&lt;/u> les composants&lt;/li>
&lt;li>un répertoire &lt;em>styles&lt;/em> optionnel &lt;u>par module&lt;/u> pour le style des composants en scss&lt;/li>
&lt;li>un répertoire &lt;em>assets&lt;/em> optionnel &lt;u>par module&lt;/u> (qui contient les assets, de jeux de données par défaut par ex, spécifiques au module)&lt;/li>
&lt;li>un fichier &lt;em>reducers&lt;/em> optionnel &lt;u>par module&lt;/u>&lt;/li>
&lt;li>un fichier &lt;em>types&lt;/em> optionnel &lt;u>par module&lt;/u>&lt;/li>
&lt;li>un fichier &lt;em>consts&lt;/em> optionnel &lt;u>par module&lt;/u>&lt;/li>
&lt;/ul>
&lt;p>Un répertoire &lt;strong>assets&lt;/strong> (qui contient les images et autre fichiers).&lt;/p>
&lt;p>Enfin, un répertoire &lt;strong>common&lt;/strong> qui propose :&lt;/p>
&lt;ul>
&lt;li>un répertoire &lt;em>utils&lt;/em> pour les fonctions utilitaires communes à l&amp;rsquo;ensemble du projet&lt;/li>
&lt;li>un fichier &lt;em>types&lt;/em> pour les types communs à l&amp;rsquo;ensemble du projet&lt;/li>
&lt;li>un fichier &lt;em>consts&lt;/em> pour les constantes communes à l&amp;rsquo;ensemble du projet&lt;/li>
&lt;/ul>
&lt;h2 id="principes-dimplémentation">Principes d&amp;rsquo;implémentation&lt;/h2>
&lt;h3 id="routage--slug">Routage &amp;amp; SLUG&lt;/h3>
&lt;p>&lt;em>Rédaction en cours&lt;/em>&lt;/p>
&lt;p>&lt;code>projects/{nom du projet}/studies/{nom de l'étude}/scenarios/{nom du scenario}&lt;/code>&lt;/p>
&lt;h3 id="styles--scss">Styles &amp;amp; SCSS&lt;/h3>
&lt;blockquote>
&lt;p>ATTENTION : en CSS/React, le scope d&amp;rsquo;une classe ne dépend pas de l&amp;rsquo;endroit où le fichier est importé mais est valide pour toute l&amp;rsquo;application. Si vous importez un fichier &lt;code>scss&lt;/code> au fin fond d&amp;rsquo;un composant (ce que nous déconseillons fortement par ailleurs), ses classes seront disponibles pour toute l&amp;rsquo;application et peuvent donc provoquer des effets de bord. Vous pouvez utiliser les CSS modules pour éviter les conflits.&lt;/p>
&lt;/blockquote>
&lt;p>Il est donc très recommandé de pouvoir facilement suivre l&amp;rsquo;arborescence des applications, vues, modules et composants également au sein du code SCSS, et notamment imbriquer les noms de classes pour éviter les effets de bord, le compilateur se chargera de fabriquer la hiérarchie nécessaire.&lt;/p>
&lt;p>Si par exemple nous avons un composant &lt;code>rollingStockSelector&lt;/code> qui propose une liste de matériel &lt;code>rollingStockList&lt;/code> représentés par des cartes &lt;code>rollingStockCard&lt;/code> contenant une image représentant le matériel roulant &lt;code>rollingStockImg&lt;/code> nous devrions avoir la structure SCSS suivante :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-scss" data-lang="scss">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000">.rollinStockSelector&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">.rollingStockList&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">.rollingStockCard&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">.rollingStockImg&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c4a000">width&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>&lt;span style="color:#204a87;font-weight:bold">rem&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c4a000">height&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#ce5c00">auto&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ainsi, on a la garantie que l&amp;rsquo;image contenue dans la carte de matériel roulant héritera bien des bonnes propriétés css &lt;code>.rollinStockSelector.rollingStockList.rollingStockCard.rollingStockImg&lt;/code>.&lt;/p>
&lt;h4 id="css-modules">CSS Modules&lt;/h4>
&lt;p>Les CSS modules permettent de scoper les styles CSS à un composant spécifique, évitant ainsi les conflits de noms de classe globaux.&lt;/p>
&lt;p>Vite prend en charge nativement les CSS modules. Assurez-vous que votre fichier CSS a l&amp;rsquo;extension &lt;code>.module.css&lt;/code>. Par exemple, &lt;code>styles.module.css&lt;/code>.&lt;/p>
&lt;h5 id="utilisation-des-css-modules-dans-les-composants">Utilisation des CSS modules dans les composants&lt;/h5>
&lt;ol>
&lt;li>&lt;strong>Créez un fichier SCSS avec l&amp;rsquo;extension &lt;code>.module.scss&lt;/code>&lt;/strong> :&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-css" data-lang="css">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">/* MyComponent.module.scss */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">container&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">background-color&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#204a87;font-weight:bold">white&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">title&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">font-size&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">24&lt;/span>&lt;span style="color:#204a87;font-weight:bold">px&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">color&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">#333&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>&lt;strong>Utilisez les classes dans votre composant React&lt;/strong> :&lt;/li>
&lt;/ol>
&lt;p>Vite transforme les classes en objets qui contiennent les classes hashées (exemple &lt;code>_container_h3d8bg&lt;/code>) et les utilise au moment de la génération du bundle, rendant ainsi les classes uniques.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-tsx" data-lang="tsx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000">React&lt;/span> &lt;span style="color:#204a87;font-weight:bold">from&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;react&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000">styles&lt;/span> &lt;span style="color:#204a87;font-weight:bold">from&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;./MyComponent.module.scss&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">export&lt;/span> &lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000">MyComponent() {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span> &lt;span style="color:#c4a000">className&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#000">styles&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">container&lt;/span>&lt;span style="color:#000;font-weight:bold">}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">h1&lt;/span> &lt;span style="color:#c4a000">className&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#000">styles&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;title&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">]}&amp;gt;&lt;/span>&lt;span style="color:#000">Mon&lt;/span> &lt;span style="color:#000">Titre&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;lt;/&lt;/span>&lt;span style="color:#204a87;font-weight:bold">h1&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">&amp;lt;/&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Pour plus d&amp;rsquo;information, vous pouvez regarder la &lt;a href="https://vitejs.dev/guide/features.html#css-modules">documentation&lt;/a> de vite.js&lt;/p>
&lt;h4 id="noms-de-classes-utilisation-de-cx">Noms de classes, utilisation de &lt;code>cx()&lt;/code>&lt;/h4>
&lt;p>Les classes sont ajoutées les unes à la suite des autres, normalement, dans la propriété &lt;code>className=&amp;quot;&amp;quot;&lt;/code>.&lt;/p>
&lt;p>Cependant, quand cela est nécessaire — tests pour l&amp;rsquo;utilisation d&amp;rsquo;une classe, concaténation, etc. — nous utilisons la bibliothèque &lt;a href="https://github.com/JedWatson/classnames">classnames&lt;/a> qui préconise l&amp;rsquo;usage suivant :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ts" data-lang="ts">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span> &lt;span style="color:#c4a000">className&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;rollingStockSelector&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span> &lt;span style="color:#c4a000">className&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;rollingStockList&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span> &lt;span style="color:#c4a000">className&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;rollingStockCard w-100 my-2&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">img&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c4a000">className&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#000">cx&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;rollingStockImg&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;m-2&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;p-1&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;bg-white&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">valid&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">isValid&lt;/span>&lt;span style="color:#000;font-weight:bold">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">selected&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">rollingStockID&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">===&lt;/span> &lt;span style="color:#000">selectedRollingStockID&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">})}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">&amp;lt;/&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">&amp;lt;/&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">&amp;lt;/&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Les classes sont &lt;strong>séparées&lt;/strong> chacune dans un &lt;code>string&lt;/code> et les opérations booléennes ou autres sont réalisées dans un objet qui retournera — ou pas — le nom de propriété comme nom de classe à utiliser dans le CSS.&lt;/p>
&lt;h3 id="storeredux">Store/Redux&lt;/h3>
&lt;p>Tout ce qui est &lt;em>selector&lt;/em> est géré par la &lt;strong>vue&lt;/strong> et passé en props aux composants et sous-composants.&lt;/p>
&lt;p>Par conséquent les appels au store en lecture et en écriture doivent être passés un niveau de la vue, en irrigant par des &lt;em>props&lt;/em> et &lt;em>states&lt;/em> les composants proposées par la vue.&lt;/p>
&lt;h3 id="rtk">RTK&lt;/h3>
&lt;p>Utiliser les endpoints générés à partir des fichiers &lt;code>openapi.yaml&lt;/code> pour consommer le backend.&lt;/p>
&lt;h4 id="fonctionnement-du-cache-dans-rtk-query">Fonctionnement du cache dans RTK Query&lt;/h4>
&lt;p>Lorsque de la donnée est récupérée depuis le back, RTK va mettre cette donnée en cache dans le store. Si le même endpoint est appelé avec les même paramètres, RTK va réutiliser la donnée dans le cache plutôt que de rappeler le back.&lt;/p>
&lt;p>Dans le store, vous verrez cette clé &lt;code>editoastApi&lt;/code> qui contient la donnée en cache de tous les endpoints editoast :&lt;/p>
&lt;p>&lt;img src="https://osrd.fr/images/docs/contribute/store-redux-main.png" alt="store Redux">&lt;/p>
&lt;p>Ici par exemple l’endpoint &lt;code>getProjects&lt;/code> a été appelé.&lt;/p>
&lt;p>RTK stocke le nom de l’endpoint, ainsi que les paramètres d’appel, pour former une clé unique &lt;code>nomDuEndpoint({ paramètres })&lt;/code>. (ici &lt;code>getProjects({&amp;quot;ordering&amp;quot;:&amp;quot;LastModifiedDesc&amp;quot;,&amp;quot;pageSize&amp;quot;:1000})&lt;/code>).&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#39;getProjectsByProjectIdStudiesAndStudyId({&amp;#34;projectId&amp;#34;:13,&amp;#34;studyId&amp;#34;:16})&amp;#39;&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">status&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;fulfilled&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">etc&lt;/span>&lt;span style="color:#a40000">…&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#4e9a06">&amp;#39;getProjectsByProjectIdStudiesAndStudyId({&amp;#34;projectId&amp;#34;:13,&amp;#34;studyId&amp;#34;:14})&amp;#39;&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a40000">…&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Dans ce deuxième exemple, le même endpoint a été appelé avec le même paramètre &lt;code>projectId&lt;/code>, mais un paramètre &lt;code>studyId&lt;/code> différent.&lt;/p>
&lt;h5 id="sérialisation-des-clés-dans-le-cache">Sérialisation des clés dans le cache&lt;/h5>
&lt;p>Les string utilisées comme clé dans le cache sont à peu de choses près l’objet paramètre passé à la moulinette &lt;code>JSON.stringify&lt;/code> que transforme un object JS en string (donc sérialisé).&lt;/p>
&lt;p>Normalement La sérialisation ne conserve pas l’ordre des clés des objets. Par exemple, &lt;code>JSON.stringify&lt;/code> ne produira pas la même string avec ces deux objets: &lt;code>{ a: 1, b: 2 }&lt;/code> et &lt;code>{ b: 2, a: 1 }&lt;/code>.&lt;/p>
&lt;p>RTK va optimiser la mise en cache en faisant en sorte que le résultat d’un appel avec &lt;code>{&amp;quot;projectId&amp;quot;:13,&amp;quot;studyId&amp;quot;:16}&lt;/code> ou &lt;code>{&amp;quot;studyId&amp;quot;:16, &amp;quot;projectId&amp;quot;:13}&lt;/code> soient stockées dans la même clé dans le cache.&lt;/p>
&lt;p>Pour voir le fonctionnement en détail, voici le code de cette fonction de sérialisation :&lt;/p>
&lt;details>
&lt;summary>Fonction de sérialisation RTK&lt;/summary>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">defaultSerializeQueryArgs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">SerializeQueryArgs&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#000">any&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">({&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">endpointName&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">queryArgs&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">})&lt;/span> &lt;span style="color:#000;font-weight:bold">=&amp;gt;&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">let&lt;/span> &lt;span style="color:#000">serialized&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">cached&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">cache&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">?&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">get&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">queryArgs&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#204a87;font-weight:bold">typeof&lt;/span> &lt;span style="color:#000">cached&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">===&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;string&amp;#39;&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">serialized&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">cached&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#204a87;font-weight:bold">else&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000">stringified&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">JSON&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">stringify&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">queryArgs&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">key&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">value&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">isPlainObject&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">value&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">?&lt;/span> &lt;span style="color:#204a87">Object&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">keys&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">value&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">sort&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// les clés sont remises dans l’ordre ici
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reduce&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#000">any&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#000;font-weight:bold">((&lt;/span>&lt;span style="color:#000">acc&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">key&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span> &lt;span style="color:#000;font-weight:bold">=&amp;gt;&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">acc&lt;/span>&lt;span style="color:#000;font-weight:bold">[&lt;/span>&lt;span style="color:#000">key&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">value&lt;/span> &lt;span style="color:#000">as&lt;/span> &lt;span style="color:#000">any&lt;/span>&lt;span style="color:#000;font-weight:bold">)[&lt;/span>&lt;span style="color:#000">key&lt;/span>&lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">acc&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">},&lt;/span> &lt;span style="color:#000;font-weight:bold">{})&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ce5c00;font-weight:bold">:&lt;/span> &lt;span style="color:#000">value&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">if&lt;/span> &lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">isPlainObject&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">queryArgs&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">cache&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">?&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">set&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">queryArgs&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">stringified&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">serialized&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">stringified&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// Sort the object keys before stringifying, to prevent useQuery({ a: 1, b: 2 }) having a different cache key than useQuery({ b: 2, a: 1 })
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#4e9a06">`&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">endpointName&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">(&lt;/span>&lt;span style="color:#4e9a06">${&lt;/span>&lt;span style="color:#000">serialized&lt;/span>&lt;span style="color:#4e9a06">}&lt;/span>&lt;span style="color:#4e9a06">)`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/details>
&lt;h5 id="souscriptions-à-la-donnée">Souscriptions à la donnée&lt;/h5>
&lt;p>Dans la terminologie de RTK query, Lorsqu’un composant react appelle un endpoint défini dans RTK Query, il &lt;em>souscrit&lt;/em> à la donnée.&lt;/p>
&lt;p>RTK compte le nombre de référence à la même paire (endpoint,{paramètres}). Lorsque deux composants souscrivent à la même donnée. Ils partagent la même clé dans le cache.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-ts" data-lang="ts">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">osrdEditoastApi&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#204a87;font-weight:bold">from&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;./api.ts&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000">Component1() {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// component subscribes to the data
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">data&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">osrdEditoastApi&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">useGetXQuery&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;...&amp;lt;/&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000">Component2() {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// component subscribes to the data
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">data&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">osrdEditoastApi&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">useGetXQuery&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">2&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;...&amp;lt;/&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000">Component3() {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// component subscribes to the data
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">data&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">osrdEditoastApi&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">useGetXQuery&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;...&amp;lt;/&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">function&lt;/span> &lt;span style="color:#000">Component4() {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8f5902;font-style:italic">// component subscribes to the *same* data as ComponentThree,
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#8f5902;font-style:italic">// as it has the same query parameters
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#204a87;font-weight:bold">const&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">data&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span> &lt;span style="color:#000">osrdEditoastApi&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">useGetXQuery&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;...&amp;lt;/&lt;/span>&lt;span style="color:#204a87;font-weight:bold">div&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Ici &lt;code>Component3&lt;/code> et &lt;code>Component4&lt;/code> ne vont générer qu’un seul appel vers le back. Ils souscrivent à la même donnée (même endpoint et même paramètre &lt;code>3&lt;/code>). Ils vont partager la même clé dans le cache.&lt;/p>
&lt;p>Au total ici il y aura trois appels vers le back, avec les paramètres &lt;code>1&lt;/code>, &lt;code>2&lt;/code>, &lt;code>3&lt;/code>.&lt;/p>
&lt;p>Tant qu’il existe au moins un composant react monté, qui appelle le hook &lt;code>osrdEditoastApi.endpoints.getProjectsByProjectId.useQuery&lt;/code> par exemple, la donnée sera conservée dans le cache.&lt;/p>
&lt;p>Dès que le dernier composant est démonté, la donnée est supprimée du cache au bout de 60 secondes (valeur par défaut).&lt;/p>
&lt;h3 id="traduction-de-lapplication">Traduction de l&amp;rsquo;application&lt;/h3>
&lt;p>La traduction de l&amp;rsquo;application est effectuée sur &lt;a href="https://explore.transifex.com/osrd/osrd/">Transifex&lt;/a>. La langue par défaut est le français.
A noter que si l&amp;rsquo;on doit corriger une traduction, il est recommandé de passer par Transifex. En revanche, si on ajoute une nouvelle clé de traduction, celle-ci peut être ajoutée dans le code directement, dans toutes les langues disponibles.&lt;/p>
&lt;h2 id="lois-et-éléments-importants">Lois et éléments importants&lt;/h2>
&lt;h4 id="aucun-composant-ne-doit-détenir-la-responsabilité-de-mise-à-jour-de-la-donnée-quil-utilise">Aucun composant ne doit détenir la responsabilité de mise à jour de la donnée qu&amp;rsquo;il utilise&lt;/h4>
&lt;p>Seules &lt;u>les vues&lt;/u> contiennent les sélecteurs du store, donnés ensuite en props aux composants du module lié à la vue.&lt;/p>
&lt;h4 id="le-scss-nest-pas-scopé">Le SCSS n&amp;rsquo;est pas scopé&lt;/h4>
&lt;p>Un fichier &lt;code>.scss&lt;/code> enfoui dans l&amp;rsquo;arborescence ne vous garantit pas que les classes contenues soient seulement accessibles à cet endroit, y compris par import react (formellement interdit au passage : vous devez utiliser l&amp;rsquo;import SCSS), toutes les classes déclarées sont accessibles partout.&lt;/p>
&lt;p>Préférez un choix judicieux de nom de classe racine pour un module donné et utilisez l&amp;rsquo;arborescence possible dans le fichier SCSS.&lt;/p>
&lt;h4 id="les-imports-doivent-être-triés-dune-certaine-manière">Les imports doivent être triés d&amp;rsquo;une certaine manière&lt;/h4>
&lt;p>ESLint est configuré pour trier automatiquement les imports en 4 groupes, chacun trié alphabétiquement :&lt;/p>
&lt;ul>
&lt;li>React&lt;/li>
&lt;li>Librairies externes&lt;/li>
&lt;li>Fichiers internes en chemin absolu&lt;/li>
&lt;li>Fichiers internes en chemin relatif&lt;/li>
&lt;/ul>
&lt;p>Chacun de ces groupes est séparé par une ligne vide.&lt;/p>
&lt;p>ESLint déclenchera un avertissement si ces recommandations ne sont pas respectées.&lt;/p>
&lt;h4 id="les-liens-des-imports-doivent-être-absolus">Les liens des imports doivent être absolus&lt;/h4>
&lt;p>Vous devez utiliser le &lt;u>chemin complet&lt;/u> pour tous vos imports.&lt;/p>
&lt;blockquote>
&lt;p>Le chemin peut être relatif seulement si le fichier à importer est dans le même répertoire.&lt;/p>
&lt;/blockquote>
&lt;h2 id="typescript">TypeScript&lt;/h2>
&lt;h3 id="import--export">import &amp;amp; export&lt;/h3>
&lt;p>ESLint et Typescript sont configurés pour imposer l&amp;rsquo;&lt;code>import type&lt;/code> pour un import de type.&lt;/p>
&lt;p>Ceci permet de :&lt;/p>
&lt;ul>
&lt;li>Automatiquement ajouter &lt;code>type&lt;/code> devant l&amp;rsquo;import quand on ajoute un type avec l&amp;rsquo;autocomplétion dans un fichier.&lt;/li>
&lt;li>Afficher 2 erreurs de chacun de ces packages demandant d&amp;rsquo;ajouter &lt;code>type&lt;/code> devant l&amp;rsquo;import si vous ne l&amp;rsquo;avez pas fait.&lt;/li>
&lt;/ul>
&lt;p>Lorsque qu’un &lt;code>import&lt;/code> ou un &lt;code>export&lt;/code> ne comporte que des types, il faut l’indiquer par le mot clé &lt;code>type&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">export&lt;/span> &lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">Direction&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">DirectionalTrackRange&lt;/span> &lt;span style="color:#204a87;font-weight:bold">as&lt;/span> &lt;span style="color:#000">TrackRange&lt;/span> &lt;span style="color:#000;font-weight:bold">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span> &lt;span style="color:#000">typedEntries&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#000">ValueOf&lt;/span> &lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#204a87;font-weight:bold">from&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;utils/types&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Quand un import ne contient pas que des types, il sera agencé de cette manière, par ordre alphabétique.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">import&lt;/span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000">osrdEditoastApi&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">type&lt;/span> &lt;span style="color:#000">ScenarioCreateForm&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span> &lt;span style="color:#204a87;font-weight:bold">from&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;common/api/osrdEditoastApi&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Cette pratique permet de :&lt;/p>
&lt;ul>
&lt;li>Améliorer les performances et le travail d’analyse du compilateur et du linter.&lt;/li>
&lt;li>Rendre ces déclarations plus lisibles, on voit clairement ce qu’on est en train d’importer.&lt;/li>
&lt;li>Éviter des cycles de dépendances :&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://osrd.fr/images/docs/contribute/dependency-cycle.png" alt="dependency cycle">&lt;/p>
&lt;p>L’erreur disparaît avec le mot clé &lt;code>type&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://osrd.fr/images/docs/contribute/dependency-cycle-gone.png" alt="dependency cycle">&lt;/p>
&lt;ul>
&lt;li>Alléger le bundle final (tous les types disparaissent à la compilation).&lt;/li>
&lt;/ul></description></item><item><title>Docs: Licence et mise en place</title><link>https://osrd.fr/fr/docs/guides/contribute/license-and-set-up/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/license-and-set-up/</guid><description>
&lt;h2 id="la-licence-des-contributions-de-code">La licence des contributions de code&lt;/h2>
&lt;p>Tout le code du dépôt OSRD est mis à disposition sous &lt;a href="https://choosealicense.com/licenses/lgpl-3.0/">la licence LGPLv3&lt;/a>.
En contribuant du code, vous acceptez la redistribution de votre contribution sous cette license.&lt;/p>
&lt;p>La licence LGPL interdit de modifier OSRD sans publier le code source de l&amp;rsquo;application modifiée : profitez du travail des autres, et laissez les autres profiter de votre travail !&lt;/p>
&lt;p>Cette contrainte n&amp;rsquo;est pas contagieuse à travers les API : Il est possible d&amp;rsquo;utiliser OSRD comme bibliothèque, framework ou serveur pour s&amp;rsquo;interfacer avec des composants propriétaires. N&amp;rsquo;hésitez pas à proposer des changements pour répondre à vos besoins.&lt;/p>
&lt;h2 id="mise-en-place">Mise en place&lt;/h2>
&lt;div class="alert alert-info" role="alert">
La plupart des développeurs OSRD utilisent Linux (y compris &lt;a href="https://learn.microsoft.com/fr-fr/windows/wsl/">WSL&lt;/a>). Vous pouvez utiliser Windows ou MacOS, mais pourriez rencontrer quelques problèmes.
&lt;/div>
&lt;h3 id="obtenir-le-code-source">Obtenir le code source&lt;/h3>
&lt;ul>
&lt;li>Installer &lt;a href="https://git-scm.com/">&lt;code>git&lt;/code>&lt;/a>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;/li>
&lt;li>Ouvrir un terminal&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup> dans le dossier qui contiendra le code source d&amp;rsquo;OSRD&lt;/li>
&lt;li>&lt;code>git clone https://github.com/OpenRailAssociation/osrd.git&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="lancer-lapplication">Lancer l&amp;rsquo;application&lt;/h3>
&lt;p>Docker est un outil qui réduit considérablement la préparation nécessaire pour travailler sur OSRD:&lt;/p>
&lt;ul>
&lt;li>télécharger le dernier build de développement : &lt;code>docker compose pull&lt;/code>&lt;/li>
&lt;li>démarrer OSRD : &lt;code>docker compose up&lt;/code>&lt;/li>
&lt;li>compiler et démarrer OSRD: &lt;code>docker compose up --build&lt;/code>&lt;/li>
&lt;li>review une PR avec les images compilées par la CI: &lt;code>TAG=pr-XXXXX docker compose up --no-build --pull always&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Pour commencer :&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/install-docker/">Installer &lt;code>docker&lt;/code>&lt;/a>&lt;/li>
&lt;li>Suivre le &lt;a href="https://github.com/OpenRailAssociation/osrd#getting-started">README d&amp;rsquo;OSRD&lt;/a>.&lt;/li>
&lt;/ul>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/contribute-code/">Continuer vers la contribution au code ‣&lt;/a>&lt;/em>&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Sous Linux, utilisez le gestionnaire de packet (comme &lt;code>apt&lt;/code>)&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>Sous Windows, ouvrez &lt;code>Git Bash&lt;/code>&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Docs: Publier une nouvelle version</title><link>https://osrd.fr/fr/docs/guides/release/publish/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/release/publish/</guid><description>
&lt;p>Toutes les versions d&amp;rsquo;OSRD sont accessibles &lt;a href="https://github.com/OpenRailAssociation/osrd/releases">ici&lt;/a>&lt;/p>
&lt;p>Le processus de création d&amp;rsquo;une nouvelle version est le suivant :&lt;/p>
&lt;ol>
&lt;li>Nous publions toujours sur une version testée de l&amp;rsquo;application (branche staging)
&lt;ul>
&lt;li>&lt;code>git switch staging &amp;amp;&amp;amp; git pull&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Créer un tag git &lt;strong>annoté&lt;/strong>
&lt;ul>
&lt;li>Nous utilisons le &lt;a href="https://semver.org/">versionnage sémantique&lt;/a>&lt;/li>
&lt;li>&lt;code>git tag -a vx.y.z&lt;/code> avec le message &lt;code>Release x.y.z&lt;/code> (la plupart du temps, utilisez la dernière version et incrémentez la version patch)&lt;/li>
&lt;li>&lt;code>git push --tags&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Créer une release GitHub
&lt;ul>
&lt;li>Créer une nouvelle release GitHub &lt;a href="https://github.com/OpenRailAssociation/osrd/releases/new">ici&lt;/a>&lt;/li>
&lt;li>Sélectionner le tag créé&lt;/li>
&lt;li>Générer les notes de version&lt;/li>
&lt;li>Renommer la release ainsi : &amp;ldquo;Version x.y.z&amp;rdquo;&lt;/li>
&lt;li>Cocher la case &amp;ldquo;Set as a pre-release&amp;rdquo;&lt;/li>
&lt;li>Appliquer le &lt;a href="#Format du changelog">format du changelog&lt;/a>&lt;/li>
&lt;li>Vous pouvez ensuite &lt;strong>publier&lt;/strong> la release ou &lt;strong>sauvegarder&lt;/strong> le brouillon si vous souhaitez y revenir plus tard&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Une &lt;a href="https://github.com/OpenRailAssociation/osrd/actions/workflows/release.yml">action GitHub&lt;/a> devrait être déclenchée automatiquement.&lt;/li>
&lt;li>Poster le lien de la release créée sur Matrix. Suggérer aux développeurs de revoir la release.&lt;/li>
&lt;/ol>
&lt;h3 id="format-du-changelog">Format du changelog&lt;/h3>
&lt;ol>
&lt;li>Utiliser la structure suivante :&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-md" data-lang="md">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">## What&amp;#39;s Changed
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">### Features :tada:
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">### Code refactoring :recycle:
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">### Bug fixes :bug:
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">## New Contributors
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#800080;font-weight:bold">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&amp;lt;!-- Copy from the generated release notes --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&amp;lt;!-- Copy from the generated release notes --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">**Full Changelog**&lt;/span>: ...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>Répartir les différentes pull requests&lt;/li>
&lt;li>Fusionner ou regrouper les PR quand cela a du sens. Exemples :
&lt;ul>
&lt;li>PR de mise à jour des dépendances (fusionner)&lt;/li>
&lt;li>PR en plusieurs parties (fusionner)&lt;/li>
&lt;li>Une grande fonctionnalité implémentée par plusieurs PR (regrouper)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Reformuler les titres des PR. &lt;strong>Ils doivent être compréhensibles pour un collaborateur externe&lt;/strong>&lt;/li>
&lt;/ol></description></item><item><title>Docs: Écrire du code</title><link>https://osrd.fr/fr/docs/guides/contribute/contribute-code/write-code/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/contribute-code/write-code/</guid><description>
&lt;ol>
&lt;li>
&lt;p>Si vous n&amp;rsquo;être pas un habitué de Git, &lt;a href="https://learngitbranching.js.org/">suivez ce tutoriel&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Créez une branche&lt;/strong>&lt;br>
Si vous comptez contribuer régulièrement, vous pouvez demander accès au &lt;a href="https://github.com/OpenRailAssociation/osrd">dépôt principal&lt;/a>. Sinon, &lt;a href="https://github.com/OpenRailAssociation/osrd/fork">créez un fork&lt;/a>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Ajoutez des changements sur votre branche&lt;/strong>&lt;br>
Essayez de découper votre travail en étapes macroscopiques, et sauvegardez vos changements dans un commit à la fin de chaque étape. Essayez de suivre &lt;a href="../conventions/">les conventions du projet&lt;/a>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Conservez votre branche à jour&lt;/strong>&lt;/p>
&lt;pre tabindex="0">&lt;code>git switch &amp;lt;your_branch&amp;gt;
git fetch
git rebase origin/dev
&lt;/code>&lt;/pre>&lt;/li>
&lt;/ol>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/contribute-code/commit-conventions/">Continuer vers le style des commits ‣&lt;/a>&lt;/em>&lt;/p></description></item><item><title>Docs: Conventions de commits</title><link>https://osrd.fr/fr/docs/guides/contribute/contribute-code/commit-conventions/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/contribute-code/commit-conventions/</guid><description>
&lt;h2 id="style-de-commits">Style de commits&lt;/h2>
&lt;p>Le format général des commits est le suivant :&lt;/p>
&lt;pre tabindex="0">&lt;code>composant1, composant2: description du changement à l&amp;#39;impératif
Description détaillée ou technique du contenu et de la motivation du
changement, si le titre n&amp;#39;est pas complètement évident.
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>&lt;strong>le message comme le code doit être en anglais&lt;/strong> (seulement des caractères ASCII pour le titre)&lt;/li>
&lt;li>il peut y avoir plusieurs composants, séparés par des &lt;code>:&lt;/code> quand il y a une relation hiérarchique, ou des &lt;code>,&lt;/code> sinon&lt;/li>
&lt;li>les composants sont en minuscule, avec éventuellement &lt;code>-&lt;/code>, &lt;code>_&lt;/code> ou &lt;code>.&lt;/code>&lt;/li>
&lt;li>la description du changement à l&amp;rsquo;impératif commence par un verbe en minuscule&lt;/li>
&lt;li>le titre ne doit pas comporter de lien (&lt;code>#&lt;/code> est interdit)&lt;/li>
&lt;/ul>
&lt;p>Idéalement :&lt;/p>
&lt;ul>
&lt;li>le titre doit être autonome : pas besoin de lire autre chose pour le comprendre&lt;/li>
&lt;li>le titre du commit est entièrement en minuscule&lt;/li>
&lt;li>le titre est clair pour une personne étrangère au code&lt;/li>
&lt;li>le corps du commit contient une description du changement&lt;/li>
&lt;/ul>
&lt;div class="alert alert-info" role="alert">
Une vérification automatique est effectuée pour vérifier autant que possible ce formatage.
&lt;/div>
&lt;h3 id="contre-exemples-de-titres-de-commit">Contre-exemples de titres de commit&lt;/h3>
&lt;p>A éviter absolument:&lt;/p>
&lt;ul>
&lt;li>&lt;code>component: update ./some/file.ext&lt;/code> : préciser la mise à jour en question plutôt que le fichier,
les fichiers sont des éléments techniques bienvenus dans le &lt;em>corps&lt;/em> du commit&lt;/li>
&lt;li>&lt;code>component: fix #42&lt;/code> : préciser le problème corrigé, les liens (vers l&amp;rsquo;issue, etc.) sont
encouragés dans le &lt;em>corps&lt;/em> du commit&lt;/li>
&lt;li>&lt;code>wip&lt;/code> : décrire le travail (et le finir)&lt;/li>
&lt;/ul>
&lt;p>Bienvenus pour faciliter la relecture, mais ne pas merger:&lt;/p>
&lt;ul>
&lt;li>&lt;code>fixup! previous commit&lt;/code> : un &lt;a href="../share-changes">autosquash&lt;/a> devra être lancé avant le merge&lt;/li>
&lt;li>&lt;code>Revert &amp;quot;previous commit of the same PR&amp;quot;&lt;/code> : les deux commits devront être retirés avant merge&lt;/li>
&lt;/ul>
&lt;h2 id="le-developer-certificate-of-origin-dco">Le Developer Certificate of Origin (DCO)&lt;/h2>
&lt;p>Tous les projets d&amp;rsquo;OSRD utilisent le DCO (certificat du développeur d&amp;rsquo;origine)
pour des raisons légales. Le DCO permet de confirmer que vous avez les droits
sur le code que vous contribuez. Pour en savoir plus sur l&amp;rsquo;histoire et
l&amp;rsquo;objectif du DCO, vous pouvez lire &lt;a href="https://bssw.io/blog_posts/the-developer-certificate-of-origin">The Developer Certificate of Origin&lt;/a>
de Roscoe A. Bartlett.&lt;/p>
&lt;p>Pour se conformer au DCO, &lt;strong>tous les commits doivent inclure une ligne
Signed-off-by&lt;/strong>.&lt;/p>
&lt;h3 id="comment-signer-un-commit-avec-git-dans-un-terminal-">Comment signer un commit avec Git dans un terminal ?&lt;/h3>
&lt;p>Pour signer un commit, il suffit d&amp;rsquo;ajouter l&amp;rsquo;option &lt;code>-s&lt;/code> à votre commande &lt;code>git commit&lt;/code>, comme ceci :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>git commit -s -m &lt;span style="color:#4e9a06">&amp;#34;Your commit message&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Cela s&amp;rsquo;applique également lors de l&amp;rsquo;utilisation de la commande &lt;code>git revert&lt;/code>.&lt;/p>
&lt;h3 id="comment-signer-un-commit-avec-git-dans-visual-studio-code-vs-code-">Comment signer un commit avec Git dans Visual Studio Code (VS Code) ?&lt;/h3>
&lt;p>Allez dans &lt;code>Fichiers&lt;/code> -&amp;gt; &lt;code>Préférences&lt;/code> -&amp;gt; &lt;code>Paramètres&lt;/code>, puis recherchez et
activez le paramètre &lt;strong>Always Sign Off&lt;/strong>.&lt;/p>
&lt;p>Ensuite, lorsque vous ferez un commit via l&amp;rsquo;interface de VS Code, ils seront
automatiquement signés.&lt;/p>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/contribute-code/share-changes/">Continuer vers le partage des changements ‣&lt;/a>&lt;/em>&lt;/p></description></item><item><title>Docs: Revue de code</title><link>https://osrd.fr/fr/docs/guides/contribute/code-review/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/code-review/</guid><description>
&lt;p>Le reviewer/mainteneur s&amp;rsquo;engage à effectuer la revue de code rapidement, c&amp;rsquo;est aussi à lui qu&amp;rsquo;appartient de fermer les « &lt;em>request changes&lt;/em> », de bien vérifier l&amp;rsquo;historique des commits, et de fusionner la « &lt;em>pull request&lt;/em> » s&amp;rsquo;il en a les droits.&lt;/p>
&lt;p>Nous vous soumettons quelques conseils et recommandations qui nous semblent pertinentes pour une revue de code humaine, pertinente et enrichissante pour tous ses contributeurs :&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://mtlynch.io/code-review-love/">How to Make Your Code Reviewer Fall in Love with You?&lt;/a> par Michael Lynch.&lt;/li>
&lt;li>&lt;a href="https://mtlynch.io/human-code-reviews-1/">How to Do Code Reviews Like a Human? &lt;/a> par Michael Lynch.&lt;/li>
&lt;/ul>
&lt;h2 id="cycle-de-review">Cycle de review&lt;/h2>
&lt;p>Une revue de code est un processus itératif.
Pour la fluidité d&amp;rsquo;une review, il est impératif de &lt;a href="https://docs.github.com/en/account-and-profile/managing-subscriptions-and-notifications-on-github/setting-up-notifications/configuring-notifications">configurer correctement ses notifications github&lt;/a>.&lt;/p>
&lt;p>Il est conseillé de configurer les dépôts OSRD en &lt;em>&amp;ldquo;Participating and @mentions&amp;rdquo;&lt;/em>. Cela permet d&amp;rsquo;être notifié d&amp;rsquo;activités uniquement sur les issues et PR auxquelles vous participez.&lt;/p>
&lt;pre class="mermaid">sequenceDiagram
actor A as Auteur PR
actor R as Reviewer/mainteneur
A-&amp;gt;&amp;gt;R: Demande une review en notifiant spécifiquement quelques personnes
R-&amp;gt;&amp;gt;A: Répond à la demande par oui ou non
loop Boucle entre auteur et reviewer
R--&amp;gt;&amp;gt;A: Commente, demande des changements
A--&amp;gt;&amp;gt;R: Répond à chaque commentaire/demande de changement
A--&amp;gt;&amp;gt;R: Corrige le code si nécessaire dans des « fixups » dédiés
R--&amp;gt;&amp;gt;A: Vérifie, teste, et commente à nouveau le code
R--&amp;gt;&amp;gt;A: Résout les conversations/demandes de changement le cas échéant
end
A-&amp;gt;&amp;gt;R: Rebase si nécessaire
R-&amp;gt;&amp;gt;A: Vérifie l&amp;#39;historique des commits
R-&amp;gt;&amp;gt;A: Approuve ou ferme la PR
Note left of R: Et fusionne si mainteneur&lt;/pre>
&lt;blockquote>
&lt;p>Les mainteneurs sont automatiquement notifiés par le système de &lt;code>CODEOWNERS&lt;/code>. L&amp;rsquo;auteur d&amp;rsquo;une PR est responsable de faire avancer sa PR dans le processus de review (quitte à notifier manuellement un mainteneur).&lt;/p>
&lt;/blockquote>
&lt;h2 id="la-pyramide-de-la-revue-de-code">La pyramide de la revue de code&lt;/h2>
&lt;figure>&lt;a href="https://www.morling.dev/blog/the-code-review-pyramid/">
&lt;img src="https://osrd.fr/images/docs/contribute/code_review_pyramid.svg"/> &lt;/a>
&lt;/figure>
&lt;h2 id="script-pour-le-test-dune-pr">Script pour le test d&amp;rsquo;une PR&lt;/h2>
&lt;p>Lors de la revue d&amp;rsquo;une PR, il est utile de tester les changements en démarrant une instance de l&amp;rsquo;application OSRD basée sur la branche de la PR.&lt;/p>
&lt;p>Un script est disponible pour lancer automatiquement une instance séparée et dédiée de l&amp;rsquo;application en utilisant le numéro de la PR. Le script utilise les images Docker déjà construites par la CI et lance l&amp;rsquo;application de manière isolée. Cela permet d&amp;rsquo;exécuter les deux instances en parallèle, sans conflits (idéal pour comparer les modifications, par exemple).&lt;/p>
&lt;p>De plus, vous pouvez fournir une sauvegarde de la base de données, que le script chargera directement dans l&amp;rsquo;application.&lt;/p>
&lt;p>L&amp;rsquo;application sera lancée sur le port 4001. Vous pouvez y accéder en suivant : http://localhost:4001/&lt;/p>
&lt;h3 id="commandes-disponibles-">Commandes Disponibles :&lt;/h3>
&lt;ul>
&lt;li>&lt;code>./scripts/pr-tests-compose.sh 8914 up&lt;/code> : Télécharge les images CI générées pour la PR #8914 et lance l&amp;rsquo;application.&lt;/li>
&lt;li>&lt;code>./scripts/pr-tests-compose.sh 8914 up-and-load-backup ./path_to_backup&lt;/code> : Télécharge les images pour la PR #8914, restaure les données à partir de la sauvegarde spécifiée, et démarre l&amp;rsquo;application.&lt;/li>
&lt;li>&lt;code>./scripts/pr-tests-compose.sh down&lt;/code> : Arrête l&amp;rsquo;instance de test de l&amp;rsquo;application pour la PR #8914.&lt;/li>
&lt;li>&lt;code>./scripts/pr-tests-compose.sh down-and-clean&lt;/code> : Arrête l&amp;rsquo;instance de test et nettoie l&amp;rsquo;ensemble des volumes docker de l&amp;rsquo;instance (base de donnée PG, cache Valkey, RabbitMQ) pour éviter tout effet de bord.&lt;/li>
&lt;/ul>
&lt;h3 id="accès-aux-services-">Accès aux Services :&lt;/h3>
&lt;p>À l&amp;rsquo;exception du serveur frontend, tous les services sont disponibles sur localhost, avec un léger ajustement de port (pour éviter les conflits avec l&amp;rsquo;environnement de développement) : pour la liste des ports, reportez-vous au &lt;a href="https://github.com/OpenRailAssociation/osrd/blob/dev/docker/docker-compose.pr-test.yml">fichier docker compose dédié&lt;/a>.&lt;/p></description></item><item><title>Docs: Partagez vos changements</title><link>https://osrd.fr/fr/docs/guides/contribute/contribute-code/share-changes/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/contribute-code/share-changes/</guid><description>
&lt;p>L&amp;rsquo;auteur d&amp;rsquo;une &lt;em>pull request (PR)&lt;/em> est responsable de son « cycle de vie ». Il se charge de contacter les différents acteurs, de suivre la revue de code, répondre aux commentaires et corriger le code suite à la revue de code (vous pouvez également consulter la &lt;a href="https://osrd.fr/fr/docs/guides/contribute/code-review/">page dédiée à la revue de code&lt;/a>).&lt;/p>
&lt;blockquote>
&lt;p>En cas de PR conséquente, ne pas hésiter à solliciter plusieurs reviewers qui pourront s&amp;rsquo;organiser, voire de faire la review ensemble, reviewers et auteur.&lt;/p>
&lt;/blockquote>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Ouvrez une &lt;em>pull request&lt;/em>&lt;/strong> &lt;br>
Une fois que vos changements sont prêts, il est temps de proposer de les intégrer à la branche &lt;code>dev&lt;/code>.
Cela se fait &lt;a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/creating-a-pull-request">dans l&amp;rsquo;interface web de Github&lt;/a>.&lt;/p>
&lt;p>Si possible :&lt;/p>
&lt;ul>
&lt;li>Faites des PRs d&amp;rsquo;unités logiques et atomiques également (évitez de mélanger le refactoring, les nouvelles fonctionnalités et la correction de bugs en même temps).&lt;/li>
&lt;li>Ajoutez une description aux PR pour expliquer ce qu&amp;rsquo;elles font et pourquoi.&lt;/li>
&lt;li>Aidez le relecteur en suivant les conseils donnés dans &lt;a href="https://mtlynch.io/code-review-love/">l&amp;rsquo;article de mtlynch&lt;/a>.&lt;/li>
&lt;li>Ajoutez les balises &lt;code>area:&amp;lt;affected_area&amp;gt;&lt;/code> pour montrer quelle partie de l&amp;rsquo;application a été impactée. Cela peut être fait via &lt;a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/creating-a-pull-request">l&amp;rsquo;interface web&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Prenez en compte les retours&lt;/strong> &lt;br>
Une fois que votre PR est ouverte, &lt;a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/about-pull-request-reviews">d&amp;rsquo;autres contributeurs doivent donner leur avis sur votre proposition&lt;/a> :&lt;/p>
&lt;ul>
&lt;li>N&amp;rsquo;importe qui peut donner son avis.&lt;/li>
&lt;li>Il est nécessaire d&amp;rsquo;obtenir l&amp;rsquo;approbation d&amp;rsquo;un &lt;a href="https://github.com/OpenRailAssociation/osrd/blob/dev/.github/CODEOWNERS">contributeur familier avec le code&lt;/a>.&lt;/li>
&lt;li>Il est d&amp;rsquo;usage de prendre en compte tous les commentaires critiques.&lt;/li>
&lt;li>Les commentaires sont souvent écrits dans un style plutôt direct, dans le souci de collaborer efficacement vers une solution acceptable par tous.&lt;/li>
&lt;li>Une fois que tous les commentaires ont été pris en compte, un mainteneur intègre le changement.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>Sur les PR conséquentes et vouées à évoluer dans le temps, conserver les &lt;em>corrections&lt;/em> suite à la
relecture dans des &lt;em>commits séparés&lt;/em> facilite le travail de relecture. En cas de &lt;code>rebase&lt;/code> et de
relectures multiples par la même personne ils sont le moyen d&amp;rsquo;économiser une nouvelle relecture
complète (demandez de l&amp;rsquo;aide au besoin) :&lt;/p>
&lt;ul>
&lt;li>&lt;em>Ajoutez des commits de fixup&lt;/em>, amend, squash ou reword à l&amp;rsquo;aide de la
&lt;a href="https://git-scm.com/docs/git-commit#Documentation/git-commit.txt---fixupamendrewordltcommitgt">documentation dédiée à git commit&lt;/a>.&lt;/li>
&lt;li>&lt;em>Fusionnez automatiquement les corrections&lt;/em> dans les commits originaux de votre PR et vérifier le résultat , à l&amp;rsquo;aide de
&lt;a href="https://git-scm.com/docs/git-rebase#Documentation/git-rebase.txt---autosquash">&lt;code>git rebase -i --autosquash origin/dev&lt;/code>&lt;/a>
(juste avant le merge et une fois les relectures terminées).&lt;/li>
&lt;li>&lt;em>Poussez vos changements&lt;/em> avec
&lt;a href="https://git-scm.com/docs/git-push#Documentation/git-push.txt---no-force-with-lease">&lt;code>git push --force-with-lease&lt;/code>&lt;/a>
car vous ne poussez pas seulement de nouveaux commits, mais bien un changement des commits existants.&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ol start="3">
&lt;li>&lt;strong>N&amp;rsquo;hésitez pas à relancer vos interlocuteurs, plusieurs fois si besoin est : vous êtes responsable de la vie de votre &lt;em>pull request&lt;/em>&lt;/strong>.&lt;/li>
&lt;/ol>
&lt;h2 id="cycle-de-review">Cycle de review&lt;/h2>
&lt;p>Une revue de code est un processus itératif.
Pour la fluidité d&amp;rsquo;une review, il est impératif de &lt;a href="https://docs.github.com/en/account-and-profile/managing-subscriptions-and-notifications-on-github/setting-up-notifications/configuring-notifications">configurer correctement ses notifications github&lt;/a>.&lt;/p>
&lt;p>Il est conseillé de configurer les dépôts OSRD en &lt;em>&amp;ldquo;Participating and @mentions&amp;rdquo;&lt;/em>. Cela permet d&amp;rsquo;être notifié d&amp;rsquo;activités uniquement sur les issues et PR auxquelles vous participez.&lt;/p>
&lt;pre class="mermaid">sequenceDiagram
actor A as Auteur PR
actor R as Reviewer/mainteneur
A-&amp;gt;&amp;gt;R: Demande une review en notifiant spécifiquement quelques personnes
R-&amp;gt;&amp;gt;A: Répond à la demande par oui ou non
loop Boucle entre auteur et reviewer
R--&amp;gt;&amp;gt;A: Commente, demande des changements
A--&amp;gt;&amp;gt;R: Répond à chaque commentaire/demande de changement
A--&amp;gt;&amp;gt;R: Corrige le code si nécessaire dans des « fixups » dédiés
R--&amp;gt;&amp;gt;A: Vérifie, teste, et commente à nouveau le code
R--&amp;gt;&amp;gt;A: Résout les conversations/demandes de changement le cas échéant
end
A-&amp;gt;&amp;gt;R: Rebase si nécessaire
R-&amp;gt;&amp;gt;A: Vérifie l&amp;#39;historique des commits
R-&amp;gt;&amp;gt;A: Approuve ou ferme la PR
Note left of R: Et fusionne si mainteneur&lt;/pre>
&lt;blockquote>
&lt;p>Les mainteneurs sont automatiquement notifiés par le système de &lt;code>CODEOWNERS&lt;/code>. L&amp;rsquo;auteur d&amp;rsquo;une PR est responsable de faire avancer sa PR dans le processus de review (quitte à notifier manuellement un mainteneur).&lt;/p>
&lt;/blockquote>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/contribute-code/tests/">Continuer enfin vers les tests ‣&lt;/a>&lt;/em>&lt;/p></description></item><item><title>Docs: Signaler des problèmes</title><link>https://osrd.fr/fr/docs/guides/contribute/bug-reports/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/bug-reports/</guid><description>
&lt;p>&lt;strong>N&amp;rsquo;hésitez pas à signaler tout ce qui vous semble important !&lt;/strong>&lt;/p>
&lt;p>Notre outil de suivi des bugs est &lt;a href="https://github.com/OpenRailAssociation/osrd/issues">github&lt;/a>. Il est nécessaire de s&amp;rsquo;inscrire pour signaler un bug.&lt;/p>
&lt;p>Suivez &lt;a href="https://github.com/OpenRailAssociation/osrd/issues/new/choose">ce lien&lt;/a> et choisissez le modèle qui correspond à votre cas de figure.&lt;/p>
&lt;h3 id="bugs">Bugs&lt;/h3>
&lt;ul>
&lt;li>Le bug doit avoir une description correcte et le modèle du bug doit être rempli avec soin.&lt;/li>
&lt;li>Le bug doit être étiqueté avec (&lt;em>pour les membres de l&amp;rsquo;équipe&lt;/em>) :
&lt;ul>
&lt;li>&lt;code>kind:bug&lt;/code>&lt;/li>
&lt;li>une ou plusieurs &lt;code>area:&amp;lt;affected_area&amp;gt;&lt;/code> si possible (si la zone affectée n&amp;rsquo;est pas connue, laissez-la vide et elle sera ajoutée plus tard par un autre membre de l&amp;rsquo;équipe).&lt;/li>
&lt;li>un &lt;code>severity:&amp;lt;bug_severity&amp;gt;&lt;/code> si possible (si la sévérité n&amp;rsquo;est pas connue, laissez-la vide et elle sera ajoutée plus tard par un autre membre de l&amp;rsquo;équipe).
&lt;ul>
&lt;li>&lt;code>severity:minor&lt;/code> : L&amp;rsquo;utilisateur peut encore utiliser la fonctionnalité.&lt;/li>
&lt;li>&lt;code>severity:major&lt;/code> : L&amp;rsquo;utilisateur ne peut parfois pas utiliser la fonctionnalité.&lt;/li>
&lt;li>&lt;code>severity:critical&lt;/code> : L&amp;rsquo;utilisateur ne peut pas utiliser la fonctionnalité.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Les membres de l&amp;rsquo;équipe OSRD peuvent modifier les étiquettes des problèmes (gravité, domaine, type, &amp;hellip;).
Vous pouvez laisser un commentaire pour expliquer les changements.&lt;/li>
&lt;li>Si vous travaillez sur un bug ou planifiez de travailler sur un bug, assignez vous au bug.&lt;/li>
&lt;li>Les PRs qui résolvent des bugs doivent ajouter des tests de régression pour s&amp;rsquo;assurer que le bug ne reviendra pas dans le futur.&lt;/li>
&lt;/ul></description></item><item><title>Docs: Tests</title><link>https://osrd.fr/fr/docs/guides/contribute/contribute-code/tests/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/contribute-code/tests/</guid><description>
&lt;h2 id="back-end">Back-end&lt;/h2>
&lt;ul>
&lt;li>Les tests d&amp;rsquo;intégration sont écrits avec &lt;a href="https://docs.pytest.org/">pytest&lt;/a> dans le dossier &lt;code>/tests&lt;/code>.&lt;/li>
&lt;li>Chaque route décrite dans les fichiers &lt;code>openapi.yaml&lt;/code> doit avoir un test d&amp;rsquo;intégration.&lt;/li>
&lt;li>Le test doit vérifier à la fois le format et le contenu des réponses valides et invalides.&lt;/li>
&lt;/ul>
&lt;h2 id="front-end">Front-end&lt;/h2>
&lt;p>L&amp;rsquo;écriture fonctionnelle des tests est réalisée avec les &lt;em>Product Owners&lt;/em>, et les développeurs choisissent une implémentation technique qui répond précisément aux besoins exprimés et qui s&amp;rsquo;intègre dans les recommandations présentes ici.&lt;/p>
&lt;p>Nous utilisons &lt;a href="https://playwright.dev/">Playwright&lt;/a> pour écrire les tests bout en bout, et &lt;a href="https://vitest.dev/">vitest&lt;/a> pour écrire les tests unitaires.&lt;/p>
&lt;p>Les navigateurs testés sont pour l&amp;rsquo;instant &lt;a href="https://www.mozilla.org/fr/firefox/switch/">Firefox&lt;/a> et Chromium.&lt;/p>
&lt;h3 id="principes-de-base">Principes de base&lt;/h3>
&lt;ul>
&lt;li>Les tests doivent être &lt;strong>courts&lt;/strong> (1min max) et aller &lt;strong>droit au but&lt;/strong>.&lt;/li>
&lt;li>Les timeout arbitraires sont proscrits, un test doit systématiquement attendre un évènement spécifique. Il est possible d&amp;rsquo;utiliser le &lt;em>polling&lt;/em> (retenter une action — un clic par exemple — au bout d&amp;rsquo;un certain temps) proposé dans l&amp;rsquo;API de &lt;a href="https://playwright.dev/">Playwright&lt;/a>.&lt;/li>
&lt;li>Les tests doivent tous pouvoir être parallélisables.&lt;/li>
&lt;li>Les tests ne doivent pas pointer/attendre des éléments de texte issus de la traduction, préférer l&amp;rsquo;arborescence du &lt;em>DOM&lt;/em> ou encore placer des &lt;code>id&lt;/code> spécifiques.&lt;/li>
&lt;li>On ne teste pas les données mais l&amp;rsquo;application et ses fonctionnalités. Des tests spécifiques aux données sont à élaborer par ailleurs.&lt;/li>
&lt;/ul>
&lt;h4 id="données">Données&lt;/h4>
&lt;p>&lt;strong>Les données testées doivent impérativement être des données publiques.&lt;/strong>
Les données nécessaires (infrastructure et matériel) aux tests sont proposées dans des fichiers &lt;code>json&lt;/code> de l&amp;rsquo;application, &lt;em>injectées&lt;/em> au début de chaque test et effacées à la fin peu importe son résultat ou la manière d&amp;rsquo;être stoppé, y compris par &lt;code>CTRL+C&lt;/code>.&lt;/p>
&lt;p>Cela se fait par des appels API en typescript avant de lancer le test à proprement parler.&lt;/p>
&lt;p>Les données testées sont les mêmes en local ou via l&amp;rsquo;intégration continue.&lt;/p>
&lt;h4 id="processus-de-développement-des-tests-e2e">Processus de développement des tests e2e&lt;/h4>
&lt;p>Les tests e2e sont implémentés de manière itérative, et livrés en même temps que les développements. À noter que:&lt;/p>
&lt;ul>
&lt;li>les tests e2e ne doivent être développés que sur les parcours utilisateurs critiques de l&amp;rsquo;application.&lt;/li>
&lt;li>ce workflow permet d’éviter les régressions immédiates après la sortie d&amp;rsquo;une fonctionnalité, de faire monter toute l’équipe en compétences sur les tests e2e et d’éviter des PRs très longues qui ajouteraient des tests e2e entiers&lt;/li>
&lt;li>on accepte que les tests e2e soient partiels le temps des développements et que le développement des tests alourdisse la taille des tickets et le temps de développement.&lt;/li>
&lt;li>certaines parties du test devront être mockées le temps que la fonctionnalité soit entièrement développée mais à la fin des développements, le test e2e devra être complet et les données mockées devront avoir disparu. Les modifications finales à faire dans le test pour retirer le mocking seront normalement minimes (uniquement changer les expected values).&lt;/li>
&lt;li>les cas de test et les parcours utilisateur devront être définis en amont, au moment de la conception du ticket (&lt;em>refinement&lt;/em>), avant le PIP. Ils pourront être proposés par un QA ou un.e PO, et devront être validés par un QA, le.la PO compétent.e et des devs front.&lt;/li>
&lt;li>si un test e2e touche à la configuration des tests e2e, à l’architecture du projet (typiquement le snapshotting) ou présente un risque de ralentir la CI, un atelier de conception (&lt;em>refinement&lt;/em>) devra être organisé pour consulter les personnes en charge de l&amp;rsquo;architecture du projet et de la CI, notamment la team devops.&lt;/li>
&lt;/ul>
&lt;h4 id="atomicité-dun-test">Atomicité d&amp;rsquo;un test&lt;/h4>
&lt;p>Chaque test doit être &lt;strong>atomique&lt;/strong> : il se suffit à lui-même et ne peut pas être divisé.&lt;/p>
&lt;p>Un test va cibler une fonctionnalité ou un composant, si ce dernier n&amp;rsquo;est pas trop gros. Un test ne testera pas tout un module ou tout une application, ce sera forcément un ensemble de tests afin de préserver l&amp;rsquo;atomicité des tests.&lt;/p>
&lt;p>Si un test a besoin que des éléments soient créés ou ajoutés, ces opérations doivent être opérées par des appels API en typescript en amont du test, à l&amp;rsquo;instar de ce qui est fait pour l&amp;rsquo;ajout de données. Ces éléments doivent être supprimés à l&amp;rsquo;issue du test, peu importe son résultat ou la manière d&amp;rsquo;être stoppé, y compris par &lt;code>CTRL+C&lt;/code>.&lt;/p>
&lt;p>Cela permettra notamment la parallélisation des tests.&lt;/p>
&lt;p>Un test peut cependant, dans certains cas de figure où cela est pertinent, contenir plusieurs sous-divisions de test, clairement explicitées, et justifiées (plusieurs &lt;code>test()&lt;/code> dans un seul &lt;code>describe()&lt;/code>).&lt;/p>
&lt;h3 id="exemple-de-test">Exemple de test&lt;/h3>
&lt;p>Le besoin : « nous voulons tester l&amp;rsquo;ajout d&amp;rsquo;un train dans une grille horaire ».&lt;/p>
&lt;ol>
&lt;li>ajouter l&amp;rsquo;infrastructure et le matériel roulant de test dans la base de données &lt;strong>par appels API&lt;/strong>&lt;/li>
&lt;li>créer projet, étude et scénario avec choix de l&amp;rsquo;infra de test &lt;strong>par appels API&lt;/strong>&lt;/li>
&lt;li>début du test qui clique sur « ajouter un ou plusieurs trains » jusqu&amp;rsquo;à la vérification de la présence des trains dans la grille horaire&lt;/li>
&lt;li>le test a réussi, a échoué, ou est stoppé, le projet, l&amp;rsquo;étude et le scénario sont effacés, ainsi que le matériel roulant et et l&amp;rsquo;infrastructure de test &lt;strong>par appels API&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>&lt;em>NB : le test ne va pas tester toutes les possibilités offertes par l&amp;rsquo;ajout de trains, cela relève d&amp;rsquo;un test spécifique qui testerait la réponse de l&amp;rsquo;interface pour tous les cas de figure sans ajouter de trains.&lt;/em>&lt;/p>
&lt;p>&lt;em>&lt;a href="https://osrd.fr/fr/docs/guides/contribute/contribute-code/write-code/">Continuer vers l&amp;rsquo;écriture de code ‣&lt;/a>&lt;/em>&lt;/p></description></item><item><title>Docs: Contexte métier</title><link>https://osrd.fr/fr/docs/reference/design-docs/stdcm/domain_context/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/stdcm/domain_context/</guid><description>
&lt;p>Quelques définitions :&lt;/p>
&lt;h3 id="la-capacité">La capacité&lt;/h3>
&lt;p>La &lt;strong>capacité&lt;/strong>, dans ce contexte, correspond à la possibilité de
réserver des éléments d&amp;rsquo;infrastructure pour permettre le passage
d&amp;rsquo;un train.&lt;/p>
&lt;p>La capacité s&amp;rsquo;exprime en fonction de l&amp;rsquo;espace et du temps :
la réservation d&amp;rsquo;un élément peut bloquer une zone précise
qui devient inaccessible aux autres trains, et cette réservation
se fait sur un intervalle de temps.&lt;/p>
&lt;p>On peut la représenter
sur un graphique, avec le temps en abscisse et la distance parcourue
sur un chemin en ordonnée.&lt;/p>
&lt;p>&lt;img src="space_time_chart.png" alt="Graphique espace temps">&lt;/p>
&lt;blockquote>
&lt;p>Exemple d&amp;rsquo;un graphique espace-temps montrant le passage d&amp;rsquo;un train.&lt;/p>
&lt;p>Les couleurs représentent ici les aspects des signaux, mais
montrent également une consommation de la capacité :
quand ces blocs se superposent pour deux trains, ils sont en conflit.&lt;/p>
&lt;/blockquote>
&lt;p>Deux trains d&amp;rsquo;une grille horaire sont en &lt;strong>conflit&lt;/strong>
quand ils réservent en même temps un même objet, dans des
configurations incompatibles.&lt;/p>
&lt;p>&lt;img src="conflict.png" alt="Graphique espace temps avec conflit">&lt;/p>
&lt;blockquote>
&lt;p>Exemple d&amp;rsquo;un graphique espace-temps avec conflit : le second train
est plus rapide que le premier, ils sont en conflit sur la fin du trajet,
quand les rectangles se superposent.&lt;/p>
&lt;p>En essayant de simuler cette grille horaire, le second train serait
ralentis par des signaux indiquant de ralentir, provoqués par la
présence du premier train.&lt;/p>
&lt;/blockquote>
&lt;p>La consommation de capacité est souvent représentée sous la forme de
rectangles car, dans les systèmes de signalisation les plus simples,
il s&amp;rsquo;agit de réservations d&amp;rsquo;une zone fixe dans l&amp;rsquo;espace pendant un intervalle de temps donné.&lt;/p>
&lt;h3 id="les-sillons-horaires">Les sillons horaires&lt;/h3>
&lt;p>Un &lt;strong>sillon&lt;/strong> correspond à une réservation de capacité pour le
passage d&amp;rsquo;un train. Il est fixé dans l&amp;rsquo;espace et dans le temps :
le temps de départ et le chemin emprunté sont connus.
Sur les graphiques espace-temps de cette page, un sillon correspond
à l&amp;rsquo;ensemble des blocs pour un train.&lt;/p>
&lt;p>Dans un fonctionnement habituel, le gestionnaire d&amp;rsquo;infrastructure
(ex : SNCF Réseau) propose des sillons à la vente pour les entreprises
ferroviaires (ex : SNCF Voyageurs).&lt;/p>
&lt;p>À une date donnée avant le jour de
circulation prévu, tous les sillons sont attribués. Mais &lt;strong>il peut rester
assez de capacité pour faire rouler plus de trains&lt;/strong>. Il est
possible de placer des trains entre les sillons déjà établis,
quand ces derniers sont suffisamment espacés ou n&amp;rsquo;ont pas
trouvé d&amp;rsquo;acheteurs.&lt;/p>
&lt;p>La capacité restante après l&amp;rsquo;attribution des sillons est appelée
la &lt;strong>capacité résiduelle&lt;/strong>. Le problème traité ici est la recherche
de sillons dans celle-ci.&lt;/p></description></item><item><title>Docs: Modélisation physique</title><link>https://osrd.fr/fr/docs/explanation/running_time_calculation/physical_modeling/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/explanation/running_time_calculation/physical_modeling/</guid><description>
&lt;!-- script to auto-render KaTeX extension : $$...$$ for outline formula, \\(...\\) for inline formula -->
&lt;link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">
&lt;script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous">&lt;/script>
&lt;script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
onload="renderMathInElement(document.body);">&lt;/script>
&lt;script src="https://polyfill.io/v3/polyfill.min.js?features=es6">&lt;/script>
&lt;script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">&lt;/script>
&lt;p>La modélisation physique joue un rôle important dans le cœur de calcul d&amp;rsquo;OSRD. C&amp;rsquo;est elle qui nous permet de simuler la circulation des trains, et elle doit être aussi réaliste que possible.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="bilan-des-forces">Bilan des forces&lt;/h3>
&lt;/font>
&lt;p>Pour calculer le déplacement du train au cours du temps, il faut d&amp;rsquo;abord calculer sa vitesse à chaque instant.
Une manière simple d&amp;rsquo;obtenir cette vitesse est de passer par le calcul de l&amp;rsquo;accélération.
Grâce au principe fondamental de la dynamique, l&amp;rsquo;accélération du train à chaque instant est directement dépendant
des différentes forces qui lui sont appliquées : $$ \sum \vec{F}=m\vec{a} $$&lt;/p>
&lt;p>&lt;img src="../forces.png" alt="Marche">&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Traction&lt;/strong> : La valeur de la force de traction \(F_{mot}\) dépend de plusieurs facteurs :&lt;/p>
&lt;ul>
&lt;li>du matériel roulant&lt;/li>
&lt;li>de la vitesse du train \(v^{\prime}x\), selon la courbe effort-vitesse ci-dessous :&lt;/li>
&lt;/ul>
&lt;p>$$ {\vec{F_{mot}}(v_{x^{\prime}}, x^{\prime})=F_{mot}(v_{x^{\prime}}, x^{\prime})\vec{e_x^{\prime}}} $$&lt;/p>
&lt;p>&lt;img src="../effort-vitesse.png" alt="Marche" title="Exemple de courbe effort-vitesse d'un train">&lt;/p>
&lt;blockquote>
&lt;p>L&amp;rsquo;axe &lt;strong>x&lt;/strong> représente la vitesse du train en [km/h], l&amp;rsquo;axe &lt;strong>y&lt;/strong>, la valeur de la force de traction en [kN].&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>de l&amp;rsquo;action du conducteur, qui accélère plus ou moins fort en fonction de l&amp;rsquo;endroit où il se trouve sur son trajet&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;br>
&lt;ul>
&lt;li>&lt;strong>Freinage&lt;/strong> : La valeur de la force de freinage \(F_{brk}\) dépend elle aussi du matériel roulant et de l&amp;rsquo;action du conducteur mais possède une valeur constante pour un matériel donné. Dans l&amp;rsquo;état actuel de la modélisation, le freinage est soit nul, soit à sa valeur maximale.&lt;/li>
&lt;/ul>
&lt;p>$$ \vec{F_{brk}}(x^{\prime})=-F_{brk}(x^{\prime}){\vec{e_{x^{\prime}}}} $$&lt;/p>
&lt;p>Une seconde approche de la modélisation du freinage est l&amp;rsquo;approche dite horaire, car utilisée pour la production horaire à la SNCF. Dans ce cas, la décélération est fixe et le freinage ne dépend plus des différentes forces appliquées au train. Les valeurs de décélération typiques vont de 0.4 à 0.7m/s².&lt;/p>
&lt;br>
&lt;ul>
&lt;li>&lt;strong>Résistance à l&amp;rsquo;avancement&lt;/strong> : Pour modéliser la résistance à l’avancement du train on utilise la formule de Davis qui prend en compte tous les frottements et la résistance aérodynamique de l’air. La valeur de la résistance à l&amp;rsquo;avancement dépend de la vitesse \(v^{\prime}_x\). Les coefficients \(A\), \(B\), et \(C\) dépendent du matériel roulant.&lt;/li>
&lt;/ul>
&lt;p>$$ {\vec{R}(v_{x^{\prime}})}=-(A+Bv_{x^{\prime}}+{Cv_{x^{\prime}}}^2){\vec{e_{x^{\prime}}}} $$&lt;/p>
&lt;br>
&lt;ul>
&lt;li>&lt;strong>Poids (pentes + virages)&lt;/strong> : La force du poids donnée par le produit entre la masse \(m\) du train et la constante gravitationnelle \(g\) est projetée sur les axes \(\vec{e_x}^{\prime}\) et \(\vec{e_y}^{\prime}\).Pour la projection, on utilise l&amp;rsquo;angle \(i(x^{\prime})\), qui est calculé à partir de l&amp;rsquo;angle de déclivité \(s(x^{\prime})\) corrigé par un facteur qui prend en compte l&amp;rsquo;effet du rayon de virage \(r(x^{\prime})\).&lt;/li>
&lt;/ul>
&lt;p>$$
\vec{P(x^{\prime})}=-mg\vec{e_y}(x^{\prime})=
-mg\Big[sin\big(i(x^{\prime})\big){\vec{e_{x^{\prime}}}(x^{\prime})}+cos\big(i(x^{\prime})\big){\vec{e_{{\prime}}}(x^{\prime})}\Big]
$$&lt;/p>
&lt;p>$$ i(x^{\prime})= s(x^{\prime})+\frac{800m}{r(x^{\prime})} $$&lt;/p>
&lt;br>
&lt;ul>
&lt;li>&lt;strong>Réaction du sol&lt;/strong> : La force de réaction du sol compense simplement la composante verticale du poids, mais n&amp;rsquo;a pas d&amp;rsquo;impact sur la dynamique du train car elle n&amp;rsquo;a aucune composante selon l&amp;rsquo;axe \({\vec{e_x}^{\prime}}\).&lt;/li>
&lt;/ul>
&lt;p>$$ \vec{R_{gnd}}=R_{gnd}{\vec{e_{y^{\prime}}}} $$&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="equilibre-des-forces">Equilibre des forces&lt;/h3>
&lt;/font>
&lt;p>L&amp;rsquo;équation du principe fondamental de la dynamique projetée sur l&amp;rsquo;axe \({\vec{e_x}^{\prime}}\) (dans le référentiel du train) donne l&amp;rsquo;équation scalaire suivante :&lt;/p>
&lt;p>$$
a_{x^{\prime}}(t) = \frac{1}{m}\Big
[F_{mot}(v_{x^{\prime}}, x^{\prime})-F_{brk}(x^{\prime})-(A+Bv_{x^{\prime}}+{Cv_{x^{\prime}}}^2)-mgsin(i(x^{\prime}))\Big]
$$&lt;/p>
&lt;p>Celle-ci est ensuite simplifiée en considérant que malgré la pente le train se déplace sur un plan et en amalgamant
\(\vec{e_x}\) et \(\vec{e_x}^{\prime}\). La pente a toujours un impact sur le bilan des forces mais on considère que le train ne se déplace qu&amp;rsquo;horizontalement, ce qui donne l&amp;rsquo;équation simplifiée suivante :&lt;/p>
&lt;p>$$ a_{x}(t) = \frac{1}{m}\Big[F_{mot}(v_{x}, x)-F_{brk}(x)-(A+Bv_{x}+{Cv_{x}}^2)-mgsin(i(x))\Big] $$&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="résolution">Résolution&lt;/h3>
&lt;/font>
&lt;p>La force motrice et la force de freinage dépendent de l&amp;rsquo;action du conducteur (il décide d&amp;rsquo;accélérer ou de freiner plus ou moins fort en fonction de la situation). Cette dépendance se traduit donc par une dépendance de ces deux forces à la position du train. La composante du poids dépend elle aussi de la position du train, car provenant directement des pentes et des virages situées sous ce dernier.&lt;/p>
&lt;p>De plus, la force motrice dépend de la vitesse du train (selon la courbe effort vitesse) tout comme la résistance à
l&amp;rsquo;avancement.&lt;/p>
&lt;p>Ces différentes dépendances rendent impossible la résolution analytique de cette équation, et l&amp;rsquo;accélération du train à chaque instant doit être calculée par intégration numérique.&lt;/p></description></item><item><title>Docs: Parcours de l'infrastructure</title><link>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/infrastructure_exploration/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/infrastructure_exploration/</guid><description>
&lt;p>La première chose à définir est &lt;em>comment un train se déplace sur l&amp;rsquo;infrastructure&lt;/em>,
sans prendre en compte les conflits pour l&amp;rsquo;instant.&lt;/p>
&lt;p>On a besoin d&amp;rsquo;une manière de définir et d&amp;rsquo;énumérer les différents chemins
possibles et de parcourir l&amp;rsquo;infrastructure, avec plusieurs contraintes :&lt;/p>
&lt;ol>
&lt;li>Le chemin doit être compatible avec le matériel roulant donné
(électrification, gabarit, systèmes de signalisation)&lt;/li>
&lt;li>À n&amp;rsquo;importe quel point, on doit être en mesure d&amp;rsquo;accéder aux propriétés
du chemin depuis le point de départ jusqu&amp;rsquo;au point considéré.
Cela inclus les routes et les cantons.&lt;/li>
&lt;li>Dans certains cas, on doit savoir où le train ira &lt;em>après&lt;/em>
le point actuellement évalué (pour une détection de conflits correcte).&lt;/li>
&lt;/ol>
&lt;p>Pour répondre à ce besoin, une classe &lt;code>InfraExplorer&lt;/code> a été implémentée.
Elle utilise les cantons (section de signal en signal) comme subdivision
principale.
Elle est composée de 3 sections : le canton courant, les prédécesseurs,
et les cantons suivants.&lt;/p>
&lt;p>&lt;img src="infra_explorer.svg" alt="InfraExplorer structure">&lt;/p>
&lt;p>Dans cet exemple, les flèches vertes sont les cantons précédents.
Ce qui se produit dessus est considéré comme immuable.&lt;/p>
&lt;p>La flèche rouge est le canton actuellement exploré.
C&amp;rsquo;est à cet endroit que les simulations du train et de la
signalisation sont effectuées, et que les conflits
sont évités.&lt;/p>
&lt;p>Les flèches bleues sont les cantons suivants. Cette section
n&amp;rsquo;est pas encore simulée, elle existe seulement pour savoir
où le train ira ensuite. Dans cet exemple, elle indique
que le signal en bas à droite peut être ignoré, seul
le chemin du haut sera utilisé.
Le chemin du bas sera évalué dans une autre instance de
&lt;code>InfraExplorer&lt;/code>.&lt;/p>
&lt;p>Plus de détails sur la classe et son interface sont
présents sur la version anglaise de la page.&lt;/p></description></item><item><title>Docs: Configuration de l'environnement de recherche STDCM</title><link>https://osrd.fr/fr/docs/guides/deploy/stdcm-search-env/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/deploy/stdcm-search-env/</guid><description>
&lt;p>Pour que l&amp;rsquo;outil STDCM fonctionne, il faut configurer l&amp;rsquo;environnement de recherche STDCM, une configuration stockée en base de données.&lt;/p>
&lt;p>Les champs configurables sont les suivants :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-rust" data-lang="rust">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">pub&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000">StdcmSearchEnvironment&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">pub&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">infra_id&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">i64&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">pub&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">electrical_profile_set_id&lt;/span>: &lt;span style="color:#204a87">Option&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">i64&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">pub&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">work_schedule_group_id&lt;/span>: &lt;span style="color:#204a87">Option&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">i64&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">pub&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">timetable_id&lt;/span>: &lt;span style="color:#204a87;font-weight:bold">i64&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">pub&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">search_window_begin&lt;/span>: &lt;span style="color:#000">NaiveDateTime&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">pub&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">search_window_end&lt;/span>: &lt;span style="color:#000">NaiveDateTime&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Cette configuration est récupérée par le frontend afin que les bons objets et bornes temporelles soient utilisés
de manière transparente par l&amp;rsquo;utilisateur.&lt;/p>
&lt;p>Pour configurer cette environnement, vous pouvez soit :&lt;/p>
&lt;ul>
&lt;li>Utiliser l&amp;rsquo;API REST prévue à cet effet (voir &lt;a href="https://osrd.fr/fr/docs/reference/apis/editoast/#operations-tag-stdcm_search_environment">l&amp;rsquo;openAPI d&amp;rsquo;editoast&lt;/a>
dans la section stdcm_search_environment)&lt;/li>
&lt;li>Utiliser le CLI editoast (exécutez &lt;code>editoast stdcm-search-env help&lt;/code> pour plus d&amp;rsquo;informations)&lt;/li>
&lt;/ul></description></item><item><title>Docs: Éléments mobiles</title><link>https://osrd.fr/fr/docs/reference/design-docs/interlocking/movable-elements/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/interlocking/movable-elements/</guid><description>
&lt;h2 id="description">Description&lt;/h2>
&lt;p>Chaque élément mobile, aiguille ou passage à niveau, a une liste d&amp;rsquo;états possibles.
Ces états sont mutuellement exclusifs.&lt;/p>
&lt;h2 id="dépendances">Dépendances&lt;/h2>
&lt;ul>
&lt;li>&lt;code>statique&lt;/code> une liste d&amp;rsquo;éléments mobiles&lt;/li>
&lt;li>&lt;code>statique&lt;/code> liste des états possibles de chaque élément mobile&lt;/li>
&lt;/ul>
&lt;h2 id="opérations-possibles">Opérations possibles&lt;/h2>
&lt;ul>
&lt;li>observer un élément mobile&lt;/li>
&lt;li>verrouiller / déverrouiller un élément mobile&lt;/li>
&lt;li>bouger un élément mobile&lt;/li>
&lt;/ul></description></item><item><title>Docs: Le design d'OSRD</title><link>https://osrd.fr/fr/docs/guides/design/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/design/</guid><description>
&lt;p>Tout est présenté dans un site dédié &lt;a href="https://design.osrd.fr">https://design.osrd.fr&lt;/a>&lt;/p>
&lt;p>Un « design system » est en cours d&amp;rsquo;élaboration.&lt;/p>
&lt;figure>&lt;a href="https://design.osrd.fr">
&lt;img src="https://osrd.fr/fr/docs/guides/design/images/design.webp"/> &lt;/a>
&lt;/figure></description></item><item><title>Docs: Le logo</title><link>https://osrd.fr/fr/docs/guides/logo/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/logo/</guid><description>
&lt;p>Vous pouvez télécharger chaque logo indépendamment en cliquant directement dessus, ou &lt;a href="pictures/logo-osrd.zip">tous les logos compressés dans un fichier zip&lt;/a>.&lt;/p>
&lt;p>Il est conseillé de bien choisir le logo à utiliser en fonction du fond sur lequel vous voulez l&amp;rsquo;afficher.&lt;/p>
&lt;p>La modification, ajout ou suppression de l&amp;rsquo;&lt;strong>ombrage&lt;/strong> autre que tel que présenté dans les logos &lt;strong>ne sont pas autorisés&lt;/strong> (cela est valable plus globalement dans tout le design, le choix de mettre des ombres portées fait partie des réflexions de design, ce n&amp;rsquo;est pas un élément variable).&lt;/p>
&lt;h3 id="officiel">Officiel&lt;/h3>
&lt;div style="display:inline-block;padding:16px;background-color:white">
&lt;a target="_blank" href="pictures/logo-osrd-color-black.svg">
&lt;img src="pictures/logo-osrd-color-black.svg" width=256>
&lt;/a>
&lt;/div>
&lt;h3 id="officiel-pour-les-fonds-sombres">Officiel pour les fonds sombres&lt;/h3>
&lt;div style="display:inline-block;padding:16px;background-color:#333">
&lt;a target="_blank" href="pictures/logo-osrd-color-white.svg">
&lt;img src="pictures/logo-osrd-color-white.svg" width=256>
&lt;/a>
&lt;/div>
&lt;h3 id="blanc">Blanc&lt;/h3>
&lt;div style="display:inline-block;padding:16px;background-color:#333">
&lt;a target="_blank" href="pictures/logo-osrd-white.svg">
&lt;img src="pictures/logo-osrd-white.svg" width=256>
&lt;/a>
&lt;/div>
&lt;h3 id="noir">Noir&lt;/h3>
&lt;div style="display:inline-block;padding:16px;background-color:white">
&lt;a target="_blank" href="pictures/logo-osrd-black.svg">
&lt;img src="pictures/logo-osrd-black.svg" width=256>
&lt;/a>
&lt;/div>
&lt;h3 id="favicons-logos-seuls">Favicons, logos seuls&lt;/h3>
&lt;div style="display:inline-block;padding:16px;background-color:white">
&lt;a target="_blank" href="pictures/fav-osrd-color.svg">
&lt;img src="pictures/fav-osrd-color.svg" width=64>
&lt;/a>
&lt;/div>
&lt;div style="display:inline-block;padding:16px;background-color:white;margin-left:16px">
&lt;a target="_blank" href="pictures/fav-osrd-black.svg">
&lt;img src="pictures/fav-osrd-black.svg" width=64>
&lt;/a>
&lt;/div>
&lt;div style="display:inline-block;padding:16px;background-color:#333;margin-left:16px">
&lt;a target="_blank" href="pictures/fav-osrd-white.svg">
&lt;img src="pictures/fav-osrd-white.svg" width=64>
&lt;/a>
&lt;/div>
&lt;h2 id="-ce-quon-ne-doit-pas-faire">🚫 Ce qu&amp;rsquo;on ne doit &lt;strong>pas&lt;/strong> faire&lt;/h2>
&lt;h4 id="trop-petit--16px-de-hauteur">Trop petit (&amp;lt; 16px de hauteur)&lt;/h4>
&lt;img src="pictures/dont/dont5.svg" style="height:32px">
&lt;h4 id="disproportion">Disproportion&lt;/h4>
&lt;img src="pictures/dont/dont1.svg" style="margin-left:16px;height:64px">
&lt;h4 id="changer-la-couleur-du-texte-ou-lombre-portée">Changer la couleur du texte ou l&amp;rsquo;ombre portée&lt;/h4>
&lt;img src="pictures/dont/dont2.svg" style="height:64px">
&lt;h4 id="changer-le-sens">Changer le sens&lt;/h4>
&lt;img src="pictures/dont/dont3.svg" style="margin-left:16px;height:64px">
&lt;h4 id="déformation">Déformation&lt;/h4>
&lt;img src="pictures/dont/dont4.svg" style="height:64px">
&lt;h2 id="-ce-quon-peut-faire">✅ Ce qu&amp;rsquo;on peut faire&lt;/h2>
&lt;h4 id="modification-de-la-couleur-interne-pour-un-évènement">Modification de la couleur interne pour un évènement&lt;/h4>
&lt;div>
&lt;a style="display:inline-block;padding:8px;background-color:white;" href="pictures/events/xmas-fav-osrd-color.svg" target="_blank">
&lt;img src="pictures/events/xmas-fav-osrd-color.svg" style="height:32px">
&lt;/a>
&lt;a style="display:inline-block;margin-left:8px;padding:8px;background-color:white;" href="pictures/events/xmas-logo-osrd-color-black.svg" target="_blank">
&lt;img src="pictures/events/xmas-logo-osrd-color-black.svg" style="height:32px">
&lt;/a>
&lt;a style="display:inline-block;margin-left:8px;padding:8px;background-color:#333" href="pictures/events/xmas-logo-osrd-color-white.svg">
&lt;img src="pictures/events/xmas-logo-osrd-color-white.svg" style="height:32px">
&lt;/a>
&lt;/div>
&lt;div style="margin-top:8px">
&lt;a style="display:inline-block;padding:8px;background-color:white;" href="pictures/events/proud-fav-osrd-color.svg" target="_blank">
&lt;img src="pictures/events/proud-fav-osrd-color.svg" style="height:32px">
&lt;/a>
&lt;a style="display:inline-block;margin-left:8px;padding:8px;background-color:white;" href="pictures/events/proud-logo-osrd-color-black.svg" target="_blank">
&lt;img src="pictures/events/proud-logo-osrd-color-black.svg" style="height:32px">
&lt;/a>
&lt;a style="display:inline-block;margin-left:8px;padding:8px;background-color:#333" href="pictures/events/proud-logo-osrd-color-white.svg">
&lt;img src="pictures/events/proud-logo-osrd-color-white.svg" style="height:32px">
&lt;/a>
&lt;/div>
&lt;h4 id="utilisation-seule-du-logo-sans-le-texte">Utilisation seule du logo (sans le texte)&lt;/h4>
&lt;div style="display:inline-block">
&lt;img src="pictures/fav-osrd-color.svg" style="height:64px">
&lt;/div>
&lt;h2 id="les-couleurs">Les couleurs&lt;/h2>
&lt;blockquote>
&lt;p>Ces couleurs sont &lt;strong>celles du logo&lt;/strong>, elles ne sont pas à confondre avec celles du design global de l&amp;rsquo;interface d&amp;rsquo;OSRD.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;span style="display:inline-block;background-color:#786abf;width:128px;height:128px;color:white;font-weight:bold;padding:16px;margin-top:16px">#786ABF&lt;/span>
&lt;span style="display:inline-block;background-color:#c7b2de;width:128px;height:128px;color:white;font-weight:bold;padding:16px;margin-top:16px;margin-left:16px">#C7B2DE&lt;/span>&lt;/p></description></item><item><title>Docs: Installer docker</title><link>https://osrd.fr/fr/docs/guides/contribute/install-docker/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/guides/contribute/install-docker/</guid><description>
&lt;p>Peu importe votre système d&amp;rsquo;exploitation, docker requiert linux pour fonctionner.
Lorsqu&amp;rsquo;utilisé sous un autre système d&amp;rsquo;exploitation, docker a besoin de machines
virtuelles linux pour build et exécuter des images.&lt;/p>
&lt;p>Il y a deux types d&amp;rsquo;installation docker :&lt;/p>
&lt;ul>
&lt;li>docker engine est l&amp;rsquo;application en ligne de commande&lt;/li>
&lt;li>docker desktop est une application graphique, qui gère aussi la virtualisation&lt;/li>
&lt;/ul>
&lt;p>Voici nos suggestions :&lt;/p>
&lt;ul>
&lt;li>Si vous êtes sous linux, installez docker engine &lt;a href="https://docs.docker.com/engine/install/#supported-platforms">via votre gestionnaire de packet&lt;/a>&lt;/li>
&lt;li>Si vous êtes sous MacOS / Windows, installez &lt;a href="https://www.docker.com/products/docker-desktop/">docker desktop&lt;/a> si vous y êtes autorisés&lt;/li>
&lt;li>Si vous êtes sous windows, et voulez faire fonctionner docker sous WSL, ou ne pouvez pas utiliser docker desktop, suivez le &lt;a href="#docker-sous-wsl">guide docker sous WSL&lt;/a>&lt;/li>
&lt;li>Si vous êtes sous MacOS, et vous ne pouvez pas utiliser docker desktop, suivez le &lt;a href="#macos-colima">guide colima pour MacOS&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="docker-sous-wsl">Docker sous WSL&lt;/h2>
&lt;p>Cette option d&amp;rsquo;installation est très utile, car elle permet de disposer d&amp;rsquo;une installation tout à fait normale de docker engine Linux à l&amp;rsquo;intérieur de WSL, qui reste accessible depuis Windows.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://learn.microsoft.com/fr-fr/windows/wsl/install">Installez WSL&lt;/a> (Si vous avez une vieille version de WSL, lancez &lt;code>wsl --upgrade&lt;/code>)&lt;/li>
&lt;li>Obtenez une image WSL depuis le store microsoft (par exemple, debian or ubuntu)&lt;/li>
&lt;li>&lt;a href="https://learn.microsoft.com/fr-fr/windows/wsl/systemd">Activez le support systemd depuis la VM WSL&lt;/a>&lt;/li>
&lt;li>Suivez le &lt;a href="https://docs.docker.com/engine/install/#supported-platforms">tutoriel d&amp;rsquo;installation docker engine pour votre distribution WSL&lt;/a>&lt;/li>
&lt;li>Si vous avez docker desktop installé, vous pouvez &lt;a href="https://learn.microsoft.com/en-us/windows/wsl/tutorials/wsl-containers">le configurer pour qu&amp;rsquo;il utilise WSL&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="macos-colima">MacOS colima&lt;/h2>
&lt;p>Cette procédure permet d&amp;rsquo;installer docker sans passer par docker desktop. Elle utilise colima comme solution de virtualisation.&lt;/p>
&lt;ol>
&lt;li>&lt;a href="https://brew.sh/">Installez homebrew&lt;/a>&lt;/li>
&lt;li>&lt;code>brew install docker docker-compose colima&lt;/code>&lt;/li>
&lt;li>Installez le plugin compose : &lt;code>mkdir -p ~/.docker/cli-plugins &amp;amp;&amp;amp; ln -sfn $(brew --prefix)/opt/docker-compose/bin/docker-compose ~/.docker/cli-plugins/docker-compose&lt;/code>&lt;/li>
&lt;li>&lt;a href="https://github.com/abiosoft/colima?tab=readme-ov-file#customizing-the-vm">Configurez colima&lt;/a> :&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>pour des macbooks apple silicon (M1/M2) : &lt;code>colima start --cpu 2 --memory 6 --arch aarch64 --vm-type=vz --vz-rosetta --mount-type=virtiofs&lt;/code>&lt;/li>
&lt;li>pour de petites infrastructures: &lt;code>colima start --cpu 2 --memory 4&lt;/code>&lt;/li>
&lt;li>pour de grosses infrastructures: &lt;code>colima start --cpu 2 --memory 6&lt;/code>&lt;/li>
&lt;/ul>
&lt;ol start="5">
&lt;li>&lt;code>brew services start colima&lt;/code> pour lancer automatiquement colima au démarrage&lt;/li>
&lt;li>Quittez votre terminal, ouvrez-en un nouveau&lt;/li>
&lt;li>Vous pouvez maintenant utiliser docker CLI&lt;/li>
&lt;/ol>
&lt;div class="alert alert-info" role="alert">
&lt;p>Si vous utiliser rancher desktop, veuillez soit:&lt;/p>
&lt;ul>
&lt;li>désinstaller l&amp;rsquo;application&lt;/li>
&lt;li>sélectionner &lt;code>Manuel&lt;/code> dans &lt;code>Préférences&lt;/code> &amp;gt; &lt;code>Application&lt;/code> &amp;gt; &lt;code>Environnement&lt;/code>&lt;/li>
&lt;/ul>
&lt;/div>
&lt;div class="alert alert-info" role="alert">
En cas d&amp;rsquo;erreur au démarrage avec Rosetta 2, lancez &lt;code>colima delete&lt;/code> et réessayez (le format de disque n&amp;rsquo;est pas compatible). Les paramètres seront perdus.
&lt;/div>
&lt;div class="alert alert-info" role="alert">
&lt;p>Si vous avez cette erreur: &lt;code>error getting credentials - err: exec: &amp;quot;docker-credential-osxkeychain&amp;quot;: executable file not found in $PATH&lt;/code>&lt;/p>
&lt;p>Ouvrez &lt;code>~/.docker/config.json&lt;/code>, et enlevez &lt;code>&amp;quot;credsStore&amp;quot;: &amp;quot;osxkeychain&amp;quot;&lt;/code>&lt;/p>
&lt;/div></description></item><item><title>Docs: Détection de conflits</title><link>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/conflict_detection/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/conflict_detection/</guid><description>
&lt;p>Maintenant qu&amp;rsquo;on sait quels chemins peuvent être utilisés,
on doit déterminer à quel moment ces chemins sont libres.&lt;/p>
&lt;p>La documentation (en anglais seulement)
de la détection de conflits explique comment elle est réalisée
en interne. Pour résumer, un train est en conflit avec un autre
quand il observe un signal lui indiquant de ralentir.
Dans notre cas, une solution où cette situation se produit
est considérée comme invalide, le train doit arriver
au signal donné plus tard (ou plus tôt) quand le signal
n&amp;rsquo;est plus contraignant.&lt;/p>
&lt;p>Cependant, la détection de conflit doit être réalisée de
manière &lt;em>incrémentale&lt;/em>, ce qui veut dire que :&lt;/p>
&lt;ol>
&lt;li>Quand une simulation est effectuée jusqu&amp;rsquo;à t=x, tous les conflits
qui arrivent avant t=x doivent être connus, &lt;em>même s&amp;rsquo;ils sont
indirectement provoqués par un signal vu à t &amp;gt; x&lt;/em> plus loin sur le chemin.&lt;/li>
&lt;li>Les conflits et utilisations de ressources doivent être identifiés
dès qu&amp;rsquo;ils se produisent, même si le temps de fin d&amp;rsquo;utilisation n&amp;rsquo;est
pas encore défini.&lt;/li>
&lt;/ol>
&lt;p>Pour que ce soit possible, on doit être en mesure de savoir où
le train ira &lt;em>après&lt;/em> la section actuellement simulée (cf
&lt;a href="https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/infrastructure_exploration/" title="exploration de l'infrastructure">exploration de l&amp;rsquo;infrastructure&lt;/a>
)&lt;/p>
&lt;p>Pour gérer ce cas, le module de détection de conflit
peut renvoyer une erreur quand il est nécessaire d&amp;rsquo;avoir
plus d&amp;rsquo;information sur la suite du chemin. Quand ce cas
se produit, les objets &lt;code>InfraExplorer&lt;/code> sont clonés
pour étendre les chemins.&lt;/p></description></item><item><title>Docs: Intégration numérique</title><link>https://osrd.fr/fr/docs/explanation/running_time_calculation/numerical_integration/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/explanation/running_time_calculation/numerical_integration/</guid><description>
&lt;!-- script to auto-render KaTeX extension : $$...$$ for outline formula, \\(...\\) for inline formula -->
&lt;link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous">
&lt;script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous">&lt;/script>
&lt;script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
onload="renderMathInElement(document.body);">&lt;/script>
&lt;script src="https://polyfill.io/v3/polyfill.min.js?features=es6">&lt;/script>
&lt;script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">&lt;/script>
&lt;font color=#aa026d>
&lt;h3 id="introduction">Introduction&lt;/h3>
&lt;/font>
&lt;p>La modélisation physique ayant montré que l&amp;rsquo;accélération du train était influencée par différents facteurs variant le long du trajet (pente, courbure, force de traction du moteur&amp;hellip;), le calcul doit passer par une méthode d&amp;rsquo;intégration numérique. Le trajet est alors séparé en étapes suffisamment courtes pour considérer tous ces facteurs comme constants, ce qui permet cette fois ci d&amp;rsquo;utiliser l&amp;rsquo;équation du mouvement pour calculer le déplacement et la vitesse du train.&lt;/p>
&lt;p>La méthode d&amp;rsquo;intégration numérique d&amp;rsquo;Euler est la plus simple pour effectuer ce genre de calcul, mais elle présente un certain nombre d&amp;rsquo;inconvénients. Cet article explique la méthode d&amp;rsquo;Euler, pourquoi elle ne convient pas aux besoins d&amp;rsquo;OSRD et quelle méthode d&amp;rsquo;intégration doit être utilisée à la place.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="la-méthode-deuler">La méthode d&amp;rsquo;Euler&lt;/h3>
&lt;/font>
&lt;p>La méthode d&amp;rsquo;Euler appliquée à l&amp;rsquo;intégration de l&amp;rsquo;équation du mouvement d&amp;rsquo;un train est :&lt;/p>
&lt;p>$$v(t+dt) = a(v(t), x(t))dt + v(t)$$&lt;/p>
&lt;p>$$x(t+dt) = \frac{1}{2}a(v(t), x(t))dt^2 + v(t)dt + x(t)$$&lt;/p>
&lt;center>
&lt;p>&lt;img src="../euler.png?style=method" alt="Méthode d&amp;rsquo;Euler">&lt;/p>
&lt;/center>
&lt;p>&amp;nbsp;&lt;/p>
&lt;h4 id="les-avantages-de-la-méthode-deuler">&lt;strong>Les avantages de la méthode d&amp;rsquo;Euler&lt;/strong>&lt;/h4>
&lt;p>La méthode d&amp;rsquo;Euler a pour avantages d&amp;rsquo;être très simple à implémenter et d&amp;rsquo;avoir un calcul plutôt rapide pour un pas de temps donné, en comparaison avec d&amp;rsquo;autres méthodes d&amp;rsquo;intégration numérique (voir &lt;a href="#le-choix-de-la-m%C3%A9thode-dint%C3%A9gration-pour-osrd">annexe&lt;/a>)&lt;/p>
&lt;h4 id="les-inconvénients-de-la-méthode-deuler">&lt;strong>Les inconvénients de la méthode d&amp;rsquo;Euler&lt;/strong>&lt;/h4>
&lt;p>La méthode d&amp;rsquo;intégration d&amp;rsquo;Euler présente un certain nombre de problèmes pour OSRD :&lt;/p>
&lt;ul>
&lt;li>Elle est relativement imprécise, et donc nécessite un faible pas de temps, ce qui génère beaucoup de données.&lt;/li>
&lt;li>En intégrant dans le temps, on ne connaît que les conditions du point de départ du pas d&amp;rsquo;intégration (pente, paramètres d&amp;rsquo;infrastructure, etc.) car on ne peut pas prédire précisément l&amp;rsquo;endroit où il se termine.&lt;/li>
&lt;li>On ne peut pas anticiper les futurs changements de directive : le train ne réagit qu&amp;rsquo;en comparant son état actuel à sa consigne au même instant. Pour illustrer c&amp;rsquo;est un peu comme si le conducteur était incapable de voir devant lui, alors que dans la réalité il anticipe en fonction des signaux, pentes, virages qu&amp;rsquo;il voit devant lui.&lt;/li>
&lt;/ul>
&lt;font color=#aa026d>
&lt;h3 id="la-méthode-runge-kutta-4">La méthode Runge-Kutta 4&lt;/h3>
&lt;/font>
&lt;p>La méthode Runge-Kutta 4 appliquée à l&amp;rsquo;intégration de l&amp;rsquo;équation du mouvement d&amp;rsquo;un train est :&lt;/p>
&lt;p>$$v(t+dt) = v(t) + \frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)dt$$&lt;/p>
&lt;p>Avec :&lt;/p>
&lt;p>$$k_1 = a(v(t), x(t))$$&lt;/p>
&lt;p>$$k_2 = a\Big(v(t+k_1\frac{dt}{2}), x(t) + v(t)\frac{dt}{2} + k_1\frac{dt^2}{8}\Big)$$&lt;/p>
&lt;p>$$k_3 = a\Big(v(t+k_2\frac{dt}{2}), x(t) + v(t)\frac{dt}{2} + k_2\frac{dt^2}{8}\Big)$$&lt;/p>
&lt;p>$$k_4 = a\Big(v(t+k_3dt), x(t) + v(t)dt + k_3\frac{dt^2}{2}\Big)$$&lt;/p>
&lt;center>
&lt;p>&lt;img src="../rk4.png?style=method" alt="Méthode de Runge-Kutta 4">&lt;/p>
&lt;/center>
&lt;p>&amp;nbsp;&lt;/p>
&lt;h4 id="les-avantages-de-la-méthode-de-runge-kutta-4">&lt;strong>Les avantages de la méthode de Runge Kutta 4&lt;/strong>&lt;/h4>
&lt;p>La méthode d&amp;rsquo;intégration de Runge Kutta 4 permet de répondre aux différents problèmes soulevés par celle d&amp;rsquo;Euler :&lt;/p>
&lt;ul>
&lt;li>Elle permet d&amp;rsquo;anticiper les changements de directive au sein d&amp;rsquo;un pas de calcul, représentant ainsi davantage la réalité de conduite d&amp;rsquo;un train.&lt;/li>
&lt;li>Elle est plus précise pour le même temps de calcul (voir &lt;a href="#le-choix-de-la-m%C3%A9thode-dint%C3%A9gration-pour-osrd">annexe&lt;/a>), permettant des étapes d&amp;rsquo;intégration plus grandes, donc moins de points de données.&lt;/li>
&lt;/ul>
&lt;h4 id="les-inconvénients-de-la-méthode-de-runge-kutta-4">&lt;strong>Les inconvénients de la méthode de Runge Kutta 4&lt;/strong>&lt;/h4>
&lt;p>Le seul inconvénient notable de la méthode de Runge Kutta 4 rencontré pour l&amp;rsquo;instant est sa difficulté d&amp;rsquo;implémentation.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="le-choix-de-la-méthode-dintégration-pour-osrd">Le choix de la méthode d&amp;rsquo;intégration pour OSRD&lt;/h3>
&lt;/font>
&lt;h4 id="étude-de-la-précision-et-de-la-vitesse-de-calcul">&lt;strong>Étude de la précision et de la vitesse de calcul&lt;/strong>&lt;/h4>
&lt;p>Différentes méthodes d&amp;rsquo;intégration auraient pu remplacer l&amp;rsquo;intégration d&amp;rsquo;Euler de base dans l&amp;rsquo;algorithme d&amp;rsquo;OSRD. Afin de décider quelle méthode conviendrait le mieux, une étude sur la précision et la vitesse de calcul de différentes méthodes a été menée. Cette étude sert à comparé les méthodes suivantes :&lt;/p>
&lt;ul>
&lt;li>Euler&lt;/li>
&lt;li>Euler-Cauchy&lt;/li>
&lt;li>Runge-Kutta 4&lt;/li>
&lt;li>Adams 2&lt;/li>
&lt;li>Adams 3&lt;/li>
&lt;/ul>
&lt;p>Toutes les explications sur ces méthodes peuvent être trouvées dans &lt;a href="https://github.com/OpenRailAssociation/osrd/wiki/documents/integration/MethodesNumeriques_EricGoncalves.pdf">ce document&lt;/a>, et le code python utilisé pour la simulation est &lt;a href="https://raw.githubusercontent.com/wiki/OpenRailAssociation/osrd/code/integration/Tests_precision.py">ici&lt;/a>.&lt;/p>
&lt;p>La simulation calcule la position et la vitesse d&amp;rsquo;un TGV accélérant sur une ligne droite plate.&lt;/p>
&lt;h4 id="simulations-à-pas-de-temps-équivalent">&lt;strong>Simulations à pas de temps équivalent&lt;/strong>&lt;/h4>
&lt;p>Une courbe de référence a été simulée en utilisant la méthode d&amp;rsquo;Euler avec un pas de temps de 0,1s, puis le même parcours a été simulé en utilisant les autres méthodes avec un pas de temps de 1s. Il est alors possible de comparer simplement chaque courbe à la courbe de référence, en calculant la valeur absolue de la différence à chaque point calculé. Voici l&amp;rsquo;erreur absolue résultante de la position du train sur sa distance parcourue :&lt;/p>
&lt;p>&lt;img src="../precisions_h_equivalent.png" alt="precisions_h_equivalent">&lt;/p>
&lt;p>Il apparaît immédiatement que la méthode d&amp;rsquo;Euler est moins précise que les quatre autres d&amp;rsquo;environ un ordre de grandeur. Chaque courbe présente un pic où la précision est extrêmement élevée (erreur extrêmement faible), ce qui s&amp;rsquo;explique par le fait que toutes les courbes commencent légèrement au-dessus de la courbe de référence, la croisent en un point et finissent légèrement en dessous, ou &lt;em>vice versa&lt;/em>.&lt;/p>
&lt;p>Comme la précision n’est pas le seul indicateur important, le temps de calcul de chaque méthode a été mesuré. Voici ce que nous obtenons pour les mêmes paramètres d’entrée :&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:left">Méthode d&amp;rsquo;intégration&lt;/th>
&lt;th style="text-align:right">Temps de calcul (s)&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:left">Euler&lt;/td>
&lt;td style="text-align:right">1.86&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Euler-Cauchy&lt;/td>
&lt;td style="text-align:right">3.80&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Runge-Kutta 4&lt;/td>
&lt;td style="text-align:right">7.01&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Adams 2&lt;/td>
&lt;td style="text-align:right">3.43&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Adams 3&lt;/td>
&lt;td style="text-align:right">5.27&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Ainsi, Euler-Cauchy et Adams 2 sont environ deux fois plus lents que Euler, Adams 3 est environ trois fois plus lent, et RK4 est environ quatre fois plus lent. Ces résultats ont été vérifiés sur des simulations beaucoup plus longues, et les différents ratios sont maintenus.&lt;/p>
&lt;h4 id="simulation-à-temps-de-calcul-équivalent">&lt;strong>Simulation à temps de calcul équivalent&lt;/strong>&lt;/h4>
&lt;p>Comme les temps de calcul de toutes les méthodes dépendent linéairement du pas de temps, il est relativement simple de comparer la précision pour un temps de calcul à peu près identique. En multipliant le pas de temps d&amp;rsquo;Euler-Cauchy et d&amp;rsquo;Adams 2 par 2, le pas de temps d&amp;rsquo;Adams 3 par 3, et le pas de temps de RK4 par 4, voici les courbes d&amp;rsquo;erreur absolue résultantes :&lt;/p>
&lt;p>&lt;img src="../precisions_time_equivalent.png" alt="precisions_time_equivalent">&lt;/p>
&lt;p>Et voici les temps de calcul :&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:left">Méthode d&amp;rsquo;intégration&lt;/th>
&lt;th style="text-align:right">Temps de calcul (s)&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:left">Euler&lt;/td>
&lt;td style="text-align:right">1.75&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Euler-Cauchy&lt;/td>
&lt;td style="text-align:right">2.10&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Runge-Kutta 4&lt;/td>
&lt;td style="text-align:right">1.95&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Adams 2&lt;/td>
&lt;td style="text-align:right">1.91&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:left">Adams 3&lt;/td>
&lt;td style="text-align:right">1.99&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Après un certain temps, RK4 tend à être la méthode la plus précise, légèrement plus précise que Euler-Cauchy, et toujours bien plus précise que la méthode d&amp;rsquo;Euler.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="conclusions-de-létude">Conclusions de l&amp;rsquo;étude&lt;/h3>
&lt;/font>
&lt;p>L&amp;rsquo;étude de la précision et de la vitesse de calcul présentée ci-dessus montre que RK4 et Euler-Cauchy seraient de bons candidats pour remplacer l&amp;rsquo;algorithme d&amp;rsquo;Euler dans OSRD : les deux sont rapides, précis, et pourraient remplacer la méthode d&amp;rsquo;Euler sans nécessiter de gros changements d&amp;rsquo;implémentation car ils ne font que des calculs au sein du pas de temps en cours de calcul.
&lt;strong>Il a été décidé qu&amp;rsquo;OSRD utiliserait la méthode Runge-Kutta 4 parce qu&amp;rsquo;elle est légèrement plus précise que Euler-Cauchy et que c&amp;rsquo;est une méthode bien connue pour ce type de calcul, donc très adaptée à un simulateur open-source.&lt;/strong>&lt;/p>
&lt;style>
img[src$="method"] {
height: 50%;
width: 50%;
}
&lt;/style></description></item><item><title>Docs: Représentation de l'espace de solutions</title><link>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/graph_representation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/graph_representation/</guid><description>
&lt;h4 id="principe-général">Principe général&lt;/h4>
&lt;p>Le problème reste une recherche de graphe. En représentant
l&amp;rsquo;espace de solution sous forme de graphe, il est possible de réutiliser
nos outils déjà existants de recherche de chemin.&lt;/p>
&lt;p>Le &lt;em>graphe produit&lt;/em> de la position, du temps, et de la vitesse est utilisé.
Autrement dit, chaque élément du graphe contient (entre autres) ces
3 variables.&lt;/p>
&lt;p>Chaque arête du graphe est calculée avec un
&lt;a href="https://osrd.fr/fr/docs/explanation/running_time_calculation/" title="calcul de marche">calcul de marche&lt;/a>
pour connaître l&amp;rsquo;évolution de la vitesse et de la position dans le temps.&lt;/p>
&lt;h4 id="représentation-visuelle">Représentation visuelle&lt;/h4>
&lt;p>Le graphe de départ représente l&amp;rsquo;infrastructure physique&lt;/p>
&lt;p>&lt;img src="routes_time_1.png" alt="Graphe produit (1/3)">&lt;/p>
&lt;p>Il est ensuite &amp;ldquo;dupliqué&amp;rdquo; à des temps différents&lt;/p>
&lt;p>&lt;img src="routes_time_2.png" alt="Graphe produit (2/3)">&lt;/p>
&lt;p>Puis des nœuds sont reliés de manière à refléter le temps de parcours&lt;/p>
&lt;p>&lt;img src="routes_time_3.png" alt="Graphe produit (3/3)">&lt;/p>
&lt;h4 id="précisions">Précisions&lt;/h4>
&lt;ul>
&lt;li>Le graphe est construit &lt;em>au fil de l&amp;rsquo;exploration&lt;/em>.&lt;/li>
&lt;li>Une discrétisation est faite au niveau du temps, uniquement pour
évaluer ce qui a déjà été visité. Si le même emplacement est visité une
seconde fois, il faut une certaine différence de temps pour estimer
qu&amp;rsquo;il n&amp;rsquo;est pas déjà visité.&lt;/li>
&lt;li>Toutes les arêtes sont réalisées avec des calculs de marche&lt;/li>
&lt;li>La vitesse n&amp;rsquo;est pas discrétisée ni utilisée pour estimer quel
emplacement est déjà visité, mais elle fait partie des calculs.&lt;/li>
&lt;li>Par défaut, tous les calculs sont faits en allant à la vitesse maximale.
Les ralentissements sont ajoutés seulement quand ils sont nécessaires.&lt;/li>
&lt;/ul>
&lt;h4 id="exemple">Exemple&lt;/h4>
&lt;p>Par exemple, avec l&amp;rsquo;infrastructure suivante en se basant sur
le graphe des voies :
&lt;img src="example_infra.svg" alt="Infra d&amp;rsquo;exemple">&lt;/p>
&lt;p>Explorer le graphe des sillons possibles peut donner ce
type de résultat :
&lt;img src="example_graph.svg" alt="Représentation du graphe">&lt;/p></description></item><item><title>Docs: Exemple d'infrastructure</title><link>https://osrd.fr/fr/docs/explanation/models/data-models-full-example/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/explanation/models/data-models-full-example/</guid><description>
&lt;font color=#aa026d>
&lt;h3 id="introduction">Introduction&lt;/h3>
&lt;/font>
&lt;p>Cette page donne un exemple de la manière dont les formats de données sont utilisés pour décrire une infrastructure dans &lt;strong>OSRD&lt;/strong>.&lt;/p>
&lt;p>À cette fin, prenons comme exemple l&amp;rsquo;infrastructure-jouet suivante :&lt;/p>
&lt;p>&lt;img src="svg_diagrams/small_infra_diagram.drawio.svg" alt="Diagramme de l&amp;rsquo;Infrastructure">&lt;/p>
&lt;div class="alert alert-info" role="alert">
&lt;h4 class="alert-heading">Conseil&lt;/h4>
Pour zoomer sur un diagramme, cliquez sur le bouton d&amp;rsquo;édition qui apparaît au survol de celui-ci.
&lt;/div>
&lt;p>Ce diagramme est un aperçu de l&amp;rsquo;infrastructure avec les lignes et les stations uniquement.&lt;/p>
&lt;p>Cette infrastructure ne se veut pas réaliste, mais plutôt destinée à illustrer le modèle de données d&amp;rsquo;OSRD.
Cet exemple sera créé étape par étape et expliqué en cours de route.&lt;/p>
&lt;h4 id="le-générateur-dinfrastructures">Le générateur d&amp;rsquo;infrastructures&lt;/h4>
&lt;p>Dans le &lt;a href="https://github.com/OpenRailAssociation/osrd">dépôt &lt;em>OSRD&lt;/em>&lt;/a> se trouve une &lt;a href="https://github.com/OpenRailAssociation/osrd/tree/dev/python/railjson_generator">bibliothèque python&lt;/a> conçue pour aider à générer des infrastructures dans un format compris par &lt;em>OSRD&lt;/em>.&lt;/p>
&lt;p>L&amp;rsquo;infrastructure discutée dans cette section peut être générée grâce au fichier &lt;a href="https://github.com/OpenRailAssociation/osrd/blob/dev/tests/infra-scripts/small_infra.py">small_infra.py&lt;/a>. Pour en savoir plus sur les scripts de génération, vous pouvez consulter le &lt;a href="https://github.com/OpenRailAssociation/osrd/blob/dev/python/railjson_generator/README.md">README&lt;/a> correspondant.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="voies">Voies&lt;/h3>
&lt;/font>
&lt;h4 id="sections-de-voie-track-sections">Sections de voie (Track Sections)&lt;/h4>
&lt;p>Les premiers objets que nous devons définir sont les &lt;code>TrackSections&lt;/code>. La plupart des autres objets sont positionnés par rapport à celles-ci.&lt;/p>
&lt;p>Une section de voie est une section de rail (sans aiguillages). On peut choisir de diviser les voies de son infrastructure en autant de sections qu&amp;rsquo;on le souhaite. Ici, nous avons choisi d&amp;rsquo;utiliser les sections de voie les plus longues possibles, ce qui signifie qu&amp;rsquo;entre deux aiguillages, il y a toujours une seule section de voie.&lt;/p>
&lt;p>Les sections de voie sont ce sur quoi les trains simulés roulent. Ils sont l&amp;rsquo;équivalent abstrait des sections de rails physiques. Les sections de voie sont bidirectionnelles.&lt;/p>
&lt;p>Dans cet exemple, nous définissons deux voies pour la ligne entre les stations Ouest et Nord-Est. Nous avons également des voies de contournement aux stations Nord et Centre-Ouest pour plus de réalisme. Enfin, nous avons trois voies distinctes dans la station Ouest, puisqu&amp;rsquo;il s&amp;rsquo;agit d&amp;rsquo;une plaque tournante majeure dans notre infrastructure imaginaire.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/small_infra_rails.drawio.en.svg" alt="Diagramme des sections de voies">&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">Important&lt;/h4>
&lt;p>Les &lt;code>TrackSections&lt;/code> sont représentées par des flèches dans ce diagramme pour souligner le fait qu&amp;rsquo;elles ont un &lt;strong>début&lt;/strong> et une &lt;strong>fin&lt;/strong>. C&amp;rsquo;est important car les objets positionnés sur les sections de voie sont localisés en fonction de leur distance par rapport au &lt;strong>début&lt;/strong> de leur section de voie.&lt;/p>
&lt;p>Par conséquent, pour placer un objet au début de sa section de voie, définissez sa position à 0. Pour le déplacer à la fin de sa section de voie, définissez sa position à la &lt;code>length&lt;/code> de la section de voie.&lt;/p>
&lt;/div>
&lt;p>Ces attributs sont nécessaires pour que la section de voie soit complète :&lt;/p>
&lt;ul>
&lt;li>&lt;code>length&lt;/code> : la longueur de la section de voie en mètres.&lt;/li>
&lt;li>&lt;code>geo&lt;/code> : les coordonnées dans la réalité (geo pour géographique), au format &lt;a href="https://en.wikipedia.org/wiki/GeoJSON">GeoJSON&lt;/a>.&lt;/li>
&lt;li>attributs cosmétiques : &lt;code>line_name&lt;/code>, &lt;code>track_name&lt;/code>, &lt;code>track_number&lt;/code> qui sont utilisés pour indiquer le nom et les étiquettes qui ont été donnés aux voies / lignes dans la réalité.&lt;/li>
&lt;/ul>
&lt;p>Pour toutes les sections de voies de notre infrastructure, les attributs &lt;code>geo&lt;/code> se rapprochent beaucoup au schéma donné.&lt;/p>
&lt;p>Pour la plupart des sections de voies, leur &lt;code>length&lt;/code> est proportionnelle à ce que l&amp;rsquo;on peut voir sur le diagramme. Pour préserver la lisibilité, des exceptions ont été faites pour &lt;em>TA6&lt;/em>, &lt;em>TA7&lt;/em>, &lt;em>TD0&lt;/em> et &lt;em>TD1&lt;/em> (qui font 10km et 25km).&lt;/p>
&lt;h4 id="nœud">Nœud&lt;/h4>
&lt;p>Un &lt;code>Node&lt;/code> représente un nœud dans l&amp;rsquo;infrastructure. Dans une simulation OSRD, un train ne peut passer d&amp;rsquo;une section de voie à une autre que si elles sont reliées par un nœud.
Un nœud peut se présenter de deux manières différentes :&lt;/p>
&lt;p>&lt;strong>1) Aiguillages&lt;/strong>&lt;/p>
&lt;p>Les aiguillages peuvent être vus comme une collection de liens de sections de voies, partitionnés en groupes. Chaque groupe représente un état de l&amp;rsquo;aiguillage. Passer d&amp;rsquo;un groupe à un autre peut prendre du temps, et au maximum un lien peut être prêt à être utilisé à la fois.&lt;/p>
&lt;p>Dans le monde réel, les aiguillages ne sont pas uniques, mais plutôt des instances de modèles existants.&lt;/p>
&lt;p>&lt;strong>2) Liens de sections de voies&lt;/strong>&lt;/p>
&lt;p>Pour le moment, nous n&amp;rsquo;avons créé que des sections de voies, qui ne sont pas interconnectées (les données géospatiales ne sont pas utilisées pour déduire quelles voies sont connectées).&lt;/p>
&lt;p>Les &lt;code>link&lt;/code> sont utilisés pour connecter deux sections de voie ensemble, tout comme un joint de soudure le ferait dans la vie réelle. Dans une simulation OSRD, un train ne peut passer d&amp;rsquo;une section de voie à une autre que si elles sont reliées par ce type de nœud, le &lt;code>link&lt;/code> (ou par un autre &lt;code>NodeType&lt;/code>).&lt;/p>
&lt;p>Que ce soit pour les aiguillages ou les liens de sections de voies, les liens et les groupes ne font pas partie du switch lui-même, mais d&amp;rsquo;un objet &lt;code>NodeType&lt;/code>, qui est partagé par les aiguillages du même modèle.&lt;/p>
&lt;h6 id="types-de-nœud">Types de Nœud&lt;/h6>
&lt;p>Les &lt;code>NodeTypes&lt;/code> ont deux attributs obligatoires :&lt;/p>
&lt;ul>
&lt;li>&lt;code>ports&lt;/code> : Une liste de noms de ports. Un port est une extrémité du nœud qui peut être connecté à une section de voie.&lt;/li>
&lt;li>&lt;code>groups&lt;/code> : Un table de correspondance entre le nom des groupes et les listes de branches (connexion entre 2 ports) qui caractérisent les différentes positions possibles du type de nœud&lt;/li>
&lt;/ul>
&lt;p>À tout moment, tous les nœuds &lt;em>ont&lt;/em> un groupe actif, et &lt;em>peuvent avoir&lt;/em> une branche active, qui appartient toujours au groupe actif. Pendant une simulation, le changement de branche active à l&amp;rsquo;intérieur d&amp;rsquo;un groupe est instantané, mais le changement de branche active entre les groupes prend un temps configurable.
Ceci est dû au fait qu&amp;rsquo;un &lt;code>Nœud&lt;/code> peut-être un objet physique (dans le cas des aiguillages), et que le changement de branche active peut impliquer le déplacement de certaines de ses parties. Les &lt;code>groups&lt;/code> sont conçus pour représenter les différentes positions qu&amp;rsquo;un &lt;code>Nœud&lt;/code> peut avoir. Chaque groupe contient les liens qui peuvent être utilisés dans la position du &lt;code>Nœud&lt;/code> associé.&lt;/p>
&lt;p>Dans le cas des aiguilles, la durée nécessaire pour changer de groupe est stockée à l&amp;rsquo;intérieur du &lt;code>Nœud&lt;/code>, car elle peut varier en fonction de l&amp;rsquo;implémentation physique du modèle d&amp;rsquo;aiguillage.&lt;/p>
&lt;p>Nos exemples utilisent actuellement cinq &lt;code>NodeTypes&lt;/code>. Il est possible d&amp;rsquo;ajouter un type de nœud si nécessaire via le champ &lt;code>extended_node_type&lt;/code>.&lt;/p>
&lt;p>&lt;strong>1) Le lien entre deux sections de voies&lt;/strong>&lt;/p>
&lt;p>Celui-ci représente le lien entre deux sections de voies. Il possède deux ports : &lt;em>A&lt;/em> et &lt;em>B&lt;/em>.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/link.svg" alt="Diagramme d&amp;rsquo;un lien">&lt;/p>
&lt;p>Il permet de créer un lien entre deux sections de voies tel que définis dans OSRD. Ce n&amp;rsquo;est pas un objet physique.&lt;/p>
&lt;p>&lt;strong>2) L&amp;rsquo;aiguille&lt;/strong>&lt;/p>
&lt;p>L&amp;rsquo;omniprésent aiguillage en Y, qui peut être considéré comme la fusion de deux voies ou la séparation d&amp;rsquo;une voie.&lt;/p>
&lt;p>Ce type d&amp;rsquo;aiguillage possède trois ports : &lt;em>A&lt;/em>, &lt;em>B1&lt;/em> et &lt;em>B2&lt;/em>.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/point_switch.svg" alt="Diagramme d&amp;rsquo;aiguillage">&lt;/p>
&lt;p>Il y a deux groupes, chacun avec une connexion dans leur liste : &lt;code>A_B1&lt;/code>, qui connecte &lt;em>A&lt;/em> à &lt;em>B1&lt;/em>, et &lt;code>A_B2&lt;/code> qui connecte &lt;em>A&lt;/em> à &lt;em>B2&lt;/em>.&lt;/p>
&lt;p>Ainsi, à tout moment (sauf lorsque l&amp;rsquo;aiguille bouge pour changer de groupe), un train peut aller de &lt;em>A&lt;/em> à &lt;em>B1&lt;/em> ou de &lt;em>A&lt;/em> à &lt;em>B2&lt;/em> mais jamais aux deux en même temps. Un train ne peut pas aller de &lt;em>B1&lt;/em> à &lt;em>B2&lt;/em>.&lt;/p>
&lt;p>Une aiguille n&amp;rsquo;a que deux positions :&lt;/p>
&lt;ul>
&lt;li>&lt;em>A&lt;/em> vers &lt;em>B1&lt;/em>&lt;/li>
&lt;li>&lt;em>A&lt;/em> vers &lt;em>B2&lt;/em>&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="svg_diagrams/PointSwitch_AtoB1.svg" alt="Diagramme des positions de l&amp;rsquo;aiguillage"> &lt;img src="svg_diagrams/PointSwitch_AtoB2.svg" alt="Diagramme des positions de l&amp;rsquo;aiguillage">&lt;/p>
&lt;p>&lt;strong>3) L&amp;rsquo;aiguillage de croisement&lt;/strong>&lt;/p>
&lt;p>Il s&amp;rsquo;agit simplement de deux voies qui se croisent.&lt;/p>
&lt;p>Ce type a quatre ports : &lt;em>A1&lt;/em>, &lt;em>B1&lt;/em>, &lt;em>A2&lt;/em> et &lt;em>B2&lt;/em>.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/crossing.svg" alt="Diagramme de l&amp;rsquo;aiguillage croisé">&lt;/p>
&lt;p>Il ne comporte qu&amp;rsquo;un seul groupe contenant deux connexions : &lt;em>A1&lt;/em> vers &lt;em>B1&lt;/em> et &lt;em>A2&lt;/em> vers &lt;em>B2&lt;/em>. En effet, ce type d&amp;rsquo;aiguillage est &lt;em>passif&lt;/em> : il n&amp;rsquo;a pas de pièces mobiles. Bien qu&amp;rsquo;il n&amp;rsquo;ait qu&amp;rsquo;un seul groupe, il est tout de même utilisé par la simulation pour faire respecter les réservations de route.&lt;/p>
&lt;p>Voici les deux connexions différentes que ce type d&amp;rsquo;aiguillage possède :&lt;/p>
&lt;ul>
&lt;li>&lt;em>A1&lt;/em> vers &lt;em>B1&lt;/em>&lt;/li>
&lt;li>&lt;em>A2&lt;/em> vers &lt;em>B2&lt;/em>&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="svg_diagrams/Crossing_A1toB1.svg" alt="Diagramme des positions des aiguillages croisés"> &lt;img src="svg_diagrams/Crossing_A2toB2.svg" alt="Diagramme des positions des aiguillages croisés">&lt;/p>
&lt;p>&lt;strong>4) L&amp;rsquo;aiguillage de croisement double&lt;/strong>&lt;/p>
&lt;p>Celui-ci ressemble plus à deux aiguilles dos à dos. Il possède quatre ports : &lt;em>A1&lt;/em>, &lt;em>A2&lt;/em>, &lt;em>B1&lt;/em> et &lt;em>B2&lt;/em>.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/double_slip_crossing.svg" alt="Diagramme d&amp;rsquo;un aiguillage de croisement double">&lt;/p>
&lt;p>Cependant, il comporte quatre groupes, chacun avec une connexion. Les quatre connexions possibles sont les suivantes :&lt;/p>
&lt;ul>
&lt;li>&lt;em>A1&lt;/em> vers &lt;em>B1&lt;/em>&lt;/li>
&lt;li>&lt;em>A1&lt;/em> vers &lt;em>B2&lt;/em>&lt;/li>
&lt;li>&lt;em>A2&lt;/em> vers &lt;em>B1&lt;/em>&lt;/li>
&lt;li>&lt;em>A2&lt;/em> vers &lt;em>B2&lt;/em>&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="svg_diagrams/DoubleSlipCrossing_A1toB1.svg" alt="Diagramme des positions de l&amp;rsquo;aiguillage de croisement double"> &lt;img src="svg_diagrams/DoubleSlipCrossing_A1toB2.svg" alt="Diagramme des positions de l&amp;rsquo;aiguillage de croisement double">&lt;/p>
&lt;p>&lt;img src="svg_diagrams/DoubleSlipCrossing_A2toB1.svg" alt="Diagramme des positions de l&amp;rsquo;aiguillage de croisement double"> &lt;img src="svg_diagrams/DoubleSlipCrossing_A2toB2.svg" alt="Diagramme des positions de l&amp;rsquo;aiguillage de croisement double">&lt;/p>
&lt;p>&lt;strong>5) L&amp;rsquo;aiguillage de croisement simple&lt;/strong>&lt;/p>
&lt;p>Celui-ci ressemble plus à un mélange entre une aiguille simple et un croisement. Il possède quatre ports : &lt;em>A1&lt;/em>, &lt;em>A2&lt;/em>, &lt;em>B1&lt;/em> et &lt;em>B2&lt;/em>.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/single_slip_crossing.svg" alt="Diagramme d&amp;rsquo;un aiguillage de croisement simple">&lt;/p>
&lt;p>Voici les trois connexions que peut réaliser cet aiguillage :&lt;/p>
&lt;ul>
&lt;li>&lt;em>A1&lt;/em> vers &lt;em>B1&lt;/em>&lt;/li>
&lt;li>&lt;em>A1&lt;/em> vers &lt;em>B2&lt;/em>&lt;/li>
&lt;li>&lt;em>A2&lt;/em> vers &lt;em>B2&lt;/em>&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="svg_diagrams/SingleSlipCrossing_A1toB1.svg" alt="Diagramme des positions de l&amp;rsquo;aiguillage de croisement simple"> &lt;img src="svg_diagrams/SingleSlipCrossing_A1toB2.svg" alt="Diagramme des positions de l&amp;rsquo;aiguillage de croisement simple">
&lt;img src="svg_diagrams/SingleSlipCrossing_A2toB2.svg" alt="Diagramme des positions de l&amp;rsquo;aiguillage de croisement simple">&lt;/p>
&lt;h5 id="retour-aux-nœuds">Retour aux nœuds&lt;/h5>
&lt;p>Un &lt;code>Node&lt;/code> possède trois attributs :&lt;/p>
&lt;ul>
&lt;li>&lt;code>node_type&lt;/code> : l&amp;rsquo;identifiant &lt;a href="#types-daiguillages">&lt;code>NodeType&lt;/code>&lt;/a> de ce nœud.&lt;/li>
&lt;li>&lt;code>ports&lt;/code> : une correspondance entre les noms de port et les extrémités des sections de voie.&lt;/li>
&lt;li>&lt;code>group_change_delay&lt;/code> : le temps qu&amp;rsquo;il faut pour changer le groupe de l&amp;rsquo;aiguillage qui est actif.&lt;/li>
&lt;/ul>
&lt;p>Les noms des ports doivent correspondre aux ports du type du nœud choisi. Les extrémités de la section de voie peuvent être début ou fin, faites attention à choisir les bonnes.&lt;/p>
&lt;p>La plupart des nœuds de notre exemple sont des nœuds habituels. Le chemin de la gare du Nord à la gare du Sud a deux aiguillages de croisement. Enfin, il y a un aiguillage de croisement double juste avant que la ligne principale ne se divise en lignes Nord-Est et Sud-Est.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/small_infra_rails_n_points.drawio.en.svg" alt="Diagramme des sections de voie et des aiguillages">&lt;/p>
&lt;p>Il est important de noter que ces nœuds sont présents par défaut dans le code du projet. Seuls les &lt;code>extended_switch_type&lt;/code> ajoutés par l&amp;rsquo;utilisateur apparaîtront dans le railjson.&lt;/p>
&lt;h4 id="courbes-et-pentes">Courbes et pentes&lt;/h4>
&lt;p>Les &lt;code>Courbes&lt;/code> et les &lt;code>Pentes&lt;/code> sont essentielles pour des simulations réalistes. Ces objets sont définis comme une plage entre une position de début (&lt;code>begin&lt;/code>) et de fin (&lt;code>end&lt;/code>) sur une section de voie. Si une courbe / pente s&amp;rsquo;étend sur plus d&amp;rsquo;une section de voie, elle doit être ajoutée à toutes les sections.&lt;/p>
&lt;p>Les valeurs des courbes / pentes sont constantes sur toute leur étendue. Pour des courbes / pentes variables, il faut créer plusieurs objets.&lt;/p>
&lt;p>Les valeurs de pente sont mesurées en &lt;em>mètres par kilomètres&lt;/em>, et les valeurs de courbe sont mesurées en &lt;em>mètres&lt;/em> (le rayon de la courbe).&lt;/p>
&lt;div class="alert alert-primary" role="alert">
N&amp;rsquo;oubliez pas que la valeur &lt;code>begin&lt;/code> doit toujours être inférieure à la valeur &lt;code>end&lt;/code>. C&amp;rsquo;est pourquoi les valeurs de courbe/pente peuvent être négatives : une pente ascendante de 1 allant du décalage 10 à 0 est identique à une pente descendante de -1 allant des décalages 0 à 10.
&lt;/div>
&lt;p>Dans le fichier &lt;a href="https://github.com/OpenRailAssociation/osrd/blob/dev/tests/infra-scripts/small_infra.py">small_infra.py&lt;/a>, nous avons des pentes sur les sections de voie &lt;em>TA6&lt;/em>, &lt;em>TA7&lt;/em>, &lt;em>TD0&lt;/em> et &lt;em>TD1&lt;/em>.&lt;/p>
&lt;p>Il y a également des courbes sur les sections de voie &lt;em>TE0&lt;/em>, &lt;em>TE1&lt;/em>, &lt;em>TE3&lt;/em> et &lt;em>TF1&lt;/em>.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="enclenchement">Enclenchement&lt;/h3>
&lt;/font>
&lt;p>Jusqu&amp;rsquo;à présent, tous les objets ont contribué à la topologie (forme) des voies. La topologie serait suffisante pour que les trains puissent naviguer sur le réseau, mais pas assez pour le faire en toute sécurité. pour assurer la sécurité, deux systèmes collaborent :&lt;/p>
&lt;ul>
&lt;li>L&amp;rsquo;enclenchement garantit que les trains sont autorisés à avancer&lt;/li>
&lt;li>La signalisation est le moyen par lequel l&amp;rsquo;enclenchement communique avec le train&lt;/li>
&lt;/ul>
&lt;h4 id="détecteurs">Détecteurs&lt;/h4>
&lt;p>Ces objets sont utilisés pour créer des sections &lt;a href="https://ressources.data.sncf.com/explore/dataset/lexique-des-acronymes-sncf/table/?sort=abreviation&amp;amp;q=TVD">TVD&lt;/a> (Track Vacancy Detection) : la zone de la voie située entre deux détecteurs est une section TVD. Lorsqu&amp;rsquo;un train rencontre un détecteur, la section dans laquelle il entre est occupée. La seule fonction des sections TVD est de localiser les trains.&lt;/p>
&lt;p>Dans la réalité, les détecteurs peuvent être des &lt;a href="https://en.wikipedia.org/wiki/Axle_counter">compteurs d&amp;rsquo;essieux&lt;/a> ou des &lt;a href="https://en.wikipedia.org/wiki/Track_circuit">circuits de voie&lt;/a> par exemple.&lt;/p>
&lt;p>Pour que cette méthode de localisation soit efficace, les détecteurs doivent être placés régulièrement le long de vos voies, pas trop nombreux pour des raisons de coût, mais pas trop peu, car les sections TVD seraient alors très grandes et les trains devraient être très éloignés les uns des autres pour être distingués, ce qui réduirait la capacité.&lt;/p>
&lt;p>Il y a souvent des détecteurs à proximité de tous les extrémités des aiguillages. De cette façon, l&amp;rsquo;enclenchement est averti presque immédiatement lorsqu&amp;rsquo;un aiguillage est libéré, qui est alors libre d&amp;rsquo;être utilisé à nouveau.&lt;/p>
&lt;div class="alert alert-info" role="alert">
Prenons l&amp;rsquo;exemple d&amp;rsquo;un aiguillage de croisement : si le train A le franchit du &lt;em>nord&lt;/em> au &lt;em>sud&lt;/em> et que le train B arrive pour le franchir de l&amp;rsquo;&lt;em>ouest&lt;/em> à l&amp;rsquo;&lt;em>est&lt;/em>, dès que le dernier wagon du train A a franchi l&amp;rsquo;aiguillage, B devrait pouvoir partir, puisque A se trouve maintenant sur une section de voie complètement indépendante.
&lt;/div>
&lt;p>Dans &lt;em>OSRD&lt;/em>, les détecteurs sont des objets ponctuels. Les attributs dont ils ont besoin sont leur &lt;code>id&lt;/code> et leur localisation sur la voie (&lt;code>track&lt;/code> et &lt;code>offset&lt;/code>).&lt;/p>
&lt;p>&lt;img src="svg_diagrams/small_infra_detectors.drawio.en.svg" alt="Diagramme d&amp;rsquo;infra avec tous les détecteurs">&lt;/p>
&lt;div class="alert alert-info" role="alert">
Les carrés agglutinés représentent plusieurs détecteurs à la fois. En effet, certains tronçons de voie n&amp;rsquo;étant pas représentés sur toute leur longueur, nous n&amp;rsquo;avons pas pu représenter tous les détecteurs du tronçon de voie correspondant.
&lt;/div>
&lt;p>Quelques notes :&lt;/p>
&lt;ul>
&lt;li>Entre certains points, nous n&amp;rsquo;avons ajouté qu&amp;rsquo;un seul détecteur (et non pas deux), car ils étaient très proches les uns des autres, et cela n&amp;rsquo;aurait eu aucun sens de créer une minuscule section TVD entre eux. Cette situation s&amp;rsquo;est produite sur des sections de voies (&lt;em>TA3&lt;/em>, &lt;em>TA4&lt;/em>, &lt;em>TA5&lt;/em>, &lt;em>TF0&lt;/em> et &lt;em>TG3&lt;/em>).&lt;/li>
&lt;li>Dans notre infrastructure, il y a relativement peu de sections de voie qui sont assez longues pour nécessiter plus de détecteurs que ceux liés aux aiguillages. Ce sont, &lt;em>TA6&lt;/em>, &lt;em>TA7&lt;/em>, &lt;em>TDO&lt;/em>, &lt;em>TD1&lt;/em>, &lt;em>TF1&lt;/em>, &lt;em>TG1&lt;/em> et &lt;em>TH1&lt;/em>. Par exemple, &lt;em>TD0&lt;/em>, qui mesure 25 km, compte en fait 17 détecteurs au total.&lt;/li>
&lt;/ul>
&lt;h4 id="butoirs-bufferstops">Butoirs (&lt;code>BufferStops&lt;/code>)&lt;/h4>
&lt;p>Les &lt;code>BufferStops&lt;/code> sont des obstacles destinés à empêcher les trains de dérailler en bout des voies.&lt;/p>
&lt;p>Dans notre infrastructure, il y a un butoir sur chaque section de voie qui est un cul-de-sac. Il y a donc 8 butoirs au total.&lt;/p>
&lt;p>Avec les détecteurs, ils définissent les limites des sections &lt;a href="https://ressources.data.sncf.com/explore/dataset/lexique-des-acronymes-sncf/table/?sort=abreviation&amp;amp;q=TVD">TVD&lt;/a> (voir &lt;a href="#d%C3%A9tecteurs">Détecteurs&lt;/a>).&lt;/p>
&lt;h4 id="itinéraires-routes">Itinéraires (&lt;code>Routes&lt;/code>)&lt;/h4>
&lt;p>Une &lt;code>Route&lt;/code> est un itinéraire dans l&amp;rsquo;infrastructure. Un sillon est une séquence de routes. Les itinéraires sont utilisés pour réserver des sections de sillon avec l&amp;rsquo;enclenchement. Voir la &lt;a href="https://osrd.fr/fr/docs/reference/design-docs/interlocking/">documentation dédiée&lt;/a>.&lt;/p>
&lt;p>Il est représenté avec les attributs suivants :&lt;/p>
&lt;ul>
&lt;li>&lt;code>entry_point&lt;/code> et &lt;code>exit_point&lt;/code> : Références de détecteurs ou de butées qui marquent le début et la fin de l&amp;rsquo;itinéraire.&lt;/li>
&lt;li>&lt;code>entry_point_direction&lt;/code> : Direction à prendre sur la section de voie depuis &lt;code>entry_point&lt;/code> pour commencer l&amp;rsquo;itinéraire.&lt;/li>
&lt;li>&lt;code>switches_direction&lt;/code> : Un ensemble de directions à suivre lorsqu&amp;rsquo;on rencontre un aiguillage sur notre itinéraire, de manière à reconstituer cet itinéraire de &lt;code>entry_point&lt;/code> jusqu&amp;rsquo;à &lt;code>exit_point&lt;/code>.&lt;/li>
&lt;li>&lt;code>release_detectors&lt;/code> : Lorsqu&amp;rsquo;un train franchit un détecteur de libération, les ressources réservées depuis le début de la route jusqu&amp;rsquo;à ce détecteur sont libérées.&lt;/li>
&lt;/ul>
&lt;font color=#aa026d>
&lt;h3 id="signalisation">Signalisation&lt;/h3>
&lt;/font>
&lt;p>Grâce à l&amp;rsquo;enclenchement, les trains sont localisés et autorisés à se déplacer. C&amp;rsquo;est un bon début, mais c&amp;rsquo;est inutile tant que les trains n&amp;rsquo;en sont pas informés. C&amp;rsquo;est là que les &amp;ldquo;signaux&amp;rdquo; entrent en jeu : les signaux réagissent aux enclenchements et peuvent être vus par les trains.&lt;/p>
&lt;p>La façon dont les trains réagissent aux signaux dépend de l&amp;rsquo;aspect, du type de signal et du système de signalisation.&lt;/p>
&lt;p>Voici les attributs les plus importants des signaux :&lt;/p>
&lt;ul>
&lt;li>&lt;code>linked_detector&lt;/code> : Le &lt;a href="#d%C3%A9tecteurs">détecteur&lt;/a> lié.&lt;/li>
&lt;li>&lt;code>type_code&lt;/code> : Le type de signal.&lt;/li>
&lt;li>&lt;code>direction&lt;/code> : La direction qu&amp;rsquo;il protège, qui peut être simplement interprétée comme la façon dont il peut être vu par un train entrant (puisqu&amp;rsquo;il n&amp;rsquo;y a des feux que d&amp;rsquo;un côté&amp;hellip;). La direction est relative à l&amp;rsquo;orientation de la section de voie.&lt;/li>
&lt;li>Des attributs cosmétiques comme &lt;code>angle_geo&lt;/code> and &lt;code>side&lt;/code> qui contrôlent la manière dont les signaux sont affichés dans le front-end.&lt;/li>
&lt;/ul>
&lt;p>Voici une visualisation de comment on peut représenter un signal, et quelle direction il protège.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/signal_dir.en.svg" alt="Exemple de signal de direction">&lt;/p>
&lt;br/>
&lt;p>La manière dont les signaux sont disposés dépend fortement du système de signalisation et du gestionnaire de l&amp;rsquo;infrastructure.&lt;/p>
&lt;p>Voici les règles de base utilisées pour cet exemple d&amp;rsquo;infrastructure :&lt;/p>
&lt;ul>
&lt;li>Nous ajoutons deux signaux d&amp;rsquo;espacement (un par direction) pour chaque détecteur qui découpe une longue section de TVD en plus petites sections.&lt;/li>
&lt;li>Les entrées d&amp;rsquo;aiguillage où un train pourrait devoir s&amp;rsquo;arrêter sont protégées par un signal (qui est situé à l&amp;rsquo;extérieur de la section TVD de l&amp;rsquo;aiguillage). Il doit être visible depuis la direction utilisée pour approcher l&amp;rsquo;aiguillage. Lorsqu&amp;rsquo;il y a plusieurs aiguillages dans une rangée, seul le premier a généralement besoin d&amp;rsquo;être protégé, car l&amp;rsquo;enclenchement est généralement conçu pour ne pas encourager les trains à s&amp;rsquo;arrêter au milieu des intersections.&lt;/li>
&lt;/ul>
&lt;p>Notez que les détecteurs liés à au moins un signal ne sont pas représentés, car il n&amp;rsquo;y a pas de signaux sans détecteurs associés dans cet exemple.&lt;/p>
&lt;p>Pour obtenir le &lt;code>id&lt;/code> d&amp;rsquo;un détecteur lié à un signal, prenez le &lt;code>id&lt;/code> du signal et remplacez &lt;em>S&lt;/em> par &lt;em>D&lt;/em> (par exemple SA0 -&amp;gt; DA0).&lt;/p>
&lt;p>&lt;img src="svg_diagrams/small_infra_signals.drawio.en.svg" alt="Diagramme d&amp;rsquo;infra avec tous les signaux">&lt;/p>
&lt;div class="alert alert-info" role="alert">
Sur &lt;em>TA6&lt;/em>, &lt;em>TA7&lt;/em>, &lt;em>TD0&lt;/em> et &lt;em>TD1&lt;/em> nous n&amp;rsquo;avons pas pu représenter tous les signaux car ces sections de voie sont très longues et comportent de nombreux détecteurs, donc de nombreux signaux.
&lt;/div>
&lt;font color=#aa026d>
&lt;h3 id="électrification">Électrification&lt;/h3>
&lt;/font>
&lt;p>Pour permettre à des trains électriques de circuler sur notre infrastructure, nous devons spécifier les parties de celle-ci qui sont électrifiées.&lt;/p>
&lt;h4 id="caténaires-catenaries">Caténaires (&lt;code>Catenaries&lt;/code>)&lt;/h4>
&lt;p>Les &lt;code>Catenaries&lt;/code> représentent les câbles d&amp;rsquo;alimentation qui alimentent les trains électriques. Ils sont représentés avec les attributs suivants :&lt;/p>
&lt;ul>
&lt;li>&lt;code>voltage&lt;/code> : Une chaîne de caractères représentant le type d&amp;rsquo;alimentation électrique utilisée pour l&amp;rsquo;électrification.&lt;/li>
&lt;li>&lt;code>track_ranges&lt;/code> : Une liste de portions de sections de voie (&lt;code>TrackRanges&lt;/code>) couvertes par cette caténaire. Une &lt;code>TrackRange&lt;/code> est composée d&amp;rsquo;un identifiant de section de voie, d&amp;rsquo;une position &lt;code>begin&lt;/code> et d&amp;rsquo;une position &lt;code>end&lt;/code>.&lt;/li>
&lt;/ul>
&lt;p>Dans notre exemple, nous avons deux &lt;code>Catenaries&lt;/code>:&lt;/p>
&lt;ul>
&lt;li>Une avec &lt;code>voltage&lt;/code> défini sur &lt;code>&amp;quot;1500&amp;quot;&lt;/code>, qui couvre uniquement &lt;em>TA0&lt;/em>.&lt;/li>
&lt;li>Une avec &lt;code>voltage&lt;/code> défini sur &lt;code>&amp;quot;25000&amp;quot;&lt;/code>, qui couvre tous les autres sauf &lt;em>TD1&lt;/em>.&lt;/li>
&lt;/ul>
&lt;p>Cela signifie que seuls les trains thermiques peuvent traverser la section de voie &lt;em>TD1&lt;/em>.&lt;/p>
&lt;p>Notre exemple montre également que, contrairement à son homologue réel, une seule &lt;code>Catenary&lt;/code> peut couvrir toute l&amp;rsquo;infrastructure.&lt;/p>
&lt;h4 id="sections-neutres-neutralsections">Sections Neutres (&lt;code>NeutralSections&lt;/code>)&lt;/h4>
&lt;p>Dans certaines parties d&amp;rsquo;une infrastructure, les conducteurs de train sont sommés - principalement pour des raisons de sécurité - de couper l&amp;rsquo;alimentation électrique du train.&lt;/p>
&lt;p>Pour représenter de telles parties, nous utilisons des &lt;code>NeutralSections&lt;/code>. Elles sont représentées avec principalement les attributs suivants :&lt;/p>
&lt;ul>
&lt;li>&lt;code>track_ranges&lt;/code> : Une liste de &lt;code>DirectedTrackRanges&lt;/code> (portions de sections de voie associées à une direction) couvertes par cette section neutre.&lt;/li>
&lt;li>&lt;code>lower_pantograph&lt;/code> : Un booléen indiquant si le pantographe du train doit être abaissé pendant la traversée de cette section.&lt;/li>
&lt;/ul>
&lt;p>Dans notre exemple, nous avons trois &lt;code>NeutralSections&lt;/code> : une à la jonction des caténaires &lt;code>&amp;quot;1500&amp;quot;&lt;/code> et &lt;code>&amp;quot;25000&amp;quot;&lt;/code>, une sur &lt;em>TA6&lt;/em> et une sur &lt;em>TG1&lt;/em> et &lt;em>TG4&lt;/em>.&lt;/p>
&lt;p>Pour plus de détails sur le modèle, voir la &lt;a href="../neutral_sections">page dédiée&lt;/a>.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="divers">Divers&lt;/h3>
&lt;/font>
&lt;h4 id="points-opérationnels-operationalpoints">Points opérationnels (&lt;code>OperationalPoints&lt;/code>)&lt;/h4>
&lt;p>Le &lt;em>point operationnel&lt;/em> est aussi connu sous le nom de &lt;em>Point Remarquable&lt;/em> (PR).
Un &lt;code>OperationalPoint&lt;/code> est une &lt;strong>collection&lt;/strong> de points (&lt;code>OperationalPointParts&lt;/code>) d&amp;rsquo;intérêt.&lt;/p>
&lt;p>Par exemple, il peut être pratique (repère de conduite) de stocker l&amp;rsquo;emplacement des plateformes en tant que parties et de les regrouper par station dans des points opérationnels.
De la même manière, un pont au-dessus des voies sera &lt;strong>un&lt;/strong> OperationalPoint, mais il comportera &lt;strong>plusieurs&lt;/strong> OperationPointParts, une à l&amp;rsquo;intersection de chaque voie.&lt;/p>
&lt;p>Dans l&amp;rsquo;exemple de l&amp;rsquo;infrastructure, nous n&amp;rsquo;avons utilisé que des points opérationnels pour représenter les stations. Les parties de points opérationnels sont représentées par des diamants violets. Gardez à l&amp;rsquo;esprit qu&amp;rsquo;un seul point opérationnel peut contenir plusieurs parties.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/small_infra_op_points.drawio.en.svg" alt="Exemples de points opérationnels">&lt;/p>
&lt;h4 id="limites-de-gabarit-loading-gauge-limits">Limites de gabarit (&lt;code>Loading Gauge Limits&lt;/code>)&lt;/h4>
&lt;p>Cet objet s&amp;rsquo;apparente aux &lt;code>Pentes&lt;/code> et aux &lt;code>Courbes&lt;/code> : il couvre une plage de section de voie, avec une position de début (&lt;code>begin&lt;/code>) et de fin (&lt;code>end&lt;/code>). Il représente une restriction sur les trains qui peuvent circuler sur la plage donnée, par poids ou par type de train (fret ou passagers).&lt;/p>
&lt;p>Nous n&amp;rsquo;en avons pas mis dans nos exemples.&lt;/p>
&lt;h4 id="sections-de-vitesse-speedsections">Sections de vitesse (&lt;code>SpeedSections&lt;/code>)&lt;/h4>
&lt;p>Les &lt;code>SpeedSections&lt;/code> représentent les limites de vitesse (en mètres par seconde) qui sont appliquées sur certaines parties des voies. Une &lt;code>SpeedSection&lt;/code> peut s&amp;rsquo;étendre sur plusieurs sections de voie, et ne couvre pas nécessairement la totalité des sections de voie. Les sections de vitesse peuvent se chevaucher.&lt;/p>
&lt;p>Dans notre exemple d&amp;rsquo;infrastructure, nous avons une section de vitesse couvrant l&amp;rsquo;ensemble de l&amp;rsquo;infrastructure, limitant la vitesse à 300 km/h. Sur une plus petite partie de l&amp;rsquo;infrastructure, nous avons appliqué des sections de vitesse plus restrictives.&lt;/p>
&lt;p>&lt;img src="svg_diagrams/speed_sections.en.svg" alt="Exemples de sections de vitesse">&lt;/p></description></item><item><title>Docs: Localisation</title><link>https://osrd.fr/fr/docs/reference/design-docs/interlocking/location/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/interlocking/location/</guid><description>
&lt;h2 id="description">Description&lt;/h2>
&lt;p>La couche de localisation permet à d&amp;rsquo;autres modules de simulation de suivre le déplacement du train dans l&amp;rsquo;infrastructure.
L&amp;rsquo;infrastructure ferroviaire est découpée en régions appelées zones. Quand on train entre dans une zone, ce module permet d&amp;rsquo;en être notifié.&lt;/p>
&lt;p>Les zones (ou TVDSection / DetectionSection) sont des partitions physiques des voies :&lt;/p>
&lt;ul>
&lt;li>capables de détecter la présence d&amp;rsquo;un train&lt;/li>
&lt;/ul>
&lt;h2 id="exigences-de-conception">Exigences de conception&lt;/h2>
&lt;ul>
&lt;li>il doit être possible de suivre les changements d&amp;rsquo;occupation d&amp;rsquo;une zone&lt;/li>
&lt;li>il &lt;em>devra&lt;/em> être possible de suivre les déplacements d&amp;rsquo;un train&lt;/li>
&lt;li>il &lt;em>devra&lt;/em> être possible d&amp;rsquo;implémenter un système de bloc mobile&lt;/li>
&lt;/ul>
&lt;h2 id="dépendances">Dépendances&lt;/h2>
&lt;ul>
&lt;li>&lt;code>statique&lt;/code> une liste de zones&lt;/li>
&lt;/ul>
&lt;h2 id="opérations">Opérations&lt;/h2>
&lt;ul>
&lt;li>Occuper une zone&lt;/li>
&lt;li>Libérer une zone&lt;/li>
&lt;li>Observer les changements d&amp;rsquo;occupation d&amp;rsquo;une zone&lt;/li>
&lt;/ul></description></item><item><title>Docs: Zones neutres</title><link>https://osrd.fr/fr/docs/explanation/models/neutral_sections/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/explanation/models/neutral_sections/</guid><description>
&lt;h2 id="objet-physique-que-lon-cherche-à-modéliser">Objet physique que l&amp;rsquo;on cherche à modéliser&lt;/h2>
&lt;h3 id="introduction">Introduction&lt;/h3>
&lt;p>Pour qu&amp;rsquo;un train puisse circuler, il faut soit qu&amp;rsquo;il ait une source d&amp;rsquo;énergie à bord (fuel, batterie, hydrogène, &amp;hellip;) soit qu&amp;rsquo;on l&amp;rsquo;alimente en énergie tout au long de son parcours.&lt;/p>
&lt;p>Pour fournir cette énergie, des câbles électriques sont suspendus au dessus des voies: les &lt;em>caténaires&lt;/em>. Le train assure ensuite un contact avec ces câbles grâce à un patin conducteur monté sur un bras mécanique: le &lt;em>pantographe&lt;/em>.&lt;/p>
&lt;h3 id="zones-neutres">Zones neutres&lt;/h3>
&lt;p>Avec ce système il est difficile d&amp;rsquo;assurer l&amp;rsquo;alimentation électrique d&amp;rsquo;un train en continu sur toute la longueur d&amp;rsquo;une ligne: sur certaines portions de voie, il est nécessaire de couper l&amp;rsquo;alimentation électrique du train. Ce sont ces portions que l&amp;rsquo;on appelle &lt;strong>zones neutres&lt;/strong>.&lt;/p>
&lt;p>En effet, pour éviter les pertes énergétiques le long des caténaires, le courant est fourni par plusieurs sous-stations réparties le long des voies. Deux portions de caténaires alimentées par des sous-stations différentes doivent être isolées électriquement pour éviter les courts-circuits.&lt;/p>
&lt;p>Par ailleurs, la façon dont les voies sont électrifiées (courant continu ou non par exemple) peut changer selon les us locaux et l&amp;rsquo;époque d&amp;rsquo;installation. Il faut également isoler électriquement les portions de voies qui sont électrifiées différemment. Le train doit aussi (sauf cas particuliers) changer de pantographe lorsqu&amp;rsquo;il change de type d&amp;rsquo;électrification.&lt;/p>
&lt;p>Dans ces deux cas on indique alors au conducteur de couper la traction du train, et parfois même d&amp;rsquo;en baisser le pantographe.&lt;/p>
&lt;p>Dans l&amp;rsquo;infrastructure française, ces zones sont signalées par des panneaux d&amp;rsquo;annonce, d&amp;rsquo;exécution et de fin. Ces panneaux portent par ailleurs l&amp;rsquo;indication de baisser le pantographe ou non. Les portions de voies entre l&amp;rsquo;exécution et la fin peuvent ne pas être électrifiées entièrement, et même ne pas posséder de caténaire (dans ce cas la zone nécessite forcément de baisser le pantographe).&lt;br>
Parfois, des pancartes &lt;em>REV&lt;/em> (pour réversible) sont placées en aval des panneaux de fin de zone. Elles sont destinées aux trains qui circulent avec un pantographe à l&amp;rsquo;arrière du train. Ces pancartes indiquent que le conducteur peut reprendre la traction en toute sécurité.&lt;/p>
&lt;p>Par ailleurs il peut parfois être impossible sur une courte portion de voie de placer une caténaire ou bien de lever le pantographe du train. Dans ce cas la ligne est tout de même considérée électrifiée, et la zone sans électrification (passage sous un pont par exemple) est considérée comme une zone neutre.&lt;/p>
&lt;h3 id="matériel-roulant">Matériel roulant&lt;/h3>
&lt;p>Après avoir traversé une zone neutre, un train doit reprendre la traction. Ce n&amp;rsquo;est pas immédiat (quelques secondes), et la durée nécessaire dépend du matériel roulant.&lt;/p>
&lt;p>Il doit également, le cas échéant, relever son pantographe, ce qui prend également du temps (quelques dizaines de secondes) et dépend également du matériel roulant.&lt;/p>
&lt;p>Ainsi la marche sur l&amp;rsquo;erre imposée au train s&amp;rsquo;étend en dehors de la zone neutre, puisque ces temps systèmes sont à décompter à partir de la fin de la zone neutre.&lt;/p>
&lt;h2 id="modèle-de-données">Modèle de données&lt;/h2>
&lt;p>Nous avons choisi de modéliser les zones neutres comme l&amp;rsquo;espace entre les panneaux liés à celle-ci (et non pas comme la zone précise où il n&amp;rsquo;y a pas de caténaire ou bien où la caténaire n&amp;rsquo;est pas électrifiée).&lt;/p>
&lt;p>Cette zone est directionnelle, &lt;em>i.e.&lt;/em> associée à un sens de circulation, pour pouvoir prendre en compte des placements de panneaux différents selon le sens. Le panneau d&amp;rsquo;exécution d&amp;rsquo;un sens donné n&amp;rsquo;est pas nécessairement placé à la même position que le panneau de fin de zone du sens opposé.&lt;/p>
&lt;p>Pour une voie à double sens, une zone neutre est donc représentée par deux objets.&lt;/p>
&lt;p>Le schema est le suivant&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;lower_pantograph&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#a40000">boolean&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;track_ranges&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;track&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#a40000">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;start&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#a40000">number&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;end&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#a40000">number&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;direction&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#a40000">enum&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">],&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;announcement_track_ranges&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000;font-weight:bold">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;track&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#a40000">string&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;start&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#a40000">number&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;end&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#a40000">number&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#204a87;font-weight:bold">&amp;#34;direction&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#a40000">enum&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#000;font-weight:bold">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;code>lower_pantograph&lt;/code> : indique si le pantographe doit être baissé dans cette zone&lt;/li>
&lt;li>&lt;code>track_ranges&lt;/code> : liste des portions de voie où le train ne doit pas tractionner&lt;/li>
&lt;li>&lt;code>announcement_track_ranges&lt;/code> : liste des portions de voie entre le panneau d&amp;rsquo;annonce et le panneau d’exécution&lt;/li>
&lt;/ul>
&lt;h2 id="affichage">Affichage&lt;/h2>
&lt;h3 id="cartographie">Cartographie&lt;/h3>
&lt;p>Les zones affichées dans la cartographie correspondent aux &lt;code>track_ranges&lt;/code>, donc entre les panneaux d’exécution et de fin de zone. La couleur de la zone indique si le train doit baisser son pantographe dans la zone ou non.&lt;/p>
&lt;p>La direction dans laquelle la zone s&amp;rsquo;applique n&amp;rsquo;est pas représentée.&lt;/p>
&lt;h3 id="résultat-de-simulation">Résultat de simulation&lt;/h3>
&lt;p>Dans l&amp;rsquo;affichage linéaire, c&amp;rsquo;est toujours la zone entre EXE et FIN qui est affichée.&lt;/p>
&lt;h2 id="recherche-ditinéraire">Recherche d&amp;rsquo;itinéraire&lt;/h2>
&lt;p>Les zones neutres sont donc des portions de voie &amp;ldquo;non électrifiées&amp;rdquo; où un train électrique peut tout de même circuler (mais où il ne peut pas tractionner).&lt;/p>
&lt;p>Lors de la recherche de chemin dans l&amp;rsquo;infrastructure, une portion de voie qui n&amp;rsquo;est pas couverte par les &lt;code>track_ranges&lt;/code> d&amp;rsquo;un objet caténaire (documentation à écrire) peut être empruntée par un train électrique seulement si elle est couverte par les &lt;code>track_ranges&lt;/code> d&amp;rsquo;une zone neutre.&lt;/p>
&lt;h2 id="simulation">Simulation&lt;/h2>
&lt;p>Dans la simulation, nous approximons le comportement du conducteur de la façon suivante :&lt;/p>
&lt;ul>
&lt;li>La marche sur l&amp;rsquo;erre est entamée dès que la tête du train passe le panneau d&amp;rsquo;annonce&lt;/li>
&lt;li>Le décompte des temps systèmes (relevé du pantographe et reprise de la traction) commence dès que la tête du train passe le panneau de fin.&lt;/li>
&lt;/ul>
&lt;p>Dans la simulation actuelle, il est plus facile de manier des bornes d&amp;rsquo;intégration spatiales que temporelles. Nous effectuons l&amp;rsquo;approximation suivante: lors de la sortie de la zone neutre, on multiplie les temps systèmes par la vitesse en sortie de zone. La marche sur l&amp;rsquo;erre est alors prolongée de la distance obtenue. Cette approximation est raisonnable car l&amp;rsquo;inertie du train et la quasi-absence de frottement garantissent que la vitesse varie peu sur cet intervalle de temps.&lt;/p>
&lt;h2 id="potentielles-améliorations">Potentielles améliorations&lt;/h2>
&lt;p>Plusieurs points pourraient être améliorés :&lt;/p>
&lt;ul>
&lt;li>On ne considère pas les pancartes &lt;em>REV&lt;/em>, tous les trains ne possèdent donc qu&amp;rsquo;un pantographe à l&amp;rsquo;avant dans nos simulations.&lt;/li>
&lt;li>Les temps systèmes sont approximés.&lt;/li>
&lt;li>Le comportement conducteur est plutôt restrictif (la marche sur l&amp;rsquo;erre pourrait commencer après le panneau d&amp;rsquo;annonce).&lt;/li>
&lt;li>L&amp;rsquo;affichage des zones est limité: pas de représentation de la direction ou des zones d&amp;rsquo;annonce.&lt;/li>
&lt;li>Ces zones ne sont pas éditables.&lt;/li>
&lt;/ul></description></item><item><title>Docs: Discontinuités et retours en arrière</title><link>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/backtracking/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/backtracking/</guid><description>
&lt;h4 id="le-problème-des-discontinuités">Le problème des discontinuités&lt;/h4>
&lt;p>Au moment d&amp;rsquo;explorer une arête du graphe, on effectue un calcul de
marche pour connaître l&amp;rsquo;évolution de la vitesse.
Mais il n&amp;rsquo;est pas possible de voir plus loin que l&amp;rsquo;arête en question,
ce qui est gênant pour calculer les courbes de freinages qui peuvent
nécessiter de commencer à freiner plusieurs kilomètres avant l&amp;rsquo;arrivée.&lt;/p>
&lt;p>&lt;img src="discontinuity.png" alt="Discontinuité">&lt;/p>
&lt;blockquote>
&lt;p>Cet exemple illustre le problème : par défaut
la première arête est explorée en allant à la vitesse maximale.
C&amp;rsquo;est seulement en explorant la seconde arête que la destination devient visible,
sans que la distance restante soit suffisante pour s&amp;rsquo;arrêter.&lt;/p>
&lt;/blockquote>
&lt;h4 id="la-solution--revenir-en-arrière">La solution : revenir en arrière&lt;/h4>
&lt;p>Pour régler ce problème, lorsqu&amp;rsquo;une arête est générée avec une discontinuité
dans les courbes de vitesse, l&amp;rsquo;algorithme revient sur les arêtes précédentes
pour en créer des nouvelles qui incluent les décélérations.&lt;/p>
&lt;p>Pour donner un exemple simplifié, sur un chemin de 4 routes
où le train peut accélérer ou décélérer de 10km/h par route :&lt;/p>
&lt;p>&lt;img src="backtracking_1.png" alt="Discontinuité (version arêtes, 1/2)">&lt;/p>
&lt;p>Pour que le train s&amp;rsquo;arrête à la fin de la route 4, il doit être au plus à 10km/h
à la fin de la route 3. Une nouvelle arête est alors créée sur la route
3 qui finit à 10km/h. Une décélération est ensuite calculée à rebours de la fin de la route
vers le début, jusqu&amp;rsquo;à retrouver la courbe d&amp;rsquo;origine (ou le début
de l&amp;rsquo;arrête).&lt;/p>
&lt;p>Dans cet exemple, la discontinuité a seulement été déplacée vers la
transition entre les routes 2 et 3. Le procédé est ensuite réitéré
sur la route 2, ce qui donne le résultat suivant :&lt;/p>
&lt;p>&lt;img src="backtracking_2.png" alt="Discontinuité (version arêtes, 2/2)">&lt;/p>
&lt;p>Les anciennes arêtes sont toujours présentes dans le graphe, elles
peuvent mener à d&amp;rsquo;autres solutions.&lt;/p></description></item><item><title>Docs: Le système d'enveloppes</title><link>https://osrd.fr/fr/docs/explanation/running_time_calculation/envelopes_system/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/explanation/running_time_calculation/envelopes_system/</guid><description>
&lt;p>Le système d&amp;rsquo;enveloppes est une interface créée spécifiquement pour le calcul de marche d&amp;rsquo;OSRD. Il permet de manipuler différentes courbes espace/vitesse, de les découper, de les mettre bout à bout, d&amp;rsquo;interpoler des points spécifiques, et d&amp;rsquo;adresser beaucoup d&amp;rsquo;autres besoins nécessaires au calcul de marche.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="une-interface-spécifique-dans-le-service-osrd-core">Une interface spécifique dans le service OSRD Core&lt;/h3>
&lt;/font>
&lt;p>Le système d&amp;rsquo;enveloppes fait partie du service core d&amp;rsquo;OSRD (voir &lt;a href="../architecture/_index">l&amp;rsquo;architecture du logiciel&lt;/a>).&lt;/p>
&lt;p>Ses principaux composants sont :&lt;/p>
&lt;p>&lt;strong>1 - EnvelopePart :&lt;/strong> courbe espace/vitesse, définie comme une séquence des points et possédant des métadonnées indiquant par exemple s&amp;rsquo;il s&amp;rsquo;agit d&amp;rsquo;une courbe d&amp;rsquo;accélération, de freinage, de maintien de vitesse, etc.&lt;/p>
&lt;p>&lt;strong>2 - Envelope :&lt;/strong> liste d&amp;rsquo;EnvelopeParts mises bout-à-bout et sur laquelle il est possible d&amp;rsquo;effectuer certaines opérations :&lt;/p>
&lt;ul>
&lt;li>vérifier la continuité dans l’espace (obligatoire) et dans la vitesse (facultative)&lt;/li>
&lt;li>chercher la vitesse minimale et/ou maximale de l&amp;rsquo;enveloppe&lt;/li>
&lt;li>couper une partie de l’enveloppe entre deux points de l&amp;rsquo;espace&lt;/li>
&lt;li>effectuer une interpolation de vitesse à une certaine position&lt;/li>
&lt;li>calculer le temps écoulé entre deux positions de l’enveloppe&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="../envelopes_scheme.png" alt="envelope_scheme">&lt;/p>
&lt;p>&lt;strong>3 - Overlays :&lt;/strong> système permettant d’ajouter des EnvelopePart plus contraignantes (c&amp;rsquo;est-à-dire dont la vitesse est plus faible) à une enveloppe existante.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="enveloppes-données-vs-enveloppes-calculées">Enveloppes données vs enveloppes calculées&lt;/h3>
&lt;/font>
&lt;p>Pendant la simulation, le train est censé suivre certaines instructions de vitesse. Celles-ci sont modélisées dans OSRD par des enveloppes sous forme de courbes espace/vitesse. On en distingue deux types :&lt;/p>
&lt;ul>
&lt;li>Les enveloppes provenant &lt;strong>des données d&amp;rsquo;infrastructure et de matériel roulant&lt;/strong>, comme la vitesse maximale de la ligne et la vitesse maximale du train. Etant des données d&amp;rsquo;entrée de notre calcul, elles ne correspondent pas à des courbes ayant un sens physique, car elles ne sont pas issues des résultats d&amp;rsquo;une intégration réelle des équations physiques du mouvement.&lt;/li>
&lt;li>Les enveloppes résultant &lt;strong>d&amp;rsquo;une intégration réelle&lt;/strong> des équations du mouvement physique. Elles correspondent à une courbe physiquement tenable par le train et contiennent également des informations sur le temps.&lt;/li>
&lt;/ul>
&lt;p>Un exemple simple pour illustrer cette différence : si l&amp;rsquo;on simule un trajet de TER sur une ligne de montagne, une des données d&amp;rsquo;entrée va être une enveloppe de vitesse maximale à 160km/h, correspondant à la vitesse maximale de notre TER. Mais cette enveloppe ne correspond pas à une réalité physique, car il se peut que sur certaines portions la rampe soit trop raide pour que le train arrive effectivement à maintenir cette vitesse maximale de 160km/h. L&amp;rsquo;enveloppe calculée présentera donc dans cet exemple un décrochage de vitesse dans les zones de fortes rampes, là où l&amp;rsquo;enveloppe donnée était parfaitement plate.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="simulation-de-plusieurs-trains">Simulation de plusieurs trains&lt;/h3>
&lt;/font>
&lt;p>Dans le cas de la simulation de nombreux trains, le système de signalisation doit assurer &lt;strong>la sécurité&lt;/strong>. L&amp;rsquo;effet de la signalisation sur le calcul de marche d&amp;rsquo;un train est reproduit en superposant des enveloppes dynamiques à l&amp;rsquo;enveloppe statique. Une nouvelle enveloppe dynamique est introduite par exemple lorsqu&amp;rsquo;un signal se ferme. Le train suit l&amp;rsquo;enveloppe économique statique superposée aux enveloppes dynamiques, s&amp;rsquo;il y en a. Dans ce mode de simulation, un contrôle du temps est effectué par rapport à un temps théorique provenant de l&amp;rsquo;information temporelle de l&amp;rsquo;enveloppe économique statique. Si le train est en retard par rapport à l&amp;rsquo;heure prévue, il cesse de suivre l&amp;rsquo;enveloppe économique et essaie d&amp;rsquo;aller plus vite. Sa courbe espace/vitesse sera donc limitée par l&amp;rsquo;enveloppe d&amp;rsquo;effort maximum.&lt;/p></description></item><item><title>Docs: Reservation</title><link>https://osrd.fr/fr/docs/reference/design-docs/interlocking/reservation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/interlocking/reservation/</guid><description>
&lt;div class="alert alert-warning" role="alert">
Le mot réservation ici a pour sens réservation de la resource itinéraire, et non le sens commande planifiée d&amp;rsquo;itinéraire
&lt;/div>
&lt;h2 id="description">Description&lt;/h2>
&lt;p>Les zones (ou TVDSection / DetectionSection) sont des partitions physiques des voies :&lt;/p>
&lt;ul>
&lt;li>capables de détecter la présence d&amp;rsquo;un train&lt;/li>
&lt;li>qui fournissent un service de réservation à l&amp;rsquo;usage des routes&lt;/li>
&lt;/ul>
&lt;p>Chaque zone a un certain nombre de configurations différentes.
Par exemple, une zone sans aiguille aura deux configurations :&lt;/p>
&lt;ul>
&lt;li>sens pair&lt;/li>
&lt;li>sens impair&lt;/li>
&lt;/ul>
&lt;p>Une zone avec une aiguille aura 4 configurations possibles :&lt;/p>
&lt;ul>
&lt;li>sens pair voie principale&lt;/li>
&lt;li>sens impair voie principale&lt;/li>
&lt;li>sens pair voie déviation&lt;/li>
&lt;li>sens impair voie déviation&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Chaque zone ne peut être réservée que pour une configuration donnée à la fois, mais peut être réservée simultanément par plusieurs routes&lt;/strong>.
Une zone ne peut changer de configuration que lorsqu&amp;rsquo;elle n&amp;rsquo;est pas réservée.&lt;/p>
&lt;div class="alert alert-info" role="alert">
&lt;p>En discutant avec des experts métiers, vous entendrez parler d&amp;rsquo;&lt;a href="https://fr.wikipedia.org/wiki/Enclenchement">enclenchements&lt;/a>:
le terme viens de l&amp;rsquo;époque où les postes de signalisations étaient entièrement mécaniques.
Les enclenchements étaient alors des objets physiques qui empêchaient certaines configurations.&lt;/p>
&lt;p>Une conséquence de cet héritage historique et que beaucoup de règles ferroviaires sont exprimées par contraintes au lieu d&amp;rsquo;être exprimées par garanties.
Un enclenchement, c&amp;rsquo;est une garantie qu&amp;rsquo;une situation particulière ne peut pas se produire.&lt;/p>
&lt;/div>
&lt;h3 id="état-dynamique-dune-zone">État dynamique d&amp;rsquo;une zone&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-rust" data-lang="rust">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#204a87;font-weight:bold">enum&lt;/span> &lt;span style="color:#000">ZoneState&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">/// A list of active reservations.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">/// Each reservation requires a particular configuration to be upheld.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">reservations&lt;/span>: &lt;span style="color:#000">VecDeque&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#000">ZoneReservation&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000">ZoneReservation&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">/// The train which requires this reservation
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">train&lt;/span>: &lt;span style="color:#000">TrainHandle&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">// The configuration required for this reservation
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">requirements&lt;/span>: &lt;span style="color:#000">ZoneRequirements&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">/// The state of this reservation
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">status&lt;/span>: &lt;span style="color:#000">ZoneReservationStatus&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">enum&lt;/span> &lt;span style="color:#000">ZoneReservationStatus&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">/// In the process of being reserved, but not yet ready
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">PRE_RESERVED&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">/// The train can arrive anytime
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">RESERVED&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">/// The train is inside the zone
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">OCCUPIED&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">/// The zone is pending release
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">PENDING_RELEASE&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">struct&lt;/span> &lt;span style="color:#000">ZoneRequirements&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">entry&lt;/span>: &lt;span style="color:#204a87">Option&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#000">DirDetector&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">exit&lt;/span>: &lt;span style="color:#204a87">Option&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#000">DirDetector&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">movable_elements&lt;/span>: &lt;span style="color:#000">Map&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#000">MovableElement&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">MovableElementConfig&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">impl&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">ZoneState&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#8f5902;font-style:italic">/// Get the combined requirements for all the currently active reservations
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">fn&lt;/span> &lt;span style="color:#000">get_combined_requirements&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#3465a4">self&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>-&amp;gt; &lt;span style="color:#204a87">Option&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#000">ZoneRequirements&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;gt;&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">{&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">return&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#3465a4">self&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reservations&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">map&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">|&lt;/span>&lt;span style="color:#000">res&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">|&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&lt;/span>&lt;span style="color:#000">res&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">requirements&lt;/span>&lt;span style="color:#000;font-weight:bold">)&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">reduce&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">|&lt;/span>&lt;span style="color:#000">a&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">b&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">|&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">ZoneRequirements&lt;/span>::&lt;span style="color:#000">combine&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">a&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">b&lt;/span>&lt;span style="color:#000;font-weight:bold">))&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#000;font-weight:bold">}&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="exigences-de-conception">Exigences de conception&lt;/h2>
&lt;ul>
&lt;li>Les zones doivent pouvoir être &lt;strong>verrouillées&lt;/strong> dans une configuration particulière.&lt;/li>
&lt;li>Il doit être possible pour plusieurs routes de &lt;strong>partager une réservation&lt;/strong> de configuration.&lt;/li>
&lt;li>Il doit être possible d&amp;rsquo;observer l&amp;rsquo;&lt;strong>évolution de statut d&amp;rsquo;une réservation&lt;/strong>.&lt;/li>
&lt;li>Il doit être possible de faire évoluer le statut d&amp;rsquo;une réservation.&lt;/li>
&lt;/ul>
&lt;h2 id="dépendances">Dépendances&lt;/h2>
&lt;ul>
&lt;li>&lt;code>statique&lt;/code> les détecteurs qui délimitent chaque zone&lt;/li>
&lt;li>&lt;code>statique&lt;/code> les aiguilles dans chaque zone&lt;/li>
&lt;li>&lt;code>dynamique&lt;/code> capacité d&amp;rsquo;observer l&amp;rsquo;occupation des zones&lt;/li>
&lt;li>&lt;code>dynamique&lt;/code> capacité d&amp;rsquo;actionner les éléments mobiles&lt;/li>
&lt;/ul>
&lt;h2 id="opérations">Opérations&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>espacement&lt;/strong>: Observer l&amp;rsquo;état d&amp;rsquo;une zone&lt;/li>
&lt;li>&lt;strong>routage&lt;/strong>: Verrouiller et déverrouiller la zone : permet d&amp;rsquo;obtenir un droit d&amp;rsquo;action. Toutes les opérations en écriture nécessitent d&amp;rsquo;avoir acquis le verrou.&lt;/li>
&lt;li>&lt;strong>routage&lt;/strong>: Attendre que toutes les réservations d&amp;rsquo;une zone expirent&lt;/li>
&lt;li>&lt;strong>routage&lt;/strong>: Pré-réserver une configuration de zone&lt;/li>
&lt;li>&lt;strong>routage&lt;/strong>: Confirmer la réservation d&amp;rsquo;une zone&lt;/li>
&lt;li>&lt;strong>routage&lt;/strong>: Attendre que la réservation de la zone soit occupée par son train&lt;/li>
&lt;li>&lt;strong>routage&lt;/strong>: Relacher une réservation de zone&lt;/li>
&lt;/ul></description></item><item><title>Docs: Contourner les conflits</title><link>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/conflict_avoidance/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/conflict_avoidance/</guid><description>
&lt;p>En explorant le graphe, il arrive souvent de tomber sur des situations
qui mèneraient à des conflits. Il faut être en mesure de rajouter du délai
pour les éviter.&lt;/p>
&lt;h4 id="décalage-du-temps-de-départ">Décalage du temps de départ&lt;/h4>
&lt;p>Dans les paramètres de l&amp;rsquo;algorithme, le temps de départ est donné
sous la forme d&amp;rsquo;une fenêtre : un temps de départ au plus tôt et au plus tard.
Tant que c&amp;rsquo;est possible, il est toujours préférable de décaler le temps
de départ pour éviter les conflits.&lt;/p>
&lt;blockquote>
&lt;p>Par exemple : un train doit partir entre 10:00 et 11:00. En partant
à 10:00, cela provoque un conflit, le train doit entrer en gare
d&amp;rsquo;arrivée 15 minutes plus tard. Il suffit de faire partir le train à
10:15 pour régler le problème.&lt;/p>
&lt;/blockquote>
&lt;p>Dans OSRD, cette fonctionnalité est gérée en gardant une trace,
à chaque arête, du décalage maximal du temps de départ qui pourra
être ajouté sur la suite du parcours. Tant que cette valeur est suffisante,
tous les conflits sont évités par ce moyen.&lt;/p>
&lt;p>Le décalage du temps de départ est une valeur stockée sur chaque arête
et additionnée à la fin de la recherche de chemin.&lt;/p>
&lt;blockquote>
&lt;p>Par exemple :&lt;/p>
&lt;ul>
&lt;li>un train doit partir entre 10:00 et 11:00. La recherche
commence avec un délai maximal de 1:00.&lt;/li>
&lt;li>Après quelques arêtes, une non-disponibilité est constatée
20 minutes après notre passage. La valeur passe donc à
20 minutes pour la suite du parcours.&lt;/li>
&lt;li>Le temps de départ est ensuite décalé de 5 minutes pour contourner
un conflit, modifiant le décalage maximal à 15 minutes.&lt;/li>
&lt;li>Ce procédé continue jusqu&amp;rsquo;à arriver à la fin du trajet, ou
jusqu&amp;rsquo;au point où il faut ajouter plus de délai.&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h4 id="marges-de-construction">Marges de construction&lt;/h4>
&lt;p>Quand la valeur de décalage maximal du temps de départ tombe à 0,
il faut rajouter du délai entre deux points du parcours du train.&lt;/p>
&lt;p>&lt;img src="engineering_allowance.png" alt="Marge de construction (1/2)">&lt;/p>
&lt;p>Le principe est le même que pour régler les discontinuités de vitesse :
le graphe est parcouru en arrière pour créer de nouvelles arêtes.&lt;/p>
&lt;p>&lt;img src="engineering_allowance_edges.png" alt="Marge de construction (2/2)">&lt;/p>
&lt;p>La &lt;a href="https://osrd.fr/fr/docs/explanation/running_time_calculation/allowances/" title="marges">marge de construction&lt;/a>
est une fonctionnalité du calcul de marche
permettant d&amp;rsquo;ajouter un délai donné entre deux points du parcours.&lt;/p>
&lt;h2 id="post-processing">Post-processing&lt;/h2>
&lt;p>Les marges de constructions &lt;em>étaient&lt;/em> calculées pendant
l&amp;rsquo;exploration du graph, mais ce procédé était trop
couteux en temps de calcul. On effectuait des dichotomies
sur des simulations qui pouvaient s&amp;rsquo;étendre sur des
portions importantes du chemin.&lt;/p>
&lt;p>On a seulement besoin de savoir si la marge de construction
&lt;em>peut&lt;/em> être réalisée sans provoquer de conflit.
Des heuristiques peuvent être utilisées ici tant qu&amp;rsquo;on est
plus restrictif que permissif : une marge impossible
doit être identifiée comme telle, mais manquer une solution
avec une marge extrêmement serrée n&amp;rsquo;est pas une mauvaise chose.&lt;/p>
&lt;p>Mais avec ce changement, une fois qu&amp;rsquo;une solution est trouvée,
il ne suffit plus de concaténer les résultats de simulation
pour obtenir la simulation finale. On doit réaliser une
simulation complète avec les vraies marges de construction
qui évitent tout conflit. Cette étape se rejoint avec celle
décrite pour les
&lt;a href="https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/standard_allowance/" title="marges de régularité">marges de régularité&lt;/a>,
qui est maintenant réalisée même sans marge de régularité
spécifiée.&lt;/p></description></item><item><title>Docs: Le processus de calcul de marche</title><link>https://osrd.fr/fr/docs/explanation/running_time_calculation/pipeline/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/explanation/running_time_calculation/pipeline/</guid><description>
&lt;p>Le calcul de marche dans OSRD est un processus à 4 étapes, utilisant chacune &lt;a href="../envelopes_system">le système d&amp;rsquo;enveloppes&lt;/a> :&lt;/p>
&lt;ol>
&lt;li>&lt;a href="#calcul-du-profil-de-vitesse-le-plus-restrictif">Construction du profil de vitesse le plus restrictif&lt;/a>&lt;/li>
&lt;li>&lt;a href="#calcul-du-profil-de-vitesse-maximale">Ajout des différentes courbes de freinage&lt;/a>&lt;/li>
&lt;li>&lt;a href="#calcul-du-profil-deffort-maximal">Ajout des différentes courbes d&amp;rsquo;accélération et vérification des courbes de vitesse constante&lt;/a>&lt;/li>
&lt;li>&lt;a href="#application-de-marges">Application de marge(s)&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>&amp;nbsp;&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="calcul-du-profil-de-vitesse-le-plus-restrictif">Calcul du profil de vitesse le plus restrictif&lt;/h3>
&lt;/font>
&lt;p>Une première enveloppe est calculée au début de la simulation en regroupant toutes les limites de vitesse statiques :&lt;/p>
&lt;ul>
&lt;li>vitesse maximale de la ligne&lt;/li>
&lt;li>vitesse maximale du matériel roulant&lt;/li>
&lt;li>limitations temporaires de vitesse (en cas de travaux sur une ligne par exemple)&lt;/li>
&lt;li>limitations de vitesse par catégorie de train&lt;/li>
&lt;li>limitations de vitesse selon la charge du train&lt;/li>
&lt;li>limitations de vitesse correspondant à des panneaux de signalisation&lt;/li>
&lt;/ul>
&lt;p>La longueur du train est également prise en compte pour s&amp;rsquo;assurer que le train n&amp;rsquo;accélère qu&amp;rsquo;une fois sa queue ayant quitté la zone de plus faible vitesse. Un décalage est alors appliqué à la courbe en pointillée rouge. L&amp;rsquo;enveloppe résultante (courbe noire) est appelée &lt;strong>MRSP (Most Restricted Speed Profile)&lt;/strong> correspondant donc au profil de vitesse le plus restrictif. C&amp;rsquo;est sur cette enveloppe que seront calculées les étapes suivantes.&lt;/p>
&lt;p>&lt;img src="../mrsp.png" alt="Most Restricted Speed Profile">&lt;/p>
&lt;blockquote>
&lt;p>La ligne pointillée rouge représente la vitesse maximale autorisée en fonction de la position.
La ligne noire représente le MRSP où la longueur du train a été prise en compte.&lt;/p>
&lt;/blockquote>
&lt;p>Il est à noter que les différentes envelopeParts composant le MRSP sont des données d&amp;rsquo;entrée, elles ne correspondent donc pas à des courbes avec une réalité physique.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="calcul-du-profil-de-vitesse-maximale">Calcul du profil de vitesse maximale&lt;/h3>
&lt;/font>
&lt;p>En partant du MRSP, toutes les courbes de freinage sont calculées grâce au système d&amp;rsquo;overlay (voir &lt;a href="../envelopes_system/#une-interface-sp%C3%A9cifique-dans-le-service-osrd-core">ici&lt;/a> pour plus de détails sur les overlays), c&amp;rsquo;est-à-dire en créant des envelopeParts qui seront plus restrictives que le MRSP. La courbe ainsi obtenue est appelée &lt;strong>Max Speed Profile&lt;/strong> (profil de vitesse maximale). Il s&amp;rsquo;agit de l&amp;rsquo;enveloppe de vitesse maximale du train, tenant compte de ses capacités de freinage.&lt;/p>
&lt;p>Etant donné que les courbes de freinage ont un point de fin imposé et que l&amp;rsquo;équation de freinage n&amp;rsquo;a pas de solution analytique, il est impossible de prédire leur point de départ. Les courbes de freinage sont donc calculées à rebours en partant de leur point cible, c&amp;rsquo;est-à-dire le point dans l&amp;rsquo;espace où une certaine limite de vitesse est imposée (vitesse cible finie) ou le point d&amp;rsquo;arrêt (vitesse cible nulle).&lt;/p>
&lt;p>&lt;img src="../msp.png" alt="Max Speed Profile">&lt;/p>
&lt;p>Pour des raisons historiques en production horaire, les courbes de freinages sont calculées avec une décélération forfaitaire, dite décélération horaire (typiquement ~0,5m/s²) sans prendre en compte les autres forces. Cette méthode a donc également été implémentée dans OSRD, permettant ainsi de calculer les freinages de deux manières différentes : avec ce taux horaire ou avec une force de freinage qui vient simplement s&amp;rsquo;ajouter aux autres forces.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="calcul-du-profil-deffort-maximal">Calcul du profil d&amp;rsquo;effort maximal&lt;/h3>
&lt;/font>
&lt;p>Pour chaque point correspondant à une augmentation de vitesse dans le &lt;strong>MRSP&lt;/strong> ou à la fin d&amp;rsquo;une courbe de freinage d&amp;rsquo;arrêt, une courbe d&amp;rsquo;accélération est calculée. Les courbes d&amp;rsquo;accélération sont calculées en tenant compte de toutes les forces actives (force de traction, résistance à l&amp;rsquo;avancement, poids) et ont donc un sens physique.&lt;/p>
&lt;p>Pour les envelopeParts dont le sens physique n&amp;rsquo;a pas encore été vérifié (qui à ce stade sont les phases de circulation à vitesse constante, provenant toujours du MRSP), une nouvelle intégration des équations de mouvement est effectuée. Ce dernier calcul est nécessaire pour prendre en compte d&amp;rsquo;éventuels décrochages de vitesse dans le cas où le train serait physiquement incapable de tenir sa vitesse, typiquement en présence de fortes rampes (voir &lt;a href="../envelopes_system/#enveloppes-donn%C3%A9es-vs-enveloppes-calcul%C3%A9es">cet exemple&lt;/a>).&lt;/p>
&lt;p>L&amp;rsquo;enveloppe qui résulte de ces ajouts de courbes d&amp;rsquo;accélérations et de la vérification des plateaux de vitesse est appelée &lt;strong>Max Effort Profile&lt;/strong> (profil d&amp;rsquo;effort maximal).&lt;/p>
&lt;p>&lt;img src="../mep.png" alt="Max Effort Profile">&lt;/p>
&lt;p>A ce stade, l&amp;rsquo;enveloppe obtenue est continue et a un sens physique du début à fin. Le train accélère au maximum, roule aussi vite que possible en fonction des différentes limites de vitesse et de ses capacités motrices, et freine au maximum. Le calcul de marche obtenu s&amp;rsquo;appelle la &lt;strong>marche de base&lt;/strong>. Elle correspond au trajet le plus rapide possible pour le matériel roulant donné sur le parcours donné.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="application-de-marges">Application de marge(s)&lt;/h3>
&lt;/font>
&lt;p>Après avoir effectué le calcul de la marche de base (correspondant au Max Effort Profile dans OSRD), il est possible d&amp;rsquo;y appliquer des marges (allowances). Les marges sont des ajouts de temps supplémentaire au parcours du train. Elles servent notamment à lui permettre de rattraper son retard si besoin ou à d&amp;rsquo;autres besoins opérationnels (plus de détails sur les marges &lt;a href="../allowances">ici&lt;/a>).&lt;/p>
&lt;p>Une nouvelle enveloppe &lt;strong>Allowances&lt;/strong> est donc calculée grâce à des overlays pour distribuer la marge demandée par l&amp;rsquo;utilisateur sur l&amp;rsquo;enveloppe d&amp;rsquo;effort maximal calculée précédemment.&lt;/p>
&lt;p>&lt;img src="../allowances.png" alt="Marges">&lt;/p>
&lt;p>Dans le calcul de marche d&amp;rsquo;OSRD, il est possible de distribuer les marges d&amp;rsquo;une manière linéaire, en abaissant toutes les vitesses d&amp;rsquo;un certain facteur, ou économique, c&amp;rsquo;est-à-dire en minimisant la consommation d&amp;rsquo;énergie pendant le parcours du train.&lt;/p></description></item><item><title>About: Gouvernance</title><link>https://osrd.fr/fr/about/governance/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/about/governance/</guid><description>
&lt;p>Une des ambitions d&amp;rsquo;OSRD est d&amp;rsquo;&lt;strong>aider à la planification horaire à l&amp;rsquo;échelle européenne&lt;/strong>.&lt;/p>
&lt;p>Pour atteindre cet objectif, OSRD doit tenir compte des spécificités locales en consultant et collaborant avec les compagnies ferroviaires et les gestionnaires d&amp;rsquo;infrastructure.&lt;/p>
&lt;p>En échange de leur contribution, ces entreprises :&lt;/p>
&lt;ul>
&lt;li>Profitent des efforts de développement commun ;&lt;/li>
&lt;li>Peuvent se baser sur les outils communs pour créer les leurs&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> ;&lt;/li>
&lt;li>Participent à la feuille de route et à la direction technique du projet à la mesure de leur contribution.&lt;/li>
&lt;/ul>
&lt;p>OSRD est actuellement développé par:&lt;/p>
&lt;ul>
&lt;li>une &lt;a href="../../join-us">équipe de développeurs à plein temps au sein de SNCF Réseau&lt;/a>, grâce à un financement de SNCF Réseau, de l&amp;rsquo;Etat Français et de l&amp;rsquo;Union Européenne ;&lt;/li>
&lt;li>des contributeurs individuels.&lt;/li>
&lt;/ul>
&lt;h2 id="lassociation-open-rail">L&amp;rsquo;association Open Rail&lt;/h2>
&lt;p>La &lt;a href="https://openrailassociation.org/">association Open Rail&lt;/a> est une association à but non lucratif en cours de création ayant pour objectif d&amp;rsquo;organiser le travail autour d&amp;rsquo;outils logiciels communs au monde du ferroviaire.&lt;/p>
&lt;p>&lt;a href="https://openrailassociation.org/">&lt;img class="marginauto" src="logo-openrail-association.png" alt="Association OpenRail">&lt;/a>&lt;/p>
&lt;style>
.marginauto {
margin: 10px auto 20px;
display: block;
width:220px;
height:200px;
}
.marginauto:hover {
filter: brightness(70%);
transition: all 0.50s;
}
&lt;/style>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Tant qu&amp;rsquo;elles ne modifient pas les outils communs sans partager leurs améliorations, voir les détails de la license &lt;a href="https://www.gnu.org/licenses/lgpl-3.0.fr.html">LGPLv3&lt;/a>.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>Docs: Routage</title><link>https://osrd.fr/fr/docs/reference/design-docs/interlocking/routing/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/interlocking/routing/</guid><description>
&lt;h2 id="description">Description&lt;/h2>
&lt;ul>
&lt;li>Les routes ont pour responsabilité d&amp;rsquo;autoriser le déplacement des trains dans l&amp;rsquo;infrastructure. Elles doivent se terminer à un point où l&amp;rsquo;arrêt du train est prévu (en terme de signalisation, pas voyageur).&lt;/li>
&lt;li>Les routes sont assimilables à des itinéraires, ou à des suites d&amp;rsquo;itinéraires et d&amp;rsquo;installations de pleine voie.&lt;/li>
&lt;li>Les routes n&amp;rsquo;ont pas de lien direct avec le cantonnement et la signalisation. Elles nourrissent des informations sur la disponibilité des voies qui sont utilisées par le cantonnement et la signalisation.&lt;/li>
&lt;li>Une route est un chemin de détecteur en détecteur. Elle représente une portion de chemin qu&amp;rsquo;il est sûr pour un train d&amp;rsquo;emprunter.&lt;/li>
&lt;li>Les routes ont des points de libération, qui sont des détecteurs qui délimitent quand détruire l&amp;rsquo;itinéraire, ce qui permet d&amp;rsquo;implémenter transit souple, rigide, et entre-deux.&lt;/li>
&lt;li>Une route peut être à nouveau formée alors qu&amp;rsquo;un train est déjà en train de la parcourir. Cela permet à plusieurs trains de se suivre sur la même route.&lt;/li>
&lt;/ul>
&lt;h3 id="cycle-de-vie-dune-route">Cycle de vie d&amp;rsquo;une route&lt;/h3>
&lt;p>Les routes n&amp;rsquo;ont pas d&amp;rsquo;état, mais leur commande donne lieu à une suite d&amp;rsquo;événements systématique :&lt;/p>
&lt;ul>
&lt;li>le système commande toutes les routes sur le trajet du train dans l&amp;rsquo;ordre, sans attendre
&lt;ul>
&lt;li>la commande doit être acceptée par le &lt;strong>régulateur&lt;/strong>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>lorsque le régulateur accepte la commande, la &lt;strong>formation&lt;/strong> commence
&lt;ul>
&lt;li>le droit d&amp;rsquo;action de chaque zone de la route est acquis, selon un ordre global&lt;/li>
&lt;li>en parallèle pour toutes les zones:
&lt;ul>
&lt;li>si la zone n’est pas dans la configuration souhaitée:
&lt;ul>
&lt;li>si elle est déjà réservée, attendre que les réservations expirent&lt;/li>
&lt;li>sinon, la mettre dans la configuration souhaitée en déplaçant les aiguilles&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>pré-réserver la zone pour le passage du train&lt;/li>
&lt;li>le droit d&amp;rsquo;action de la zone est cédé&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>une fois que la formation est terminée, la route est &lt;strong>établie&lt;/strong>
&lt;ul>
&lt;li>pour chaque zone, transformer la pré-réservation du train en réservation&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>dès que la route est établie, un processus de &lt;strong>destruction de la route&lt;/strong> commence
&lt;ul>
&lt;li>pour chaque zone de la route donnant lieu à une libération
&lt;ul>
&lt;li>attendre que le train quitte la zone (que la réservation passe de l&amp;rsquo;état &lt;code>OCCUPIED&lt;/code> à l&amp;rsquo;état &lt;code>PENDING_RELEASE&lt;/code>)&lt;/li>
&lt;li>libérer la réservation des zones du début de la route jusqu&amp;rsquo;à la zone actuelle&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;div class="alert alert-info" role="alert">
&lt;h4 class="alert-heading">Piste d'évolution&lt;/h4>
Certains postes d&amp;rsquo;aiguillages ont un enclenchement entre itinéraires de sens contraire (affrontement) qui empêche l&amp;rsquo;activation d&amp;rsquo;une route en menant à une zone avec un transit en sens contraire. Il serait envisageable de réserver une zone supplémentaire à la fin du chemin protégé par la route, par sécurité.
&lt;/div>
&lt;div class="alert alert-info" role="alert">
&lt;h4 class="alert-heading">Piste d'évolution&lt;/h4>
Certains itinéraires en gare ne permettent pas le partage du chemin par plusieurs trains
&lt;/div>
&lt;div class="alert alert-info" role="alert">
&lt;h4 class="alert-heading">Piste d'évolution&lt;/h4>
En pratique, il pourrait être intéressant d&amp;rsquo;introduire une notion de route partielle afin de réduire le nombre de routes nécessaires: une route partielle est une portion de route qu&amp;rsquo;il n&amp;rsquo;est pas sûr d&amp;rsquo;activer indépendamment.
&lt;/div>
&lt;h2 id="exigences-de-conception">Exigences de conception&lt;/h2>
&lt;p>Le système doit, indirectement ou directement:&lt;/p>
&lt;ul>
&lt;li>permettre à la &lt;strong>signalisation&lt;/strong> de déterminer si une section de voie est &lt;strong>prête à être empruntée&lt;/strong>.&lt;/li>
&lt;li>permettre l&amp;rsquo;&lt;strong>ordonnancement&lt;/strong> des trains selon des critères configurables.&lt;/li>
&lt;li>permettre la destruction progressive (&lt;strong>transit souple&lt;/strong>) de l&amp;rsquo;itinéraire après le passage du train.&lt;/li>
&lt;li>il doit être possible d&amp;rsquo;avoir plusieurs processus de commande actifs au même moment pour la même route, afin de supporter des trains qui se suivent&lt;/li>
&lt;/ul>
&lt;h2 id="dépendances">Dépendances&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;code>statique&lt;/code> le chemin des routes de détecteur à détecteur&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>statique&lt;/code> la position requise des aiguilles, par zone&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>statique&lt;/code> les points de libération des zones (qui implémentent le transit souple / rigide)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>dynamique&lt;/code> &lt;code>régulateur&lt;/code> soumettre des commandes&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>dynamique&lt;/code> &lt;code>réservation&lt;/code> acquérir et relacher un droit d&amp;rsquo;action par zone&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>dynamique&lt;/code> &lt;code>réservation&lt;/code> attendre que les réservations d&amp;rsquo;une zone expirent&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>dynamique&lt;/code> &lt;code>éléments mobiles&lt;/code> déplacer des aiguilles&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>dynamique&lt;/code> &lt;code>réservation&lt;/code> pré-réserver une zone&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>dynamique&lt;/code> &lt;code>réservation&lt;/code> promouvoir une pré-réservation en réservation&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>dynamique&lt;/code> &lt;code>réservation&lt;/code> lors de la destruction de la route, attendre qu&amp;rsquo;une réservation passe en &lt;code>PENDING_RELEASE&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>dynamique&lt;/code> &lt;code>réservation&lt;/code> libérer une réservation&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="opérations">Opérations&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>commander une route&lt;/strong>: démarre un processus asynchrone qui ne se terminera que lorsque la route aura été établie. &lt;strong>Un processus de destruction doit démarrer dès que la route est établie&lt;/strong>.&lt;/li>
&lt;/ul>
&lt;h2 id="notes-de-conception">Notes de conception&lt;/h2>
&lt;p>Ces notes permettent d&amp;rsquo;expliquer les décisions qui ont été prises, afin de pouvoir plus aisément les comprendre et évoluer.&lt;/p>
&lt;h3 id="informer-la-signalisation">Informer la signalisation&lt;/h3>
&lt;p>Sachant que:&lt;/p>
&lt;ul>
&lt;li>il peut y avoir beaucoup de zones partant d&amp;rsquo;un même point, il est préférable d&amp;rsquo;éviter de contraindre les signaux à observer une liste de routes&lt;/li>
&lt;li>il est potentiellement difficile d&amp;rsquo;associer un état clair à chaque route&lt;/li>
&lt;/ul>
&lt;p>Il en ressort plusieurs manières d&amp;rsquo;informer la signalisation de la navigabilité des voies:&lt;/p>
&lt;ul>
&lt;li>soit &lt;strong>directement&lt;/strong>, en faisant observer à la signalisation les points d&amp;rsquo;entrée des routes. Si plusieurs routes partent du même endroit, elles partageraient un objet entrée:
&lt;ul>
&lt;li>moins de complexité dans la couche de réservation, plus de complexité dans la couche de routage&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>soit &lt;strong>indirectement&lt;/strong>, via la couche de réservation des zones, qui auraient un état supplémentaire pour marquer leur navigabilité:
&lt;ul>
&lt;li>moins de complexité dans la couche de routage, plus de complexité dans la couche de réservation&lt;/li>
&lt;li>&lt;code>avantage&lt;/code> le processus d&amp;rsquo;activation des routes n&amp;rsquo;aurait pas besoin d&amp;rsquo;attendre l&amp;rsquo;arrivée du train, la couche de réservation s&amp;rsquo;en occuperait.&lt;/li>
&lt;li>&lt;code>avantage&lt;/code> découplage entre routage et cantonnement / signalisation.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>La seconde option a été choisie, car :&lt;/p>
&lt;ul>
&lt;li>elle permet d&amp;rsquo;avoir un couplage moins fort entre la signalisation et les routes.&lt;/li>
&lt;li>elle évite aussi au processus d&amp;rsquo;activation des routes d&amp;rsquo;attendre le passage du train alors que la couche de réservation le fait déjà.&lt;/li>
&lt;/ul>
&lt;h3 id="cycle-de-vie-des-routes-et-état-des-zones">Cycle de vie des routes et état des zones&lt;/h3>
&lt;p>Plusieurs enjeux motivent le cycle de vie des routes et l&amp;rsquo;état des zones :&lt;/p>
&lt;ul>
&lt;li>d&amp;rsquo;une part, l&amp;rsquo;état des zones est au cœur de la détection de conflit : il doit être possible d&amp;rsquo;extraire d&amp;rsquo;une simulation d&amp;rsquo;un train seul ses besoins en ressources&lt;/li>
&lt;li>d&amp;rsquo;autre part, il faut qu&amp;rsquo;une simulation multi-train fonctionne correctement : le temps de déplacement des aiguilles selon la configuration actuellement en place, en particulier, est un point de friction important&lt;/li>
&lt;/ul></description></item><item><title>Docs: Flux des données</title><link>https://osrd.fr/fr/docs/reference/architecture/data_flow/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/architecture/data_flow/</guid><description>
&lt;p>&lt;img src="data_flow.svg" alt="Data-flow diagram">&lt;/p></description></item><item><title>Docs: Les marges</title><link>https://osrd.fr/fr/docs/explanation/running_time_calculation/allowances/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/explanation/running_time_calculation/allowances/</guid><description>
&lt;font color=#aa026d>
&lt;h3 id="la-raison-dêtre-des-marges">La raison d&amp;rsquo;être des marges&lt;/h3>
&lt;/font>
&lt;p>Comme expliqué dans le &lt;a href="../pipeline/#calcul-du-profil-deffort-maximal">calcul du Max Effort Profile&lt;/a>, la &lt;strong>marche de base&lt;/strong> représente la marche la plus tendue normalement réalisable, c&amp;rsquo;est-à-dire le trajet le plus rapide possible du matériel donné sur le parcours donné. Le train accélère au maximum, roule aussi vite que possible en fonction des différentes limites de vitesse et de ses capacités motrices, et freine au maximum.&lt;/p>
&lt;p>Cette marche de base présente un inconvénient majeur : si un train part avec 10min de retard, il arrivera au mieux avec 10min de retard, car par définition il lui est impossible de rouler plus vite que la marche de base. Par conséquent, les trains sont programmés avec un ajout d&amp;rsquo;une ou de plusieurs marges. Les marges sont une détente du trajet du train, un ajout de temps à l&amp;rsquo;horaire prévu, qui se traduit inévitablement par un abaissement des vitesses de circulation.&lt;/p>
&lt;blockquote>
&lt;p>Un train circulant en marche de base est incapable de rattraper son retard !&lt;/p>
&lt;/blockquote>
&lt;font color=#aa026d>
&lt;h3 id="le-type-de-marge">Le type de marge&lt;/h3>
&lt;/font>
&lt;p>On distingue deux types de marges :&lt;/p>
&lt;ul>
&lt;li>&lt;strong>La marge de régularité&lt;/strong> : il s&amp;rsquo;agit du temps complémentaire ajouté à la marche de base pour tenir compte de l’imprécision de la mesure de la vitesse, pour pallier les conséquences des incidents extérieurs venant perturber la marche théorique des trains, et pour maintenir la régularité de la circulation. La marge de régularité s&amp;rsquo;applique sur l&amp;rsquo;ensemble du trajet, bien que sa valeur puisse changer sur certains intervalles.&lt;/li>
&lt;li>&lt;strong>La marge de construction&lt;/strong> : il s&amp;rsquo;agit du temps ajouté / retiré sur un intervalle spécifique, en plus de la marge de régularité, mais cette fois pour des raisons opérationnelles (esquiver un autre train, libérer une voie plus rapidement, etc.)&lt;/li>
&lt;/ul>
&lt;p>Une marche de base à laquelle on vient ajouter une marge de régularité donne ce que l&amp;rsquo;on appelle une &lt;strong>marche type&lt;/strong>.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="la-distribution-de-la-marge">La distribution de la marge&lt;/h3>
&lt;/font>
&lt;p>L&amp;rsquo;ajout de marge se traduisant par un abaissement des vitesses le long du trajet, plusieurs marches types sont possibles. En effet, il existe une infinité de solutions aboutissant au même temps de parcours.&lt;/p>
&lt;p>En guise d&amp;rsquo;exemple simple, pour détendre la marche d&amp;rsquo;un train de 10% de son temps de parcours, il est possible de prolonger n&amp;rsquo;importe quel arrêt de l&amp;rsquo;équivalent en temps de ces 10%, tout comme il est possible de rouler à 1/1,1 = 90,9% des capacités du train sur l&amp;rsquo;ensemble du parcours, ou encore de rouler moins vite, mais seulement aux vitesses élevées&amp;hellip;&lt;/p>
&lt;p>Il y a pour l&amp;rsquo;instant deux algorithmes de distribution de la marge dans OSRD : linéaire et économique.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="la-distribution-linéaire">La distribution linéaire&lt;/h3>
&lt;/font>
&lt;p>La distribution de marge linéaire consiste simplement à abaisser les vitesses d&amp;rsquo;un même facteur sur la zone où l&amp;rsquo;utilisateur applique la marge. En voici un exemple d&amp;rsquo;application :&lt;/p>
&lt;p>&lt;img src="../python_plot_linear.png" alt="Python plot linear">&lt;/p>
&lt;p>Cette distribution a pour avantage de répartir la marge de la même manière sur tout le trajet. Un train prenant du retard à 30% de son trajet disposera de 70% de sa marge pour les 70% de trajets restants.&lt;/p>
&lt;font color=#aa026d>
&lt;h3 id="la-distribution-économique">La distribution économique&lt;/h3>
&lt;/font>
&lt;p>La distribution économique de la marge, présentée en détail dans &lt;a href="https://osrd.fr/pdf/MARECO.pdf">ce document&lt;/a> (&lt;strong>MARECO&lt;/strong> est un algorithme conçu par la direction de la recherche SNCF), consiste à répartir la marge de la manière la plus économe possible en énergie. Elle est basée sur deux principes :&lt;/p>
&lt;ol>
&lt;li>une vitesse plafond, évitant les vitesses les plus consommatrices en énergie&lt;/li>
&lt;li>des zones de marche sur l&amp;rsquo;erre, situées avant les freinages et les fortes pentes, où le train circule à moteur coupé grâce à son inertie, permettant de ne consommer aucune énergie pendant ce laps de temps&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="../python_plot_eco_w_slopes.png" alt="Python plot eco with slopes">&lt;/p>
&lt;blockquote>
&lt;p>Un exemple de marche économique. En haut, les pentes/rampes rencontrées par le train. Les zones de marche sur l&amp;rsquo;erre sont représentées en bleu.&lt;/p>
&lt;/blockquote></description></item><item><title>Docs: Marge de régularité</title><link>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/standard_allowance/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/standard_allowance/</guid><description>
&lt;p>Une des fonctionnalités qui doit être supportée par STDCM est la
&lt;a href="https://osrd.fr/fr/docs/explanation/running_time_calculation/allowances/" title="marge de régularité">marge de régularité&lt;/a>.
L&amp;rsquo;utilisateur doit pouvoir indiquer une valeur
de marge, exprimée en fonction de la distance ou du temps de parcours,
et cette marge doit être ajoutée au trajet.&lt;/p>
&lt;blockquote>
&lt;p>Par exemple : l&amp;rsquo;utilisateur peut indiquer une marge de 5 minutes au
100km. Sur un trajet de 42km, un trajet de 10 minutes au plus rapide
doit maintenant durer 12 minutes et 6 secondes.&lt;/p>
&lt;/blockquote>
&lt;p>Le problème se situe au niveau de la détection de conflits.
En effet, ralentir le train décale l&amp;rsquo;ensemble du sillon dans le temps
et augmente la capacité consommée.
La marge doit donc être prise en compte pendant l&amp;rsquo;exploration
pour détecter correctement les conflits.&lt;/p>
&lt;p>Pour plus de difficulté, la marge doit suivre le modèle
&lt;a href="https://osrd.fr/pdf/MARECO.pdf">MARECO&lt;/a>.
La marge n&amp;rsquo;est pas répartie uniformément sur le trajet, mais selon
un calcul qui nécessite de connaître l&amp;rsquo;ensemble du trajet.&lt;/p>
&lt;h3 id="pendant-lexploration">Pendant l&amp;rsquo;exploration&lt;/h3>
&lt;p>La principale implication de la marge de régularité est pendant
l&amp;rsquo;exploration du graphe, quand on identifie les conflits.
Les temps et les vitesses doivent être baissés linéairement
pour prendre en compte les conflits au bon moment.
La simulation au plus rapide doit tout de même être calculée
car elle peut définir le temp supplémentaire.&lt;/p>
&lt;p>Ce procédé &lt;em>n&amp;rsquo;est pas exact&lt;/em> car il ignore la manière dont
la marge est appliquée (en particulier pour MARECO).
Mais à cette étape les temps exacts ne sont pas nécessaires,
il est seulement nécessaire de savoir si une solution existe
à ce temps approximatif.&lt;/p>
&lt;div class="alert alert-info" role="alert">
Ce procédé inexact peut sembler être un problème, mais en
pratique (pour la SNCF) les marges de régularités ont en
fait une tolérance entre deux points arbitraires
du chemin. Par exemple pour une marge indiquée à 5 minutes
par 100km, une solution avec la marge entre 3 et 7 minutes
entre deux PR serait acceptable. Cette tolérance ne sera
pas encodée explicitement, mais elle
permet de faire des approximations de quelques
secondes pendant la recherche.
&lt;/div>
&lt;h4 id="post-processing">Post-processing&lt;/h4>
&lt;p>Une fois que le chemin est trouvé, il est nécessaire
de faire une simulation finale pour appliquer correctement
les marges. Le procédé est le suivant :&lt;/p>
&lt;ol>
&lt;li>Pour certains points du chemin, le temps est fixé.
C&amp;rsquo;est un paramètre d&amp;rsquo;entrée de la simulation qui appelle
le module de marge. À l&amp;rsquo;initialisation, le temps est fixé
à chaque point d&amp;rsquo;arrêt.&lt;/li>
&lt;li>Une simulation est réalisée. En cas de conflit, on
s&amp;rsquo;intéresse au premier&lt;/li>
&lt;li>Un point est fixé à la position de ce conflit.
Le temps de référence est celui considéré pendant l&amp;rsquo;exploration.&lt;/li>
&lt;li>Ce procédé est répété itérativement jusqu&amp;rsquo;à une absence de conflit&lt;/li>
&lt;/ol></description></item><item><title>Docs: Ordonnancement</title><link>https://osrd.fr/fr/docs/reference/design-docs/interlocking/ordering/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/interlocking/ordering/</guid><description>
&lt;div class="alert alert-warning" role="alert">
Cette page est une ébauche, contribuez-y!
&lt;/div>
&lt;h2 id="définition">Définition&lt;/h2>
&lt;p>La couche d&amp;rsquo;ordonnancement a pour responsabilité d&amp;rsquo;établir l&amp;rsquo;ordre de commande des itinéraires, et par conséquent, l&amp;rsquo;ordre de passage des trains.
La méthode exacte utilisée pour prendre cette décision n&amp;rsquo;importe pas, du moment qu&amp;rsquo;elle garantit que la simulation se termine (elle ne doit pas amener de trains en nez-à-nez, ou créer d&amp;rsquo;autres cas de figure de blocage).&lt;/p>
&lt;p>Il est possible d&amp;rsquo;implémenter un module d&amp;rsquo;ordonnancement via des tableaux d&amp;rsquo;ordre de succession des trains aux aiguilles.&lt;/p>
&lt;h2 id="exigences-de-conception">Exigences de conception&lt;/h2>
&lt;ul>
&lt;li>Il doit être possible de connecter n&amp;rsquo;importe quel algorithme d&amp;rsquo;ordonnancement&lt;/li>
&lt;li>Le module d&amp;rsquo;ordonnancement doit approuver les commandes de routes.&lt;/li>
&lt;/ul>
&lt;h2 id="opérations">Opérations&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>train&lt;/strong>: Des itinéraires sont &lt;strong>commandés&lt;/strong> pour chaque trains, aussi loin et aussi tôt que possible. L&amp;rsquo;approbation de la commande est soumise au régulateur, qui peut la retarder indéfiniment, selon des critères de son choix.&lt;/li>
&lt;/ul></description></item><item><title>Docs: Détails d'implémentation</title><link>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/implementation_details/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/stdcm/pathfinding_module/implementation_details/</guid><description>
&lt;p>Cette page précise certains détails d&amp;rsquo;implémentation.
Sa lecture n&amp;rsquo;est pas nécessaire pour comprendre les principes
généraux, mais peut aider avant de se plonger dans le code.&lt;/p>
&lt;h4 id="stdcmedgebuilder">STDCMEdgeBuilder&lt;/h4>
&lt;p>Cette classe est utilisée pour simplifier la création d&amp;rsquo;instances de &lt;code>STDCMEdge&lt;/code>,
les arêtes du graphe. Celles-ci contiennent de nombreux attributs,
la plupart pouvant être déterminés en fonction du contexte (comme
le nœud précédent). La classe &lt;code>STDCMEdgeBuilder&lt;/code> permet de rendre
certains attributs optionnels et en calcule d&amp;rsquo;autres.&lt;/p>
&lt;p>Une fois instancié et paramétré, un &lt;code>EdgeBuilder&lt;/code> a deux méthodes :&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;code>Collection&amp;lt;STDCMEdge&amp;gt; makeAllEdges()&lt;/code> permet de créer toutes
les arêtes possibles dans le contexte donné pour une route donnée.
S&amp;rsquo;il y a plusieurs &amp;ldquo;ouvertures&amp;rdquo; entre des blocks d&amp;rsquo;occupation,
une arête est créée par ouverture. Tous les conflits, leurs
évitements et les attributs associés sont déterminés ici.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>STDCMEdge findEdgeSameNextOccupancy(double timeNextOccupancy)&lt;/code> :
Cette méthode permet d&amp;rsquo;obtenir l&amp;rsquo;arête passant par une certaine
&amp;ldquo;ouverture&amp;rdquo; (quand elle existe), identifiée ici par le temps
de la prochaine occupation sur la route. Elle est utilisée à chaque
fois qu&amp;rsquo;une arête doit être re-créée dans un contexte différent,
comme pour appliquer une marge ou corriger une discontinuité.
Elle appelle la méthode précédente.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="recherche-de-chemin">Recherche de chemin&lt;/h3>
&lt;h4 id="evaluation-des-distances">Evaluation des distances&lt;/h4>
&lt;p>La fonction utilisée pour déterminer la distance (au sens
de la recherche de chemin) détermine quel chemin sera privilégié.
Le chemin obtenu sera toujours le plus court en fonction du critère
donné.&lt;/p>
&lt;p>Ici, deux paramètres sont utilisés : le temps de parcours total
et l&amp;rsquo;heure de départ. Le second a un poids très faible par rapport
au premier, pour sélectionner en priorité le chemin le plus rapide.
Les détails du calcul sont indiqués dans les commentaires des
méthodes concernées.&lt;/p>
&lt;h4 id="heuristiques">Heuristiques&lt;/h4>
&lt;p>L&amp;rsquo;algorithme de recherche de chemin dans le graphe est un A*,
avec une heuristique basée sur les coordonnées géographiques.&lt;/p>
&lt;p>Cependant, la géométrie des infrastructures générées sont arbitraires,
elle ne correspond pas aux distances indiquées sur les voies.
Il est donc possible que, sur ces infrastructures, les chemins
obtenus ne soient pas les plus courts.&lt;/p>
&lt;p>Il est en théorie possible d&amp;rsquo;utiliser cette heuristique pour
déterminer si le chemin en cours d&amp;rsquo;exploration pourra mener à une
solution dont le temps de parcours ne dépasse pas le maximum.
Mais pour la même raison, ajouter ce critère rend STDCM
inutilisable sur les infrastructures générées.
Plus de détails dans
&lt;a href="https://github.com/OpenRailAssociation/osrd/issues/2818">cette issue&lt;/a>.&lt;/p></description></item><item><title>Docs: Train</title><link>https://osrd.fr/fr/docs/reference/design-docs/interlocking/train/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/reference/design-docs/interlocking/train/</guid><description>
&lt;h2 id="description">Description&lt;/h2>
&lt;p>Les contraintes sur ce qu&amp;rsquo;est un train sont relativement faibles.
Il doit seulement avoir un identifiant, qui permet aux autres systèmes de garder des références vers des trains.&lt;/p>
&lt;h2 id="exigences-de-conception">Exigences de conception&lt;/h2>
&lt;ul>
&lt;li>Les trains &lt;strong>occupent les zones&lt;/strong>.&lt;/li>
&lt;li>Les trains doivent être &lt;strong>suivis&lt;/strong> pour préserver leur &lt;strong>ordre de passage&lt;/strong>.&lt;/li>
&lt;li>Les trains ont pour responsabilité de &lt;strong>demander les itinéraires&lt;/strong> devant eux.&lt;/li>
&lt;/ul></description></item><item><title>About: Open Source</title><link>https://osrd.fr/fr/about/opensource/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/about/opensource/</guid><description>
&lt;p>L’open source est une &lt;strong>pratique de développement logiciel&lt;/strong>, où le code source&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> du logiciel est :&lt;/p>
&lt;ul>
&lt;li>généralement développé de manière ouverte et collaborative, par des acteurs variés&lt;/li>
&lt;li>accessible et gratuitement utilisable par tous&lt;/li>
&lt;li>tout le monde est libre de proposer un changement, ou créer un logiciel dérivé&lt;/li>
&lt;li>redistribuable par tous&lt;/li>
&lt;/ul>
&lt;p>En pratique, l&amp;rsquo;open source est à la fois un &lt;strong>cadre légal&lt;/strong> pour le travail collaboratif, et un &lt;strong>ensemble de pratiques&lt;/strong>.&lt;/p>
&lt;h2 id="application-à-osrd">Application à OSRD&lt;/h2>
&lt;p>Dans le contexte d&amp;rsquo;OSRD, ce modèle a de &lt;strong>multiples avantages&lt;/strong> :&lt;/p>
&lt;ul>
&lt;li>les algorithmes et le savoir-faire développé est ouvert à tous&lt;/li>
&lt;li>les coûts de développement et résultats sont mutualisés entre les différents acteurs&lt;/li>
&lt;li>permet de faciliter l&amp;rsquo;interopérabilité entre systèmes d&amp;rsquo;information en facilitant la standardisation et l&amp;rsquo;uniformisation&lt;/li>
&lt;li>permet de catalyser la collaboration d&amp;rsquo;acteurs aux objectifs communs&lt;/li>
&lt;li>permet à chaque acteur d&amp;rsquo;adapter librement le logiciel à ses besoins&lt;/li>
&lt;li>il permet aux organismes de recherche publics de contribuer directement, et de profiter du projet&lt;/li>
&lt;li>il permet aux acteurs publics de répondre à leurs impératifs de transparence&lt;/li>
&lt;/ul>
&lt;p>L&amp;rsquo;utilisation d&amp;rsquo;un projet open source comme catalyseur de collaboration industrielle a de nombreux antécédents :&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Blender&lt;/strong> est un outil de modélisation, rendu, et animation 3D très complet, qui est récemment devenu une &lt;a href="https://fund.blender.org/">plateforme de collaboration industrielle&lt;/a> majeure pour l&amp;rsquo;industrie audiovisuelle&lt;/li>
&lt;li>&lt;strong>Linux&lt;/strong>, une alternative à Windows qui équipe Google, Microsoft, Amazon, Apple, la plupart des sites internet, plateformes cloud, téléphones, routeurs, et bien plus. Toutes ces entreprises contribuent et se reposent énormément sur Linux&lt;/li>
&lt;li>&lt;strong>Android&lt;/strong> est une base commune pour la majorité des téléphones vendus. Les fabricants contribuent régulièrement à Android&lt;/li>
&lt;li>&lt;strong>PostgreSQL&lt;/strong>, &lt;strong>MySQL&lt;/strong>, &lt;strong>SQLite&lt;/strong> et d&amp;rsquo;autres bases de donnée open source dominent collectivement ce marché. Un acteur aux besoins inédits peut contribuer à un outil open source plutôt qu&amp;rsquo;en créer un nouveau.&lt;/li>
&lt;li>À la fois &lt;strong>Firefox&lt;/strong> et &lt;strong>Chrome&lt;/strong> sont Open Source&lt;/li>
&lt;li>&lt;strong>Wordpress&lt;/strong> est le CMS au cœur de 43% des sites internet en activité. Une armée d&amp;rsquo;entreprises contribuent et produisent des extensions&lt;/li>
&lt;li>&lt;strong>Odoo&lt;/strong> est un ERP modulaire très complet, à la communauté similaire à Wordpress&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Toutes ces projets ont en commun d&amp;rsquo;être essentiel au business d&amp;rsquo;un grand nombre d&amp;rsquo;entreprises, sans pour autant être ce que l&amp;rsquo;entreprise commercialise&lt;/strong>.&lt;/p>
&lt;p>Ainsi, ces entreprises décident de collaborer avec leurs pairs ou concurrents à des outils communs, afin de faciliter les échanges et d&amp;rsquo;améliorer la qualité de leur service.&lt;/p>
&lt;h2 id="fonctionnement-pratique">Fonctionnement pratique&lt;/h2>
&lt;div class="alert alert-info" role="alert">
Ce mode de fonctionnement n&amp;rsquo;est pas spécifique à l&amp;rsquo;open source : beaucoup d&amp;rsquo;entreprises adoptent un fonctionnement identique, à la différence près qu&amp;rsquo;il est maintenu privé.
&lt;/div>
&lt;p>En pratique, les logiciels libre sont développés via &lt;a href="https://github.com/OpenRailAssociation/osrd">une forge&lt;/a>. Cette forge donne accès au code source, un outil de gestion des bugs / tâches, et un outil servant à intégrer des changements dans le code.
Tout le monde peut proposer un changement, signaler un bug ou proposer une tâche.&lt;/p>
&lt;p>Les propositions de changement sont soumis à une &lt;strong>revue par les pairs&lt;/strong>, semblables à celles de la communauté scientifique.
Les individus en charge de la revue (les reviewers) sont ceux qui sont les plus familiers avec les composants affectés par le changement.&lt;/p>
&lt;p>Les changements sont intégrés par des mainteneurs sur la base du &lt;strong>consensus&lt;/strong> entre reviewers.
Les mainteneurs sont responsables de la cohérence technique du projet, et obtiennent cette position par consensus.
L&amp;rsquo;intégration des changement n&amp;rsquo;est motivée que par leur viabilité technique : l&amp;rsquo;objectif des mainteneurs et reviewers est de &lt;strong>s&amp;rsquo;assurer que le projet reste de bonne qualité&lt;/strong>.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Le code source est un ensemble de documents texte qui définit comment fonctionne une application. C&amp;rsquo;est le produit du travail de développeurs logiciels.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>About: Open Data</title><link>https://osrd.fr/fr/about/opendata/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/about/opendata/</guid><description>
&lt;p>L&amp;rsquo;open data, c&amp;rsquo;est la pratique de rendre publiquement accessible des données sous une license permissive.
C&amp;rsquo;est une pratique distincte de l&amp;rsquo;open source, qui ne s&amp;rsquo;applique qu&amp;rsquo;au logiciel.&lt;/p>
&lt;p>&lt;strong>Open data et open source ont une relation symbiotique : sans Open Data, un logiciel open source ferroviaire n&amp;rsquo;est utilisable que par des initiés. Gérer l&amp;rsquo;accès aux données est difficile, coûteux, souvent inutile, et réduit l&amp;rsquo;accessibilité de données pourtant essentielles.&lt;/strong>&lt;/p>
&lt;p>Seul, l&amp;rsquo;&lt;strong>open data&lt;/strong> présente déjà un certain nombre d&amp;rsquo;avantages clés :&lt;/p>
&lt;ul>
&lt;li>des entreprises peuvent utiliser ces données dans leur produit, ce qui promeut les services ferroviaires&lt;/li>
&lt;li>des chercheurs peuvent étudier les données sans démarche particulière, et découvrir eux-même les données disponibles&lt;/li>
&lt;/ul>
&lt;p>Des &lt;strong>données open data&lt;/strong> exploitées par une suite d&amp;rsquo;&lt;strong>outils open source&lt;/strong> ouvrent de nouveaux horizons :&lt;/p>
&lt;ul>
&lt;li>les chercheurs et entreprises peuvent maintenant exploiter les données sans avoir à créer leurs propres outils, ou en acquérir par leurs propres moyens&lt;/li>
&lt;li>les clients de l&amp;rsquo;entreprise peuvent utiliser outils et données pour améliorer leur usage des services&lt;/li>
&lt;/ul>
&lt;p>Si &lt;strong>plusieurs acteurs&lt;/strong> mettent en open data des données exploitables par un même logiciel open source, il devient également possible de &lt;strong>recouper les données&lt;/strong> et de &lt;strong>fournir et planifier des services communs&lt;/strong>.&lt;/p>
&lt;h2 id="dans-le-cadre-dosrd">Dans le cadre d&amp;rsquo;OSRD&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>si&lt;/strong> les données de &lt;strong>matériel roulant&lt;/strong> et d&amp;rsquo;&lt;strong>infrastructure&lt;/strong> sont en open data, alors il est possible pour tous de &lt;strong>simuler des trajets&lt;/strong>, d&amp;rsquo;&lt;strong>étudier&lt;/strong> et &lt;strong>évaluer&lt;/strong> le réseau ferroviaire&lt;/li>
&lt;li>&lt;strong>si&lt;/strong> les données de &lt;strong>grilles horaires&lt;/strong> sont accessibles en open data, alors il est possible pour tous d&amp;rsquo;étudier l&amp;rsquo;&lt;strong>usage&lt;/strong> du réseau&lt;/li>
&lt;/ul></description></item><item><title>About: Roadmap</title><link>https://osrd.fr/fr/about/roadmap/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/about/roadmap/</guid><description>
&lt;p>Voici une liste des principales fonctionnalités que OSRD souhaite ajouter, par ordre de priorité.
Cette feuille de route s&amp;rsquo;étale sur plusieurs années.&lt;/p>
&lt;ul>
&lt;li>Ajout du système de signalisation [ERTMS] (&lt;a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_europ%C3%A9en_de_gestion_du_trafic_ferroviaire)">https://fr.wikipedia.org/wiki/Syst%C3%A8me_europ%C3%A9en_de_gestion_du_trafic_ferroviaire)&lt;/a>.&lt;/li>
&lt;li>Système de permission fin.&lt;/li>
&lt;li>Support du cadencement des trains. Améliorer l&amp;rsquo;intégration de Netzgrafik-Editor.&lt;/li>
&lt;li>Envoyer des trains STDCM à des services externes pour stockage et traitement.&lt;/li>
&lt;li>Création d&amp;rsquo;un plan de transport annuel.&lt;/li>
&lt;li>Support d&amp;rsquo;un système de référencement linéaire &lt;a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_de_r%C3%A9f%C3%A9rence_lin%C3%A9aire">LRS&lt;/a> couramment utilisé dans l&amp;rsquo;industrie ferroviaire. Utilisation de &lt;a href="https://fr.wikipedia.org/wiki/Point_kilom%C3%A9trique#Voie_ferr%C3%A9e">point kilométrique&lt;/a>.&lt;/li>
&lt;li>Refonte de l&amp;rsquo;éditeur d&amp;rsquo;infrastructure.&lt;/li>
&lt;li>Ajout d&amp;rsquo;un simulateur dynamique. Simuler une grille horaire sur une infrastructure et observer les retards générés.&lt;/li>
&lt;li>Gestion de version des infrastructures.&lt;/li>
&lt;li>Refonte du calcul de marche.&lt;/li>
&lt;/ul>
&lt;p>Si vous souhaitez pousser l&amp;rsquo;une de ces fonctionnalités, ou si vous avez des idées sur ce que OSRD pourrait faire à l&amp;rsquo;avenir, n&amp;rsquo;hésitez pas à rejoindre le projet !&lt;/p>
&lt;div class="alert alert-info" role="alert">
&lt;h4 class="alert-heading">Note&lt;/h4>
Les tâches qui sont actuellement développées et assignées à notre équipe peuvent être trouvées dans nos tableaux &lt;a href="https://github.com/orgs/OpenRailAssociation/projects?query=is%3Aopen">ici&lt;/a>.
&lt;/div></description></item><item><title>Docs: ETCS</title><link>https://osrd.fr/fr/docs/railway-wiki/signalling/spacing/ertms/etcs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/railway-wiki/signalling/spacing/ertms/etcs/</guid><description>
&lt;h3 id="généralités">Généralités&lt;/h3>
&lt;p>ETCS est le système européen de contrôle commande des trains. La partie bord est interopérable. La partie sol peut être
différente selon les pays tout en répondant aux mêmes objectifs de fonctionnalité.&lt;/p>
&lt;p>Il existe quatre niveaux différents dont deux sont en service : L’&lt;a href="#etcs-niveau-1">ETCS 1&lt;/a> et L’&lt;a href="#etcs-niveau-2">ETCS 2&lt;/a>. L’ETCS 0 est interdit en France.
L’ETCS 3 est encore à l’état de développement dans la plupart des pays de l’Union européenne.&lt;/p>
&lt;p>Il s’agit d’un système de signalisation de cabine et de contrôle de vitesse faisant appel aux trois composantes
suivantes :&lt;/p>
&lt;ul>
&lt;li>&lt;strong>sol&lt;/strong> : pour la gestion des circulations comprenant notamment l’espacement, la protection des points à protéger et des
circulations&lt;/li>
&lt;li>&lt;strong>bord&lt;/strong> : pour l’affichage des ordres et informations à destination du conducteur et le contrôle de la bonne exécution de
ceux-ci, dénommé EUROCAB&lt;/li>
&lt;li>&lt;strong>liaison&lt;/strong> : pour les échanges de données entre le sol et le bord :
&lt;ul>
&lt;li>liaison ponctuelle unidirectionnelle du sol vers le bord par EURO BALISES,&lt;/li>
&lt;li>liaison radiotéléphonique continue et bidirectionnelle par &lt;a href="../gsm-r/">GSM-R&lt;/a> DATA pour &lt;a href="#etcs-niveau-2">ETCS2&lt;/a> dénommé EURORADIO.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>Sur le &lt;a href="../../../../glossary/#r">RFN&lt;/a>, sont mis en oeuvre les niveaux d&amp;rsquo;exploitations suivants :&lt;/p>
&lt;ul>
&lt;li>
&lt;p>L’&lt;a href="#etcs-niveau-1">ETCS1&lt;/a> sur certaines lignes parcourables jusqu’à 220 km/h. Il correspond à un système de signalisation de cabine,
généralement superposé à la signalisation au sol existante, dont les informations entre le sol et le bord sont
transmises ponctuellement par eurobalise.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>L’&lt;a href="#etcs-niveau-2">ETCS2&lt;/a> sur certaines lignes à grande vitesse. Il correspond à un système de signalisation de cabine dont les
informations entre le sol et le bord sont transmises en temps utile ou cycliquement par liaison permanente &lt;a href="../gsm-r/">GSM-R&lt;/a> DATA.&lt;/p>
&lt;p>L’&lt;a href="#etcs-niveau-2">ETCS2&lt;/a> est un système qui ne nécessite pas la matérialisation des cantons sur le terrain.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>Préalablement à tout déplacement, les données relatives au train doivent être saisies ou paramétrées à bord. Ainsi, le
système peut, à partir des données bord et sol, superviser le train, c&amp;rsquo;est-à-dire contrôler sa vitesse et ses
déplacements et intervenir en cas de nécessité.&lt;/p>
&lt;p>La détection d&amp;rsquo;une circulation sur une partie de voie est réalisée au moyen de circuits de voie ou de compteurs
d’essieux.
En &lt;a href="#etcs-niveau-2">ETCS2&lt;/a>, la combinaison des équipements sol et bord est telle qu’elle ne nécessite, normalement, pas de signalisation
complémentaire au sol.&lt;/p>
&lt;h3 id="équipement-bord">Équipement bord&lt;/h3>
&lt;p>Le bord est constitué d&amp;rsquo;un DMI, d’un EVC, de capteurs odométriques (de vitesse), d’antennes pour la lecture des PI ETCS,
un modem &lt;a href="../gsm-r/">GSM-R&lt;/a> (Euroradio) pour ETCS2, d’une unité juridique d’enregistrement des paramètres d’exploitation,
d’interfaces avec le train.&lt;/p>
&lt;p>&lt;img src="https://osrd.fr/images/docs/railway-wiki/signalling/image-106.png" alt="">&lt;/p>
&lt;h3 id="le-dmi">Le DMI&lt;/h3>
&lt;p>Le DMI est l’interface entre le conducteur et la machine. Il permet d’afficher les ordres et instructions en fonction
des données sol et/ou bord. Le conducteur renseigne également le système par saisie de données.&lt;/p>
&lt;p>L’espacement des circulations et la protection des points dangereux se traduisent par l’affichage en temps utile d’une
vitesse but et d’une distance but. La vitesse but doit être respectée par le conducteur au point défini par la distance but.&lt;/p>
&lt;p>En « marche normale », le DMI indique au conducteur la vitesse autorisée qui ne doit pas être dépassée. Dans ce cas, il
n’y a pas d’affichage de la distance but et de la vitesse but.&lt;/p>
&lt;p>Un secteur pouvant présenter différentes couleurs est utilisé pour indiquer les ordres de vitesse ou d&amp;rsquo;arrêt.&lt;/p>
&lt;p>Enfin, d’autres indications sont affichées telles que la signalisation de traction électrique, le niveau d&amp;rsquo;exploitation,
le mode technique. Les changements d’indication au DMI peuvent être accompagnés d’indications sonores. Une zone en
partie basse du DMI est également réservée pour l’affichage de messages textuels. Certaines informations complémentaires
peuvent également être affichées par l&amp;rsquo;entreprise ferroviaire.&lt;/p>
&lt;p>&lt;img src="../../../images/document-pedagogique-signaux-regimes-exploitation-v1/image-107.png" alt="">&lt;/p>
&lt;blockquote>
&lt;p>Dans cet exemple, le conducteur autorisé à circuler à 140 km/h maximum, circule à 125 km/h, il va devoir observer une
phase de ralentissement afin de respecter la vitesse maxi de 100 km/h (vitesse But) à une distance de 2850 mètres (distance But).&lt;/p>
&lt;/blockquote>
&lt;p>Le DMI utilise un code couleur, avec la signification suivante :&lt;/p>
&lt;ul>
&lt;li>&lt;strong>blanc/gris clair/gris foncé&lt;/strong> : aucune action immédiate n’est exigée du conducteur&lt;/li>
&lt;li>&lt;strong>jaune&lt;/strong> : le conducteur doit intervenir si la vitesse réelle est proche de la vitesse autorisée (risque de passer à
la couleur orange en l’absence de réaction)&lt;/li>
&lt;li>&lt;strong>orange&lt;/strong> : l’intervention est insuffisante (risque de passer à la couleur rouge en l’absence de réaction du conducteur)&lt;/li>
&lt;li>&lt;strong>rouge&lt;/strong> : réaction trop tardive du conducteur, prise en charge par le système (peut revenir au jaune, au gris ou au
blanc après une action appropriée)&lt;/li>
&lt;/ul>
&lt;h3 id="etcs-niveau-1">ETCS niveau 1&lt;/h3>
&lt;h4 id="transmission-sol-bord">Transmission sol-bord&lt;/h4>
&lt;p>Ce niveau utilise une transmission ponctuelle à l&amp;rsquo;aide de balises placées au pied des signaux et en amont. Ces balises
(eurobalises) communiquent les données de signalisation au train.&lt;/p>
&lt;h4 id="détection-des-trains">Détection des trains&lt;/h4>
&lt;p>Le niveau 1 nécessite l&amp;rsquo;utilisation d&amp;rsquo;un système de détection des trains au sol (tel que des circuits de voie, compteurs
d&amp;rsquo;essieux et autres). Toutes ces informations sont donc transmises ponctuellement au train. La cadence de l’information
donnée pouvant être augmentée en jouant sur le nombre de balises, ou en installant une boucle (euroloop), équivalent
d&amp;rsquo;une balise, mais longeant la ligne sur une certaine distance.&lt;/p>
&lt;h3 id="etcs-niveau-2">ETCS niveau 2&lt;/h3>
&lt;h4 id="transmission-sol-bord-1">Transmission sol-bord&lt;/h4>
&lt;p>Les données de signalisation sont transmises de manière permanente, via le réseau &lt;a href="../gsm-r/">GSM-R&lt;/a>. Le train communique constamment
sa position (qu&amp;rsquo;il détermine avec un odomètre) au centre de contrôle qui lui communique en retour les actions à
effectuer (vitesse, arrêt, etc.).&lt;/p>
&lt;p>Des eurobalises sont toujours présentes sur la voie pour recaler éventuellement l&amp;rsquo;odométrie embarquée.&lt;/p>
&lt;h4 id="détection-des-trains-1">Détection des trains&lt;/h4>
&lt;p>Un système de détection des trains au sol s’appuie sur l’existence des circuits de voie pour localiser un train aval sur
un canton. Cette information est transmise au radio block center (RBC) qui gère ensuite l’espacement entre deux circulations.
Le train suiveur reçoit une nouvelle autorisation de circulation par l’intermédiaire de la liaison radio &lt;a href="../gsm-r/">GSM-R&lt;/a>.
Dès que le train aval libère un canton le poste central de commande reçoit l’information correspondante du sol qui est
transmise par liaison radio au train suiveur.&lt;/p>
&lt;h4 id="avantage">Avantage&lt;/h4>
&lt;p>Le niveau 2 rend disponible quasi immédiatement une information « libératoire » pour le train suiveur et contribue ainsi
à augmenter la fluidité. Cette immédiateté est la différence par rapport à la signalisation conventionnelle, où une
demi-minute est parfois nécessaire pour libérer un aiguillage alors que le train est déjà bien loin.&lt;/p>
&lt;h3 id="les-modes-techniques">Les modes techniques&lt;/h3>
&lt;p>Les modes techniques utilisés sur le RFN sont :&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>Mode FS&lt;/strong> : Conduite en supervision complète.&lt;/p>
&lt;p>Toutes les données train et voie sont disponibles à bord.&lt;/p>
&lt;p>Le &lt;a href="#le-dmi">DMI&lt;/a> affiche :&lt;/p>
&lt;ul>
&lt;li>la vitesse réelle du train et la vitesse autorisée&lt;/li>
&lt;li>lors de l&amp;rsquo;approche d&amp;rsquo;un &lt;a href="../../../../glossary/#e">EOA&lt;/a>, d&amp;rsquo;un repère d&amp;rsquo;arrêt ETCS ou un heurtoir, la vitesse but et la distance but&lt;/li>
&lt;/ul>
&lt;p>Le système « bord » supervise la vitesse, le déplacement du train, le respect de l’&lt;a href="../../../../glossary/#e">EOA&lt;/a> matérialisé par un repère
d’arrêt ETCS, un signal d’arrêt ou un heurtoir en ETCS1.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Mode &lt;a href="../../../../glossary/#o">OS&lt;/a>&lt;/strong> : Conduite en marche à vue.&lt;/p>
&lt;p>Toutes les données train et voie sont disponibles à bord sauf l’assurance de la libération de toute ou partie de la
voie allouée au train.&lt;/p>
&lt;p>Le DMI affiche les mêmes indications qu’en mode FS.&lt;/p>
&lt;p>Le système « bord » assure également la supervision comme en mode FS.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Mode &lt;a href="../../../../glossary/#s">SR&lt;/a>&lt;/strong> : Conduite sous la responsabilité des agents.&lt;/p>
&lt;p>Ce mode technique est utilisé pour les situations dégradées et la procédure « Mise en service » lorsque le bord n’a
pas reçu d’allocation de voie. Le système « bord » ne supervise que la vitesse du mode SR et le franchissement des
repères d&amp;rsquo;arrêt ETCS et des signaux d’arrêt.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Mode &lt;a href="../../../../glossary/#s">SH&lt;/a>&lt;/strong> : Circulation en manœuvre.&lt;/p>
&lt;p>Ce mode technique est sélectionné par le conducteur pour les mouvements de manœuvre. Le système « bord » ne supervise
que la vitesse du train.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Mode &lt;a href="../../../../glossary/#n">NL&lt;/a>&lt;/strong> : Conduite d&amp;rsquo;un engin moteur non en tête du mouvement&lt;/p>
&lt;p>Ce mode technique est utilisé en cas de pousse ou de double traction.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="protection-contre-le-rattrapage">Protection contre le rattrapage&lt;/h3>
&lt;p>En mode FS, une vitesse autorisée affichée sans la présentation de l&amp;rsquo;&lt;a href="../../../../glossary/#e">EOA&lt;/a> signifie « marche normale ».&lt;/p>
&lt;p>La &lt;a href="../../../../glossary/#m">MA&lt;/a> constituée d’un ou plusieurs cantons est allouée canton par canton, par ajout successif d’un canton.
Si le canton en aval du dernier canton alloué est occupé le train doit être en mesure de s’arrêter avant l’entrée de ce
canton. Le conducteur est alors avisé par une indication sonore au DMI.&lt;/p>
&lt;p>Dès lors, les indications de conduite (vitesse but égale à 0 et une distance but) permettant de respecter la courbe de
freinage sont affichées.&lt;/p>
&lt;p>Le conducteur doit ralentir de façon à être en mesure de s’arrêter avant l’&lt;a href="../../../../glossary/#e">EOA&lt;/a>, tout en respectant la vitesse autorisée.&lt;/p></description></item><item><title>Docs: Les installations de contresens (ICS)</title><link>https://osrd.fr/fr/docs/railway-wiki/signalling/operation-modes/double-track-lines/opposite-direction-installations/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/railway-wiki/signalling/operation-modes/double-track-lines/opposite-direction-installations/</guid><description>
&lt;h2 id="1-les-installations-permanentes-de-contresens-ipcs">1. Les installations permanentes de contresens (IPCS)&lt;/h2>
&lt;h3 id="principe">Principe&lt;/h3>
&lt;p>Certaines sections de ligne comportent des installations permanentes de contresens (IPCS). Ces installations accessibles
sans arrêt des trains à l’entrée, permettent à tout moment la circulation des trains à contresens sans que les
conducteurs en soient préavisés autrement que par la signalisation.&lt;/p>
&lt;h4 id="le-risque-de-nez-à-nez">Le risque de nez à nez&lt;/h4>
&lt;p>Des enclenchements de sécurité s’opposent à l’expédition de deux trains de sens contraire à la rencontre l’un de l’autre.&lt;/p>
&lt;h4 id="le-risque-de-rattrapage">Le risque de rattrapage&lt;/h4>
&lt;p>L’espacement des trains circulant dans le sens normal est assuré dans les conditions habituelles.&lt;/p>
&lt;p>L’espacement des trains à contresens est assuré automatiquement.&lt;/p>
&lt;h3 id="avis-au-conducteur">Avis au conducteur&lt;/h3>
&lt;p>Les sections de ligne équipées d’IPCS sont désignées aux RT.&lt;/p>
&lt;p>La circulation (entrée et sortie) sur IPCS est indiquée au conducteur par la signalisation.&lt;/p>
&lt;h2 id="2-les-installations-temporaires-de-contresens-itcs">2. Les installations temporaires de contresens (ITCS)&lt;/h2>
&lt;h3 id="principe-1">Principe&lt;/h3>
&lt;p>L’ITCS est un régime temporaire d’exploitation permettant en double voie de faire circuler sur une voie des trains en
sens inverse du sens normal.&lt;/p>
&lt;p>Ces installations, accessibles sans arrêt des trains à l’entrée, permettent à tout moment la circulation des trains à
contresens. Elles sont installées en prévision de chantier de travaux qui vont nécessiter l’obstruction d’une des deux voies.&lt;/p>
&lt;h4 id="le-risque-de-nez-à-nez-1">Le risque de nez à nez&lt;/h4>
&lt;p>Des enclenchements de sécurité s’opposent à l’expédition de deux trains de sens contraire à la rencontre l’un de l’autre.&lt;/p>
&lt;p>Les ITCS ont leurs extrémités dans les gares les plus rapprochées encadrant le chantier de travaux prévu ou bien dans des postes de pleine voie existants ou créés à cet effet, considérés dès lors comme des gares. Si le chantier se déplace, les extrémités de l’ITCS sont reportées au fur et à mesure de la progression du chantier par phases successives, chaque phase faisant l’objet d’une ITCS distincte.&lt;/p>
&lt;h4 id="le-risque-de-rattrapage-1">Le risque de rattrapage&lt;/h4>
&lt;p>L’espacement des trains circulant dans le sens normal est assuré dans les conditions habituelles.&lt;/p>
&lt;p>L’espacement des trains à contresens est assuré automatiquement.&lt;/p>
&lt;h3 id="avis-au-conducteur-1">Avis au conducteur&lt;/h3>
&lt;p>Les informations nécessaires aux conducteurs sont fournies par le gestionnaire d’infrastructure aux entreprises
ferroviaires. Les particularités de signalisation et d’exploitation de l’ITCS sont mentionnées.&lt;/p>
&lt;p>Un schéma adapté à ses besoins peut compléter ces informations.&lt;/p>
&lt;p>La circulation (entrée et sortie) sur ITCS est indiquée au conducteur par la signalisation.&lt;/p>
&lt;h2 id="3-circulation-à-contresens-sur-une-ics">3. Circulation à contresens sur une ICS&lt;/h2>
&lt;p>L’entrée d’un parcours à contresens sur une ICS est repérée par un tableau lumineux d’entrée à contresens (TECS). Ce
tableau, normalement éteint, est groupé avec le panneau qui porte le carré protégeant l’aiguille d’entrée.&lt;/p>
&lt;p>&lt;img src="https://osrd.fr/images/docs/railway-wiki/signalling/image-073.jpg" alt="">&lt;/p>
&lt;blockquote>
&lt;p>&lt;em>Exemple d’entrée à contresens à 60 km/h sur une section de ligne où la circulation normale se fait à gauche&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>Les signaux s’adressant aux conducteurs des trains circulant à contresens sont :&lt;/p>
&lt;ul>
&lt;li>implantés à droite (disposition inverse sur les lignes où la circulation se fait normalement à droite) ;&lt;/li>
&lt;li>répétés sur les engins moteurs.&lt;/li>
&lt;/ul>
&lt;p>Les ICS peuvent comporter à contresens &lt;em>un ou plusieurs cantons&lt;/em>.&lt;/p>
&lt;p>&lt;strong>La sortie d’un parcours à contresens&lt;/strong> est repérée par un &lt;strong>tableau lumineux de sortie de contresens (TSCS)&lt;/strong>. Ce tableau
est groupé avec le panneau qui porte le signal « carré » protégeant l’aiguille de sortie.&lt;/p></description></item><item><title>Docs: La voie unique</title><link>https://osrd.fr/fr/docs/railway-wiki/signalling/operation-modes/single-track-lines/single-track/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/railway-wiki/signalling/operation-modes/single-track-lines/single-track/</guid><description>
&lt;h3 id="définition">Définition&lt;/h3>
&lt;p>Régime d’exploitation d’une ligne dans lequel les trains des deux sens circulent sur la même voie, les dispositions à
prendre pour éviter la rencontre de deux trains de sens contraire ne sont pas automatiques, mais résultent de procédures
à appliquer par les personnels affectés à la circulation des trains, voire par les personnels des trains dans certains
cas de lignes faiblement équipées. Ces dispositions sont définies par le gestionnaire d’infrastructure.&lt;/p>
&lt;h3 id="principe">Principe&lt;/h3>
&lt;h4 id="le-risque-de-nez-à-nez">Le risque de nez à nez&lt;/h4>
&lt;p>Les documents horaires sont conçus en respectant des obligations fondamentales telles que le croisement obligatoire de
deux trains en gare, qui permettent d’éviter le nez à nez pour les trains de sens contraires.&lt;/p>
&lt;p>Ce risque est donc avant tout couvert par le respect de l’ordre normal de circulation des trains figurant aux documents
horaires.&lt;/p>
&lt;p>En effet, le principe d’exploitation d’une ligne à voie unique s’effectue selon des modalités définies par le
gestionnaire d&amp;rsquo;infrastructure, qui prévoient notamment le respect absolu de l’ordre théorique de succession des trains
et en conséquence de l&amp;rsquo;ordre chronologique d&amp;rsquo;occupation de la voie unique. Une circulation qui n&amp;rsquo;est pas à son ordre, ne
peut occuper la voie unique sans procédure.&lt;/p>
&lt;p>En cas de modification de l’ordre théorique (retard, train supprimé, etc.), des procédures permettent d’organiser le
nouvel ordre de circulation des trains (procédures de reports de croisement, dépassements, etc.).&lt;/p>
&lt;dl>
&lt;dt>Le respect des procédures reposant sur l’humain, certaines lignes sont équipées d’une « barrière » technique de sécurité&lt;/dt>
&lt;dd>le block manuel de voie unique (BMVU - voir 4.4.2.). Des moyens d’arrêt complémentaires (DAAT, GSM/GFU, RST, coupure
d’urgence si la ligne est électrifiée, …) peuvent être utilisés ou mis en place afin de réduire les conséquences d’une
erreur humaine.&lt;/dd>
&lt;/dl>
&lt;h4 id="le-risque-de-rattrapage">Le risque de rattrapage&lt;/h4>
&lt;p>Le risque de collision par rattrapage est couvert par le mode de cantonnement. Les différents modes de cantonnement
existants sont :&lt;/p>
&lt;ul>
&lt;li>le cantonnement téléphonique (Voir - 4.3.) ;&lt;/li>
&lt;li>le cantonnement assisté par informatique (CAPI - voir 4.3.) ;&lt;/li>
&lt;li>le cantonnement assisté par informatique initié en 1995 (CAPI 95 - voir 4.3.) ;&lt;/li>
&lt;li>le block manuel de voie unique (BMVU - voir 4.4.2.).&lt;/li>
&lt;/ul></description></item><item><title>Docs: GSM-R</title><link>https://osrd.fr/fr/docs/railway-wiki/signalling/spacing/ertms/gsm-r/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/railway-wiki/signalling/spacing/ertms/gsm-r/</guid><description/></item><item><title>Docs: La voie unique à signalisation simplifiée (VUSS)</title><link>https://osrd.fr/fr/docs/railway-wiki/signalling/operation-modes/single-track-lines/single-track-with-simplified-signalling/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/railway-wiki/signalling/operation-modes/single-track-lines/single-track-with-simplified-signalling/</guid><description>
&lt;h3 id="définition">Définition&lt;/h3>
&lt;p>Certaines lignes à voie unique sont désignées à la documentation d’exploitation comme « Lignes à voie unique à
signalisation simplifiée ». Par rapport au régime général de la voie unique, ce type de ligne se distingue par la mise
en œuvre d’un minimum d’équipements. Ils se limitent à une pancarte « gare » à distance et à un repère d’entrée.&lt;/p>
&lt;h3 id="principe">Principe&lt;/h3>
&lt;h4 id="le-risque-de-nez-à-nez">Le risque de nez à nez&lt;/h4>
&lt;p>Elles sont exploitées selon les modalités du régime général d’exploitation de la voie unique (notamment le respect
de l’ordre théorique de circulation).&lt;/p>
&lt;p>Leur fonctionnement repose en outre sur l’arrêt général des circulations dans toutes les gares.&lt;/p>
&lt;h4 id="le-risque-de-rattrapage">Le risque de rattrapage&lt;/h4>
&lt;p>La gestion de l’espacement est assurée par le cantonnement téléphonique.&lt;/p>
&lt;p>Il n’y a aucune barrière technique de sécurité, toute erreur humaine peut avoir des conséquences graves. Des boucles de
rattrapage peuvent permettre de pallier ces erreurs (DAAT, CAPI, GSM/GFU, RST, coupure d’urgence si la ligne est
électrifiée, etc.).&lt;/p></description></item><item><title>Docs: La voie unique temporaire à caractère permanent (VUTP)</title><link>https://osrd.fr/fr/docs/railway-wiki/signalling/operation-modes/double-track-lines/temporary-single-track-of-permanent-nature/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/railway-wiki/signalling/operation-modes/double-track-lines/temporary-single-track-of-permanent-nature/</guid><description>
&lt;h3 id="principe">Principe&lt;/h3>
&lt;p>Les installations de voie unique temporaire à caractère permanent (VUTP) permettent la circulation occasionnelle des
trains des deux sens sur une seule voie, entre deux gares, sans arrêt à l’entrée et sans préavis aux conducteurs.&lt;/p>
&lt;p>Les sections de ligne équipées de VUTP sont désignées aux RT.&lt;/p>
&lt;h4 id="le-risque-de-nez-à-nez">Le risque de nez à nez&lt;/h4>
&lt;p>Des enclenchements de sécurité s’opposent à l’expédition de deux trains de sens contraire à la rencontre l’un de l’autre.&lt;/p>
&lt;h4 id="le-risque-de-rattrapage">Le risque de rattrapage&lt;/h4>
&lt;p>L’espacement des trains circulant dans le sens normal est assuré dans les conditions habituelles.&lt;/p>
&lt;p>L’espacement des trains à contresens est assuré automatiquement.&lt;/p>
&lt;h3 id="circulation-à-contresens">Circulation à contresens&lt;/h3>
&lt;p>L’entrée d’un parcours à contresens est repérée par &lt;strong>un tableau VUT&lt;/strong> groupé avec le panneau qui porte le carré protégeant
l’aiguille d’entrée.&lt;/p>
&lt;p>La présentation du &lt;strong>tableau VUT&lt;/strong> indique au conducteur :&lt;/p>
&lt;ul>
&lt;li>que le train est dirigé et est &lt;strong>autorisé à s’engager à contresens&lt;/strong> ;&lt;/li>
&lt;li>qu’à partir de ce tableau, &lt;strong>les signaux qui le concernent sont implantés à droite&lt;/strong>.&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://osrd.fr/images/docs/railway-wiki/signalling/image-074.jpg" alt="">&lt;/p>
&lt;blockquote>
&lt;p>&lt;em>Exemple d’entrée à 30 km/h sur VUTP&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>La vitesse limite à ne pas dépasser est fixée à 70 km/h.&lt;/p>
&lt;p>La sortie du parcours à contresens est repérée par &lt;strong>un tableau « FIN de VUT »&lt;/strong> groupé avec le panneau qui porte le signal
carré protégeant l’aiguille de sortie.&lt;/p>
&lt;p>La présentation du &lt;strong>tableau « FIN de VUT »&lt;/strong> indique au conducteur :&lt;/p>
&lt;ul>
&lt;li>que le train est parvenu à &lt;strong>la fin du parcours à contresens&lt;/strong> ;&lt;/li>
&lt;li>qu’à partir de ce tableau, &lt;strong>les signaux qui le concernent sont implantés à gauche&lt;/strong>.&lt;/li>
&lt;/ul></description></item><item><title>Docs: GPRS</title><link>https://osrd.fr/fr/docs/railway-wiki/signalling/spacing/ertms/gprs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://osrd.fr/fr/docs/railway-wiki/signalling/spacing/ertms/gprs/</guid><description/></item></channel></rss>