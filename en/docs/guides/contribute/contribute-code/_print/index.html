<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://osrd.fr/en/docs/guides/contribute/contribute-code/><link rel=alternate type=application/rss+xml href=https://osrd.fr/en/docs/guides/contribute/contribute-code/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Contribute code | OSRD</title>
<meta name=description content="Integrate changes into OSRD"><meta property="og:url" content="https://osrd.fr/en/docs/guides/contribute/contribute-code/"><meta property="og:site_name" content="OSRD"><meta property="og:title" content="Contribute code"><meta property="og:description" content="Integrate changes into OSRD"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Contribute code"><meta itemprop=description content="Integrate changes into OSRD"><meta itemprop=wordCount content="53"><meta name=twitter:card content="summary"><meta name=twitter:title content="Contribute code"><meta name=twitter:description content="Integrate changes into OSRD"><link rel=preload href=/scss/main.min.5c45ececdbdfc535ee5253f678cfd68edfba69407b82367ff2e289cdf3db5514.css as=style integrity="sha256-XEXs7NvfxTXuUlP2eM/Wjt+6aUB7gjZ/8uKJzfPbVRQ=" crossorigin=anonymous><link href=/scss/main.min.5c45ececdbdfc535ee5253f678cfd68edfba69407b82367ff2e289cdf3db5514.css rel=stylesheet integrity="sha256-XEXs7NvfxTXuUlP2eM/Wjt+6aUB7gjZ/8uKJzfPbVRQ=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/en/><span class="navbar-brand__logo navbar-logo"><svg id="svg36" width="110.767" height="22"><style id="style1">.st9{fill:#fff}</style><g id="ok" transform="scale(.1918)"><g id="g36"><g id="g29"><path id="path23" d="M38.5 83.4c-1.9 8.2-2.9 17-2.9 26.5v4.8h16.6c-2.8-13.2-7.8-23.4-13.7-31.3z" class="st9"/><path id="path24" d="M0 57.5v19.9c3.1 1.2 6.3 2.7 9.5 4.6 8.5 5.2 15 12.6 19.4 21.8v-31c-3.4-3-6.9-5.5-10.3-7.5-6.5-3.7-13-6.2-18.6-7.8z" class="st9"/><path id="path25" d="M35.6 69.9c4.3-11.3 10.6-21.1 18.9-29.4V0H35.6z" class="st9"/><path id="path26" d="M40.8 75.4c5.3 6.2 10.1 13.8 13.7 23.3V50.6C48.6 57.8 44 66.1 40.8 75.4z" class="st9"/><path id="path27" d="M100.7.0H61.3v34.5C73.1 25.2 86 20 96.9 17.2c1.8-.5 3.7.6 4.1 2.4.5 1.8-.6 3.6-2.4 4.1-11.4 2.9-25.3 8.6-37.2 19.7v31.8c2.9-6.3 6.7-11.7 11.4-16.4 9.4-9.3 21-14.1 30.5-16.6 1.8-.5 3.7.6 4.1 2.4.5 1.8-.6 3.6-2.4 4.1-4.7 1.2-10.1 3.1-15.3 6-19 10.3-28.2 28.4-28.2 55.2v4.8h39.3c7.8.0 14.1-6.3 14.1-14.1V14.1C114.7 6.3 108.4.0 100.7.0z" class="st9"/><path id="path28" d="M22 59.6c2.2 1.3 4.5 2.8 6.8 4.6V0H14.1C6.3.0.0 6.3.0 14.1v36.4c6.5 1.7 14.2 4.5 22 9.1z" class="st9"/><path id="path29" d="M5.4 87.5c-1.8-1.1-3.6-2-5.4-2.8v15.9c0 7.8 6.3 14.1 14.1 14.1h11.6c-3.6-12.2-10.4-21.3-20.3-27.2z" class="st9"/></g><g id="g30"><path id="path30" d="M201.7 109c-30.8.0-53.7-21.2-53.7-52.5.0-31.7 22.9-51.6 53.7-51.6 31 0 53.9 20 53.9 51.6-.1 31.3-23 52.5-53.9 52.5zm0-82.6c-16.7.0-28.2 12.8-28.2 30.1.0 17.9 11.6 30.7 28.2 30.7S230 74.4 230 56.6c0-17.3-11.6-30.2-28.3-30.2z" class="st9"/></g><g id="g32"><g id="g31"><path id="path31" d="M334.3 33.3c-4-5.2-11.4-8.5-17.6-8.5-6.2.0-13.8 2.1-13.8 9.9.0 6.6 5.9 8.7 15.2 11.6 13.4 4.3 30.7 10 30.7 29.7.0 22.7-18.3 32.9-37.8 32.9-14.1.0-28.3-5.2-37-14.2l15.6-15.9c4.7 6 13.5 10.5 21.3 10.5 7.3.0 13.7-2.8 13.7-10.7.0-7.5-7.5-9.9-20.5-14.1C291.6 60.3 279 53.9 279 36c0-21.9 19.8-31 38.2-31 11.2.0 23.7 4.2 32.4 12.1z" class="st9"/></g></g><g id="g34"><g id="g33"><path id="path32" d="m433.1 106.4-21.3-39.2h-8.1v39.2h-23.4V7.6H418c19 0 37.8 7.3 37.8 29.9.0 13.3-7.8 22.7-20.5 26.6l25.8 42.3zm-16.9-79.6h-12.7v23h11.3c7.7.0 17.3-2 17.3-12 0-9.2-8.7-11-15.9-11z" class="st9"/></g></g><g id="g35"><path id="path34" d="M522.2 106.4h-36.8V7.6H521c28 0 56.5 11.7 56.5 49.1.0 34.7-28.1 49.7-55.3 49.7zm-1.7-78.5h-11.9v57.8h11.3c17 0 32.8-7 32.8-29 0-22.2-15.8-28.8-32.2-28.8z" class="st9"/></g></g></g></svg></span><span class=navbar-brand__name>OSRD</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/en/about/><span>About</span></a></li><li class=nav-item><a class="nav-link active" href=/en/docs/><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/en/blog/><span>Blog</span></a></li><li class=nav-item><a class=nav-link href=/en/join-us/><span>Join us</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/fr/docs/guides/contribute/contribute-code/>Français</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.a200aa7f4d914412dc60a261ccafedc3.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/en/docs/guides/contribute/contribute-code/>Return to the regular view of this page</a>.</p></div><h1 class=title>Contribute code</h1><div class=lead>Integrate changes into OSRD</div><ul><li>1: <a href=#pg-20bcbda082d1db739aaf2707ad636133>General principles</a></li><li>2: <a href=#pg-1dc6aff750b242c67234a9fd8036834a>Back-end conventions</a></li><li>3: <a href=#pg-c00d970cd31ed499e445d0092488ea53>Front-end conventions</a></li><li>4: <a href=#pg-e860c4a45f93c7fb63441214882a9d83>Write code</a></li><li>5: <a href=#pg-e1c0c750b30e798f534acb8a5060da66>Commit conventions</a></li><li>6: <a href=#pg-686cc94482965b0e45aee58c42de5752>Share your changes</a></li><li>7: <a href=#pg-24dfcd6e0a300c88dde36000f0679f04>Tests</a></li></ul><div class=content><p>This chapter is about the process of integrating changes into the common code base. <strong>If you need help at any stage, open an issue or message us.</strong></p><p>OSRD application is split in multiple services written in several languages. We try to follow general code best practices and follow each language specificities when required.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-20bcbda082d1db739aaf2707ad636133>1 - General principles</h1><div class=lead>Please read this first!</div><ul><li>Explain what you&rsquo;re doing and why.</li><li>Document new code with doc comments.</li><li>Include clear, simple tests.</li><li>Break work into digestible chunks.</li><li>Take the time to pick good names.</li><li>Avoid non well-known abbreviations.</li><li><strong>Control and consistency over 3rd party code reuse</strong>: Only add a dependency if it is absolutely necessary.</li><li>Every dependency we add decreases our autonomy and consistency.</li><li>We try to keep PRs bumping dependencies to a low number each week in each component, so grouping
dependency bumps in a batch PR is a valid option (see component&rsquo;s <code>README.md</code>).</li><li><strong>Don&rsquo;t reinvent every wheel</strong>: as a counter to the previous point, don&rsquo;t reinvent everything at all costs.</li><li>If there is a dependency in the ecosystem that is the &ldquo;de facto&rdquo; standard, we should heavily consider using it.</li><li>More code general recommendations in main repository <a href=https://github.com/OpenRailAssociation/osrd/blob/dev/CONTRIBUTING.md>CONTRIBUTING.md</a>.</li><li>Ask for any help that you need!</li></ul><p><em><a href=https://osrd.fr/en/docs/guides/contribute/contribute-code/backend-conventions/>Consult back-end conventions ‣</a></em></p><p><em><a href=https://osrd.fr/en/docs/guides/contribute/contribute-code/frontend-conventions/>Consult front-end conventions ‣</a></em></p><p><em><a href=https://osrd.fr/en/docs/guides/contribute/contribute-code/write-code/>Continue towards write code ‣</a></em></p><p><em><a href=https://osrd.fr/en/docs/guides/contribute/contribute-code/tests/>Continue towards tests ‣</a></em></p></div><div class=td-content style=page-break-before:always><h1 id=pg-1dc6aff750b242c67234a9fd8036834a>2 - Back-end conventions</h1><div class=lead>Coding style guide and best practices for back-end</div><h1 id=python>Python</h1><p>Python code is used for some packages and integration testing.</p><ul><li>Follow the <a href=https://www.python.org/dev/peps/pep-0020/>Zen of Python</a>.</li><li>Projects are organized with <a href=https://docs.astral.sh/uv/>uv</a></li><li>Code is linted with <a href=https://docs.astral.sh/ruff/>ruff</a>.</li><li>Code is formatted with <a href=https://docs.astral.sh/ruff/>ruff</a>.</li><li>Python tests are written using <a href=https://docs.pytest.org/>pytest</a>.</li><li>Typing is checked using <a href=https://microsoft.github.io/pyright/>pyright</a>.</li></ul><h1 id=rust>Rust</h1><ul><li>As a reference for our API development we are using the <a href=https://rust-lang.github.io/api-guidelines/about.html>Rust API guidelines</a>.
Generally, these should be followed.</li><li>Prefer granular imports over glob imports like <code>diesel::*</code>.</li><li>Tests are written with the <a href=https://doc.rust-lang.org/book/ch11-01-writing-tests.html>built-in testing framework</a>.</li><li>Use the <a href=https://doc.rust-lang.org/rust-by-example/meta/doc.html>documentation example</a> to know how to phrase and format your documentation.</li><li>Use consistent comment style:<ul><li><code>///</code> doc comments belong above <code>#[derive(Trait)]</code> invocations.</li><li><code>//</code> comments should generally go above the line in question, rather than in-line.</li><li>Start comments with capital letters. End them with a period if they are sentence-like.</li></ul></li><li>Use comments to organize long and complex stretches of code that can&rsquo;t sensibly be refactored into separate functions.</li><li>Code is linted with <a href=https://github.com/rust-lang/rust-clippy>clippy</a>.</li><li>Code is formatted with <a href=https://github.com/rust-lang/rustfmt>fmt</a>.</li></ul><h1 id=java>Java</h1><ul><li>Code is formatted with <a href=https://checkstyle.sourceforge.io/>checkstyle</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-c00d970cd31ed499e445d0092488ea53>3 - Front-end conventions</h1><div class=lead>Coding style guide and best practices for front-end</div><p>We use <strong>ReactJS</strong> and all files must be written in <strong>Typescript</strong>.</p><p>The code is <strong>linted</strong> with <a href=https://eslint.org/>eslint</a>, and <strong>formatted</strong> with <a href=https://prettier.io/>prettier</a>.</p><h2 id=nomenclature>Nomenclature</h2><p><img src=/images/docs/contribute/nomenclature-front-end.svg alt="Infrastructure diagram"></p><p>The <strong>applications</strong> (osrd eex, osrd stdcm, infra editor, rolling-stock editor) offer <strong>views</strong> (project management, study management, etc.) linked to <strong>modules</strong> (project, study, etc.) which contain the components.</p><p>These <strong>views</strong> are made up of <strong>components</strong> and sub-components <u>all derived from the modules</u>.
In addition to containing the <strong>views</strong> files for the applications, they may also contain a <strong>scripts</strong> directory which offers scripts related to these views. The <strong>views</strong> determine the logic and <u>access to the store</u>.</p><p><strong>Modules</strong> are collections of <strong>components</strong> attached to an <strong>object</strong> (a scenario, a rolling stock, a TrainSchedule). They contain :</p><ul><li>a <em>components</em> directory hosting <u>all</u> components</li><li>an optional <em>styles</em> directory <u>per module</u> for styling components in scss</li><li>an optional <em>assets</em> directory <u>per module</u> (which contains assets, e.g. default datasets, specific to the module)</li><li>an optional <em>reducers</em> file <u>per module</u></li><li>an optional <em>types</em> file <u>per module</u></li><li>an optional <em>consts</em> file <u>per module</u></li></ul><p>An <strong>assets</strong> directory (containing images and other files).</p><p>Last but not least, a <strong>common</strong> directory offering :</p><ul><li>a <em>utils</em> directory for utility functions common to the entire project</li><li>a <em>types</em> file for types common to the entire project</li><li>a <em>consts</em> file for constants common to the entire project</li></ul><h2 id=implementation-principles>Implementation principles</h2><h3 id=naming>Naming</h3><p>The following conventions are generally used in the code:</p><ul><li>components and types are in PascalCase</li><li>variables are in camelCase</li><li>translation keys are also in camelCase</li><li>constants are in SCREAMING_SNAKE_CASE (except in special cases)</li><li>CSS classes are in kebab-case</li></ul><h3 id=styles--scss>Styles & SCSS</h3><blockquote><p>WARNING: in CSS/React, the scope of a class does not depend on where the file is imported, but is valid for the entire application. If you import an <code>scss</code> file in the depths of a component (which we strongly advise against), its classes will be available to the whole application and may therefore cause side effects.</p></blockquote><p>It is therefore highly recommended to be able to easily follow the tree structure of applications, views, modules and components also within the SCSS code, and in particular to nest class names to avoid edge effects.</p><p>Some additional conventions:</p><ul><li>All sizes are expressed in px, except for fonts which are expressed in rem.</li><li>We use the <a href=https://github.com/JedWatson/classnames>classnames library</a> to conditionally apply classes: each class is separated into a string, and Boolean or other operations are performed in an object that will return—or not—the property name as the class name to be used in CSS.</li></ul><h3 id=storeredux>Store/Redux</h3><p>The store allows you to store data that will be accessible anywhere in the application. It is divided into slices, which correspond to our applications.</p><p>However, we must be careful that our store does not become a catch-all.
Adding new properties to the store must be justified by the fact that the data in question is “high-level” and will need to be accessible from locations far from each other, and that a simple state or context variable is not appropriate for storing this information.</p><p>For more details about redux, please refer to the <a href=https://redux.js.org/>official documentation</a>.</p><h3 id=redux-toolkit-rtk>Redux ToolKit (RTK)</h3><p>We use <a href=https://redux-toolkit.js.org/>Redux ToolKit</a> to make our calls to the backend.</p><p>RTK allows you to make API calls and cache responses. For more details, please refer to the <a href=https://redux-toolkit.js.org/rtk-query/overview>official documentation</a>.</p><p>The backend endpoints and types are generated directly from the editoast open API and stored in <code>generatedOsrdApi</code> (using the <code>npm run generate-types</code> command). This generated file is then enriched with other endpoints or types in <code>osrdEditoastApi</code>, which can be used in the application. Note that it is possible to transform mutations into queries when generating <code>generatedOsrdApi</code> by modifying the <code>openapi-editoast-config</code> file.</p><p>When an endpoint call must be skipped because a variable is not defined, RTK&rsquo;s <a href=https://redux-toolkit.js.org/rtk-query/usage-with-typescript#skipping-queries-with-typescript-using-skiptoken>skipToken</a> is used to avoid having to use casts.</p><h3 id=translation>Translation</h3><p>Application translation is performed on <a href=https://hosted.weblate.org/projects/osrd/>Weblate</a>.</p><h3 id=imports>Imports</h3><p>It is recommended that you use the full path for each import, unless your import file is in the same directory.</p><p>ESLint is setup to automatically sort imports in four import groups, each of them separated by an empty line and sorted in alphabetical order :</p><ul><li>React</li><li>External libraries</li><li>Internal absolute path files</li><li>Internal relative path files</li></ul><p>Regarding type imports/exports, ESLint and Typescript are configured to automatically add <code>type</code> before a type import, which allows to:</p><ul><li>Improve the performance and analysis process of the compiler and the linter.</li><li>Make these declarations more readable; we can clearly see what we are importing.</li><li>Make final bundle lighter (all types disappear at compilation)</li><li>Avoid dependency cycles (ex: the error disappears with the <code>type</code> keyword)
<img src=/images/docs/contribute/dependency-cycle.png alt="dependency cycle"> <img src=/images/docs/contribute/dependency-cycle-gone.png alt="dependency cycle"></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e860c4a45f93c7fb63441214882a9d83>4 - Write code</h1><div class=lead>Integrate changes into OSRD</div><ol><li><p>If you are not used to Git, <a href=https://learngitbranching.js.org/>follow this tutorial</a></p></li><li><p><strong>Create a branch</strong><br>If you intend to contribute regularly, you can request access to the <a href=https://github.com/OpenRailAssociation/osrd>main repository</a>. Otherwise, <a href=https://github.com/OpenRailAssociation/osrd/fork>create a fork</a>.</p></li><li><p><strong>Add changes to your branch</strong><br>Before you start working, try to split your work into macroscopic steps.
At the end of each stop, save your changes into a commit.
Try to make commits of logical and atomic units.
Try to follow <a href=../conventions/>style conventions</a>.</p></li><li><p><strong>Keep your branch up-to-date</strong></p><pre tabindex=0><code>git switch &lt;your_branch&gt;
git fetch
git rebase origin/dev
</code></pre></li></ol><p><em><a href=https://osrd.fr/en/docs/guides/contribute/contribute-code/commit-conventions/>Continue towards commit style ‣</a></em></p></div><div class=td-content style=page-break-before:always><h1 id=pg-e1c0c750b30e798f534acb8a5060da66>5 - Commit conventions</h1><div class=lead>A few advises and rules about commit messages</div><h2 id=commit-style>Commit style</h2><p>The overall format for git commits is as follows:</p><pre tabindex=0><code>component1, component2: imperative description of the change

Detailed or technical description of the change and what motivates it,
if it is not entirely obvious from the title.
</code></pre><ul><li><strong>the commit message, just like the code, must be in english</strong> (only ASCII characters for the title)</li><li>there can be multiple components separated by <code>:</code> in case of hierarchical relationships, with <code>,</code> otherwise</li><li>components are lower-case, using <code>-</code>, <code>_</code> or <code>.</code> if necessary</li><li>the imperative description of the change begins with a lower-case verb</li><li>the title must not contain any link (<code>#</code> is forbidden)</li></ul><p>Ideally:</p><ul><li>the title should be self-explanatory: no need to read anything else to understand it</li><li>the commit title is all lower-case</li><li>the title is clear to a reader not familiar with the code</li><li>the body of the commit contains a detailed description of the change</li></ul><div class="alert alert-info" role=alert>An automated check is performed to enforce as much as possible this formatting.</div><h3 id=counter-examples-of-commit-titles>Counter-examples of commit titles</h3><p>To be avoided entirely:</p><ul><li><code>component: update ./some/file.ext</code>: specify the update itself rather than the file, the files
are technical elements welcome in the <em>body</em> of the commit</li><li><code>component: fix #42</code>: specify the problem fixed in the title, links (to issue, etc.) are very
welcome in commit&rsquo;s <em>body</em></li><li><code>wip</code>: describe the work (and finish it)</li></ul><p>Welcome to ease review, but do not merge:</p><ul><li><code>fixup! previous commit</code>: an <a href=../share-changes>autosquash</a> must be run before the merge</li><li><code>Revert "previous commit of the same PR"</code>: both commits must be dropped before merging</li></ul><h2 id=the-developer-certificate-of-origin-dco>The Developer Certificate of Origin (DCO)</h2><p>All of OSRD&rsquo;s projects use the DCO (Developer Certificate of Origin) to address
legal matters. The DCO helps confirm that you have the rights to the code you
contribute. For more on the history and purpose of the DCO, you can read <a href=https://bssw.io/blog_posts/the-developer-certificate-of-origin>The
Developer Certificate of Origin</a>
by Roscoe A. Bartlett.</p><p>To comply with the DCO, <strong>all commits must include a Signed-off-by line</strong>.</p><h3 id=how-to-sign-a-commit-using-git-in-a-shell->How to sign a commit using git in a shell ?</h3><p>To sign off a commit, simply add the <code>-s</code> flags to your <code>git commit</code> command,
like so:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git commit -s -m <span style=color:#4e9a06>&#34;Your commit message&#34;</span>
</span></span></code></pre></div><p>This also applies when using the <code>git revert</code> command.</p><h3 id=how-to-do-sign-a-commit-using-git-in-visual-studio-code-vs-code->How to do sign a commit using git in Visual Studio Code (VS Code) ?</h3><p>Now, go in <code>Files</code> -> <code>Preferences</code> -> <code>Settings</code>, search for and activate
the <strong>Always Sign Off</strong> setting.</p><p>Finally, when you&rsquo;ll commit your changes via the VS Code interface, your commits
will automatically be signed-off.</p><p><em><a href=https://osrd.fr/en/docs/guides/contribute/contribute-code/share-changes/>Continue towards sharing your changes ‣</a></em></p></div><div class=td-content style=page-break-before:always><h1 id=pg-686cc94482965b0e45aee58c42de5752>6 - Share your changes</h1><div class=lead>How to submit your code modifications for review?</div><p>The author of a <em>pull request (PR)</em> is responsible for its &ldquo;life cycle&rdquo;. He is responsible for contacting the various parties involved, following the review, responding to comments and correcting the code following review (you could also check <a href=https://osrd.fr/en/docs/guides/contribute/code-review/>dedicated page about code review</a>).</p><ol><li><p><strong>Open a <em>pull request</em></strong><br>Once your changes are ready, you have to request integration with the <code>dev</code> branch.</p><p>If possible:</p><ul><li>Make PR of logical and atomic units too (avoid mixing refactoring, new features and bug fix at the same time).</li><li>Add a description to PRs to explain what they do and why.</li><li>Help the reviewer by following advice given in <a href=https://mtlynch.io/code-review-love/>mtlynch article</a>.</li><li>Add tags <code>area:&lt;affected_area></code> to show which part of the application have been impacted. It can be done through <a href=https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/creating-a-pull-request>the web interface</a>.</li></ul></li><li><p><strong>Take feedback into account</strong><br>Once your PR is open, <a href=https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/about-pull-request-reviews>other contributors can review your changes</a>:</p><ul><li>Any user can review your changes.</li><li>Your code has to be approved by <a href=https://github.com/OpenRailAssociation/osrd/blob/dev/.github/CODEOWNERS>a contributor familiar with the code</a>.</li><li>All users are expected to take comments into account.</li><li>Comments tend to be written in an open and direct manner.
The intent is to efficiently collaborate towards a solution we all agree on.</li><li>Once all discussions are resolved, a maintainer integrates the change.</li></ul></li></ol><blockquote><p>The best case is to avoid large PR and split it in multiple PR<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><ul><li>ease the reviewing process and might accelerate it (easier to find an hour to review than half a day)</li><li>is more agile, you will get feedback on the early iteration before proposing the next series of modifications,</li><li>keep the git history cleaner (in case of a <code>git bisect</code> looking for a regression for example).</li></ul><p>In the case where you cannot avoid a large PR, don&rsquo;t hesitate to ask several reviewers to organize themselves, or even to carry out the review together, reviewers and author.</p><p>For large PRs that are bound to evolve over time, keeping <em>corrections</em> during review in separate
<em>commits</em> helps reviewers. In the case of multiple reviews by the same person, this can save full
re-review (ask for help if necessary):</p><ul><li><em>Add fixup</em>, amend, squash or reword commits using the
<a href=https://git-scm.com/docs/git-commit#Documentation/git-commit.txt---fixupamendrewordltcommitgt>git commit documentation</a>.</li><li><em>Automatically merge corrections</em> into the original commits of your PR and check the result, using
<a href=https://git-scm.com/docs/git-rebase#Documentation/git-rebase.txt---autosquash><code>git rebase -i --autosquash origin/dev</code></a>
(just before the merge and once review process is complete).</li><li><em>Push your changes</em> with
<a href=https://git-scm.com/docs/git-push#Documentation/git-push.txt---no-force-with-lease><code>git push --force-with-lease</code></a>
because you are not just pushing new commits, you are pushing changes to existing commits.</li></ul></blockquote><ol start=3><li><strong>If you believe somebody forgot to review / merge your change, please speak out, multiple times if needs be.</strong></li></ol><h2 id=review-cycle>Review cycle</h2><p>A code review is an iterative process.
For a smooth review, it is imperative to <a href=https://docs.github.com/en/account-and-profile/managing-subscriptions-and-notifications-on-github/setting-up-notifications/configuring-notifications>correctly configure your github notifications</a>.</p><p>It is advisable to configure OSRD repositories as <em>&ldquo;Participating and @mentions&rdquo;</em>. This allows you to be notified of activities only on issues and PRs in which you participate.</p><blockquote><p>Maintainers are automatically notified by the <code>CODEOWNERS</code> system. The author of a PR is responsible for advancing their PR through the review process and manually requesting maintainer feedback if necessary.</p></blockquote><pre class=mermaid>sequenceDiagram
  actor A as PR author
  actor R as Reviewer/Maintainer

  A-&gt;&gt;R: Asks for a review, notifying some people
  R-&gt;&gt;A: Answers yes or no

  loop Loop between author and reviewer
    R--&gt;&gt;A: Comments, asks for changes
    A--&gt;&gt;R: Answers to comments or requested changes
    A--&gt;&gt;R: Makes necessary changes in dedicated &#34;fixups&#34;
    R--&gt;&gt;A: Reviews, tests changes, and comments again
    R--&gt;&gt;A: Resolves requested changes/conversations if ok
  end

  A-&gt;&gt;R: Rebase and apply fixups
  R-&gt;&gt;A: Checks commits history
  R-&gt;&gt;A: Approves the PR
  Note right of A: Add to the merge queue</pre><p><em><a href=https://osrd.fr/en/docs/guides/contribute/contribute-code/tests/>Finally continue towards tests ‣</a></em></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>if you are not convinced, look for &ldquo;Stacked Diff&rdquo; on the web for more literature on the topic, like <a href=https://medium.com/@alexanderjukes/stacked-diffs-vs-trunk-based-development-f15c6c601f4b>Stacked Diffs vs. Trunk Based Development</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=td-content style=page-break-before:always><h1 id=pg-24dfcd6e0a300c88dde36000f0679f04>7 - Tests</h1><div class=lead>Recommendations for testing purpose</div><h2 id=back-end>Back-end</h2><ul><li>Integration tests are written with <a href=https://docs.pytest.org/>pytest</a> in the <code>/tests</code> folder.</li><li>Each route described in the <code>openapi.yaml</code> files must have an integration test.</li><li>The test must check both the format and content of valid and invalid responses.</li></ul><h2 id=front-end>Front-end</h2><p>The functional writing of the tests is carried out with the <em>Product Owners</em>, and the developers choose a technical implementation that precisely meets the needs expressed and fits in with the recommendations presented here.</p><p>We use <a href=https://playwright.dev/>Playwright</a> to write end-to-end tests, and <a href=https://vitest.dev/>vitest</a> to write unit tests.</p><p>The browsers tested are currently <a href=https://www.mozilla.org/fr/firefox/switch/>Firefox</a> and Chromium.</p><h3 id=basic-principles>Basic principles</h3><ul><li>Tests must be <strong>short</strong> (1min max) and go <strong>straight to the point</strong>.</li><li>Arbitrary timeouts are outlawed; a test must systematically wait for a specific event. It is possible to use <em>polling</em> (retry an action - a click for example - after a certain time) proposed in the <a href=https://playwright.dev/>Playwright&rsquo;s</a> API.</li><li>All tests must be parallelizable.</li><li>Tests must not point to or wait for text elements from the translation, prefer the <em>DOM</em> tree structure or place specific <code>id</code>.</li><li>We&rsquo;re not testing the data, but the application and its functionality. Data-specific tests should be developed in parallel.</li></ul><h4 id=data>Data</h4><p><strong>The data tested must be public data</strong>.
The data required (infrastructure and rolling stock) for the tests are offered in the application&rsquo;s <code>json</code> files, <em>injected</em> at the start of each test and deleted at the end, regardless of its result or how it is stopped, including with <code>CTRL+C</code>.</p><p>This is done by API calls in typescript before launching the actual test.</p><p>The data tested is the same, both locally and via continuous integration.</p><h4 id=end-to-end-e2e-test-development-process>End-to-End (E2E) Test Development Process</h4><p>E2E tests are implemented iteratively and delivered alongside feature developments. Note that:</p><ul><li>E2E tests should only be developed for the application&rsquo;s critical user journeys.</li><li>This workflow helps prevent immediate regressions after a feature release, enhances the entire team&rsquo;s proficiency in E2E testing, and avoids excessively long PRs that would introduce entire E2E test suites at once.</li><li>It is acceptable for E2E tests to be partial during development, even if their implementation increases ticket size and development time.</li><li>Some parts of the tests will need to be mocked while the feature is still under development. However, by the end of development, the E2E test must be complete, and all mocked data should be removed. The final modifications to eliminate mocking should be minimal (typically limited to updating expected values).</li><li>When adding a new feature, it is preferable to separate the implementation of the new feature and the tests into individual commits, to facilitate review.</li><li>Test cases and user journeys should be defined in advance, during ticket refinement, before the PIP. They may be proposed by a QA or a Product Owner (PO) and must be validated by a QA, the relevant PO, and frontend developers.</li><li>If an E2E test affects the E2E testing configuration, project architecture (e.g., snapshotting), or poses a risk of slowing down the CI, a refinement workshop must be organized to consult the team responsible for project architecture and CI, particularly the DevOps team.</li></ul><h4 id=atomicity-of-a-test>Atomicity of a test</h4><p>Each test must be <strong>atomic</strong>: it is self-sufficient and cannot be divided.</p><p>A test will target a single feature or component, provided it is not too large. A test will not test an entire module or application; it will necessarily be a set of tests, in order to preserve test atomicity.</p><p>If a test needs elements to be created or added, these operations must be carried out by API calls in typescript upstream of the test, as is done for adding data. These elements must be deleted at the end of the test, regardless of the result or how it is stopped, including by <code>CTRL+C</code>.</p><p>This allows tests to be parallelized.</p><p>However, in certain cases where it is relevant, a test may contain several clearly explained and justified test subdivisions (several <code>test()</code> in a single <code>describe()</code>).</p><h3 id=example-of-a-test>Example of a test</h3><p>The requirement: &ldquo;We want to test the addition of a train to a timetable&rdquo;.</p><ol><li>add the test infrastructure and rolling stock to the database <strong>by API calls</strong>.</li><li>create project, study and scenario with choice of test infrastructure <strong>by API calls</strong>.</li><li>start the test, clicking on &ldquo;add one or more trains&rdquo; until the presence of the trains in the timetable is verified</li><li>the test passes, fails or is stopped, the project, study and scenario are deleted, along with the test rolling stock and infrastructure <strong>by API calls</strong>.</li></ol><p><em>NB: the test will not test all the possibilities offered by the addition of trains; this should be a specific test which would test the response of the interface for all scenarios without adding trains.</em></p><p><em><a href=https://osrd.fr/en/docs/guides/contribute/contribute-code/write-code/>Continue towards write code ‣</a></em></p></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/OpenRailAssociation/osrd aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2025
<span class=td-footer__authors>OSRD contributors</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><style>.markmap>svg{width:100%;height:300px}</style><script>window.markmap={autoLoader:{manual:!0,onReady(){const{autoLoader:e,builtInPlugins:t}=window.markmap;e.transformPlugins=t.filter(e=>e.name!=="prism")}}}</script><script src=https://cdn.jsdelivr.net/npm/markmap-autoloader></script><script src=/js/main.min.70982f4f1de53d56b47d6b66c1ed442a9653a5be8820e0ba651d5d17d9a9bbe1.js integrity="sha256-cJgvTx3lPVa0fWtmwe1EKpZTpb6IIOC6ZR1dF9mpu+E=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>