<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://osrd.fr/en/docs/explanation/netzgrafik-editor/><link rel=alternate type=application/rss+xml href=https://osrd.fr/en/docs/explanation/netzgrafik-editor/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Netzgrafik-Editor | OSRD</title>
<meta name=description content="Open-source software developped by SBB CFF FFS and its integration in OSRD"><meta property="og:title" content="Netzgrafik-Editor"><meta property="og:description" content="Open-source software developped by SBB CFF FFS and its integration in OSRD"><meta property="og:type" content="website"><meta property="og:url" content="https://osrd.fr/en/docs/explanation/netzgrafik-editor/"><meta itemprop=name content="Netzgrafik-Editor"><meta itemprop=description content="Open-source software developped by SBB CFF FFS and its integration in OSRD"><meta name=twitter:card content="summary"><meta name=twitter:title content="Netzgrafik-Editor"><meta name=twitter:description content="Open-source software developped by SBB CFF FFS and its integration in OSRD"><link rel=preload href=/scss/main.min.4d9db1288b215f6876c21ef883bcd30df98e7409451895d47ac7aa0297a1a496.css as=style><link href=/scss/main.min.4d9db1288b215f6876c21ef883bcd30df98e7409451895d47ac7aa0297a1a496.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.3.min.js integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-section><header><nav class="td-navbar navbar-dark js-navbar-scroll"><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/en/><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" id="svg36" width="110.767" height="22"><style id="style1">.st9{fill:#fff}</style><g id="ok" transform="scale(.1918)"><g id="g36"><g id="g29"><path id="path23" d="M38.5 83.4c-1.9 8.2-2.9 17-2.9 26.5v4.8h16.6c-2.8-13.2-7.8-23.4-13.7-31.3z" class="st9"/><path id="path24" d="M0 57.5v19.9c3.1 1.2 6.3 2.7 9.5 4.6 8.5 5.2 15 12.6 19.4 21.8v-31c-3.4-3-6.9-5.5-10.3-7.5-6.5-3.7-13-6.2-18.6-7.8z" class="st9"/><path id="path25" d="M35.6 69.9c4.3-11.3 10.6-21.1 18.9-29.4V0H35.6z" class="st9"/><path id="path26" d="M40.8 75.4c5.3 6.2 10.1 13.8 13.7 23.3V50.6C48.6 57.8 44 66.1 40.8 75.4z" class="st9"/><path id="path27" d="M100.7.0H61.3v34.5C73.1 25.2 86 20 96.9 17.2c1.8-.5 3.7.6 4.1 2.4.5 1.8-.6 3.6-2.4 4.1-11.4 2.9-25.3 8.6-37.2 19.7v31.8c2.9-6.3 6.7-11.7 11.4-16.4 9.4-9.3 21-14.1 30.5-16.6 1.8-.5 3.7.6 4.1 2.4.5 1.8-.6 3.6-2.4 4.1-4.7 1.2-10.1 3.1-15.3 6-19 10.3-28.2 28.4-28.2 55.2v4.8h39.3c7.8.0 14.1-6.3 14.1-14.1V14.1C114.7 6.3 108.4.0 100.7.0z" class="st9"/><path id="path28" d="M22 59.6c2.2 1.3 4.5 2.8 6.8 4.6V0H14.1C6.3.0.0 6.3.0 14.1v36.4c6.5 1.7 14.2 4.5 22 9.1z" class="st9"/><path id="path29" d="M5.4 87.5c-1.8-1.1-3.6-2-5.4-2.8v15.9c0 7.8 6.3 14.1 14.1 14.1h11.6c-3.6-12.2-10.4-21.3-20.3-27.2z" class="st9"/></g><g id="g30"><path id="path30" d="M201.7 109c-30.8.0-53.7-21.2-53.7-52.5.0-31.7 22.9-51.6 53.7-51.6 31 0 53.9 20 53.9 51.6-.1 31.3-23 52.5-53.9 52.5zm0-82.6c-16.7.0-28.2 12.8-28.2 30.1.0 17.9 11.6 30.7 28.2 30.7S230 74.4 230 56.6c0-17.3-11.6-30.2-28.3-30.2z" class="st9"/></g><g id="g32"><g id="g31"><path id="path31" d="M334.3 33.3c-4-5.2-11.4-8.5-17.6-8.5-6.2.0-13.8 2.1-13.8 9.9.0 6.6 5.9 8.7 15.2 11.6 13.4 4.3 30.7 10 30.7 29.7.0 22.7-18.3 32.9-37.8 32.9-14.1.0-28.3-5.2-37-14.2l15.6-15.9c4.7 6 13.5 10.5 21.3 10.5 7.3.0 13.7-2.8 13.7-10.7.0-7.5-7.5-9.9-20.5-14.1C291.6 60.3 279 53.9 279 36c0-21.9 19.8-31 38.2-31 11.2.0 23.7 4.2 32.4 12.1z" class="st9"/></g></g><g id="g34"><g id="g33"><path id="path32" d="m433.1 106.4-21.3-39.2h-8.1v39.2h-23.4V7.6H418c19 0 37.8 7.3 37.8 29.9.0 13.3-7.8 22.7-20.5 26.6l25.8 42.3zm-16.9-79.6h-12.7v23h11.3c7.7.0 17.3-2 17.3-12 0-9.2-8.7-11-15.9-11z" class="st9"/></g></g><g id="g35"><path id="path34" d="M522.2 106.4h-36.8V7.6H521c28 0 56.5 11.7 56.5 49.1.0 34.7-28.1 49.7-55.3 49.7zm-1.7-78.5h-11.9v57.8h11.3c17 0 32.8-7 32.8-29 0-22.2-15.8-28.8-32.2-28.8z" class="st9"/></g></g></g></svg></span><span class=navbar-brand__name>OSRD</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/en/about/><span>About</span></a></li><li class=nav-item><a class="nav-link active" href=/en/docs/><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=/en/blog/><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><ul class=dropdown-menu><li><a class=dropdown-item href=/fr/docs/explanation/netzgrafik-editor/>Français</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.c40977495cde5cd8ff560b0eb975a03b.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/en/docs/explanation/netzgrafik-editor/>Return to the regular view of this page</a>.</p></div><h1 class=title>Netzgrafik-Editor</h1><div class=lead>Open-source software developped by SBB CFF FFS and its integration in OSRD</div><ul></ul><div class=content><p>Netzgrafik-Editor (NGE) is an open-source software that enables the creation, modification, and analysis of regular-interval timetable, at a macroscopic level of details, developped by <a href=https://www.sbb.ch/>Swiss Federal Railways (SBB CFF FFS)</a>. See <a href=https://github.com/SchweizerischeBundesbahnen/netzgrafik-editor-frontend>front-end</a> and <a href=https://github.com/SchweizerischeBundesbahnen/netzgrafik-editor-backend>back-end</a> repositories.</p><p>OSRD (microscopic level of detail, trains scheduled once, based on a defined infrastructure, depicts a timetable) and NGE (macroscopic level of detail, regular-interval based train runs, no infrastructure, depicts a transportation plan) are semantically different, but close enough to make it work together.
The compatibility between NGE and OSRD has been tested through by a proof of concept, by running both pieces of software as separate services and without automated synchronization.</p><p>The idea is to give to OSRD a graphical tool to edit (create, update and delete train schedules from) a timetable from a operational study scenario, and get some insights on analytics at the same time. The second benefit of using both microscopic and macroscopic level of detail is that OSRD microscopic calculations can be propagated in NGE to enhance the level of detail of it.</p><p>The transversal objective of this feature is to make 2 open-source projects from 2 big infrastructure managers work along and cooperate with one another with the same goals.</p><h4 id=1---integration-in-osrd>1 - Integration in OSRD</h4><p>Therefore, NGE is integrated in the operational studies section of OSRD, in an <a href=https://developer.mozilla.org/fr/docs/Web/HTML/Element/iframe><code>iframe</code></a>. An alternative way to deal with the integration would have been to refactor NGE as <a href=https://developer.mozilla.org/fr/docs/Web/API/Web_components><code>web-components</code></a>, thus easy to import in OSRD, but this solution has been abandonned, because of the quantity of refactor that would have been needed. This <code>iframe</code> points to <code>osrd-nge</code>, a minimalist Angular app that embed the actual NGE app. It can also be seen as a wrapper of the actual NGE app. <code>osrd-nge</code> then customizes the actual NGE app with specific parameters and functionnalities:</p><ul><li>a <code>standalone</code> flag:<ul><li>to tell NGE to disable all back-end interactions (no database on NGE side)</li><li>to tell NGE to disable some UI components (authentication, project managment, versionning system view, etc&mldr;)</li></ul></li><li>implementation of a communication interface between OSRD and NGE (<a href=https://developer.mozilla.org/fr/docs/Web/API/Window/message_event><code>message_event</code></a>, <a href=https://developer.mozilla.org/fr/docs/Web/API/EventTarget/addEventListener><code>eventListener</code></a> and <a href=https://developer.mozilla.org/fr/docs/Web/API/Window/postMessage><code>postMessage</code></a>).</li></ul><p>NGE is then able to get the OSRD timetable as soon as a change is made on OSRD side, and OSRD is able to get the changes made on NGE side.</p><p>The following diagrams shows the workflow between the components.</p><p><img src=osrd_nge_concept_diagram.jpg alt="Concept diagram"></p><pre class=mermaid>---
title: OSRD - NGE Sequence diagram
---
sequenceDiagram
  autonumber
  OSRD (parent window)--&gt;&gt;OSRD (parent window): init web page
  OSRD (parent window)-&gt;&gt;NGE (osrd-nge iframe): iframe.contentWindow.postMessage(nge_light_model, &#34;*&#34;)
  loop while synchronization is ON
    alt any modification in OSRD (parent window)
      OSRD (parent window)--&gt;&gt;OSRD (parent window): any modification
      OSRD (parent window)-&gt;&gt;NGE (osrd-nge iframe): iframe.contentWindow.postMessage(nge_light_model, &#34;*&#34;)
    else any modification in NGE (osrd-nge iframe)
      NGE (osrd-nge iframe)--&gt;&gt;NGE (osrd-nge iframe): any modification &lt;br&gt;(hooks)
      NGE (osrd-nge iframe)-&gt;&gt;OSRD (parent window): parent.window.postMessage(nge_action, &#34;*&#34;)
      OSRD (parent window)--&gt;&gt;OSRD (parent window): convert NGE action into &lt;br/&gt;timetable update
      OSRD (parent window)-&gt;&gt;NGE (osrd-nge iframe): iframe.contentWindow.postMessage(nge_light_model, &#34;*&#34;)
    end
  end</pre><p>Since OSRD is the only source of truth (= data source), NGE has to be updated as very last action, to be aligned with the timetable current state, and to get the updated microscopic calculations from OSRD.</p><p>More precisely, when a change is made in NGE:</p><pre class=mermaid>---
title: OSRD - NGE Communication when modification in NGE
---
sequenceDiagram
  autonumber
  NGE (nge-app)--&gt;NGE (osrd-nge): osrd-nge listens on hooks &lt;br&gt;from nge-app
  NGE (osrd-nge)-&gt;&gt;NGE (osrd-nge): (eventListeners) &lt;br&gt; callback triggered
  NGE (osrd-nge)-&gt;&gt;OSRD (front-end): (callback functions) &lt;br&gt;parent.window.postMessage(nge_action, &#34;*&#34;)
  OSRD (front-end)-&gt;&gt;OSRD (front-end): (eventListeners) &lt;br&gt; convert nge_action &lt;br&gt; into timetable update
  OSRD (front-end)-&gt;&gt;OSRD (back-end): call for update timetable
  OSRD (back-end)-&gt;&gt;OSRD (front-end): update timetable
  OSRD (front-end)-&gt;&gt; OSRD (front-end): convert timetable into &lt;br&gt; nge_light_model
  OSRD (front-end)-&gt;&gt;NGE (osrd-nge): iframe.contentWindow.postMessage(nge_light_model, &#34;*&#34;)
  NGE (osrd-nge)-&gt;&gt;NGE (osrd-nge): (eventListener) &lt;br&gt; onLoad triggered
  NGE (osrd-nge)-&gt;&gt;NGE (nge-app): (callback function) &lt;br&gt; onLoad(nge_light_model, ...)</pre><h4 id=2---converters>2 - Converters</h4><p>To overpass the semantic differences and make the data models fit, 2 converters have to be implemented:</p><ul><li><strong>[OSRD -> NGE]</strong> a converter that tranforms an OSRD timetable into an NGE model</li><li><strong>[OSRD &lt;- NGE]</strong> an event handler, that transforms NGE action into OSRD database update on timetable</li></ul><h4 id=3---open-source-cooperation--contribution>3 - Open-source (cooperation / contribution)</h4><p>To make NGE compatible with OSRD, some changes have been requested (disable back-end, create hooks on events) and directly implemented in the <a href=https://github.com/SchweizerischeBundesbahnen/netzgrafik-editor-frontend>official repository of NGE</a>, with the agreement and help of NGE team.</p><p>Contributions for one project to another, from both sides, are valuable and will be entertained in the future.</p><p>This feature also shows that open-source cooperation is powerful and a huge gain of time in software development.</p></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-end text-xs-center order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/osrd-project/osrd aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__copyright-etc col-12 col-sm-4 text-center py-2 order-sm-2"><span>&copy; 2024 OSRD contributors. All Rights Reserved</span></div></div></div></footer></div><style>.markmap>svg{width:100%;height:300px}</style><script>window.markmap={autoLoader:{manual:!0,onReady(){const{autoLoader:e,builtInPlugins:t}=window.markmap;e.transformPlugins=t.filter(e=>e.name!=="prism")}}}</script><script src=https://cdn.jsdelivr.net/npm/markmap-autoloader></script><script src=https://cdn.jsdelivr.net/npm/mermaid@9.3.0/dist/mermaid.min.js integrity="sha512-ku2nmBrzAXY5YwohzTqLYH1/lvyMrpTVxgQKrvTabd/b/uesqltLORdmpVapYv6QhZVCLUX6wkvFaKOAY4xpUA==" crossorigin=anonymous></script><script src=/js/main.min.4261519102c0270f3bdd4edcd2b45867ee7a584a0ea82c94f59e4f991c6337a1.js integrity="sha256-QmFRkQLAJw873U7c0rRYZ+56WEoOqCyU9Z5PmRxjN6E=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.f724d3de49218995223b7316aa2e53e2b34bf42026bf399ebb21bb02212402d1.js integrity="sha256-9yTT3kkhiZUiO3MWqi5T4rNL9CAmvzmeuyG7AiEkAtE=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>